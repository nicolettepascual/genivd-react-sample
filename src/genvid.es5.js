var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function __awaiter(e,t,r,n){return new(r||(r=Promise))(function(i,o){function s(e){try{c(n.next(e))}catch(e){o(e)}}function a(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):new r(function(t){t(e.value)}).then(s,a)}c((n=n.apply(e,t||[])).next())})}function __generator(e,t){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function __values(e){var t="function"==typeof Symbol&&e[Symbol.iterator],r=0;return t?t.call(e):{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}function __read(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}function __asyncGenerator(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),o=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){i[e]&&(n[e]=function(t){return new Promise(function(r,n){o.push([e,t,r,n])>1||a(e,t)})})}function a(e,t){try{(r=i[e](t)).value instanceof __await?Promise.resolve(r.value.v).then(c,u):l(o[0][2],r)}catch(e){l(o[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function l(e,t){e(t),o.shift(),o.length&&a(o[0][0],o[0][1])}}function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,i){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,i,(t=e[r](t)).done,t.value)})}}}var ERROR_NOT_A_BROWSER='The genvid "window" or "WebSocket" polyfills have not been set properly,\nit\'s probably because you are trying to run this lib with nodejs. Please consider\nusing setConfig() to provide WebSocket and window replacements before creating the\nplayer. We advise you to use the npm packages "ws" and "jsdom".',GenvidConfig=function(){function e(e){this.framePerSeconds=e.framePerSeconds,this.console=e.console,this.gameDataMaxAge=e.gameDataMaxAge,this.websocketConnectionTimeout=e.websocketConnectionTimeout,this._websocket=e.newWebsocket,this._window=e.window}return Object.defineProperty(e.prototype,"newWebsocket",{get:function(){if(!this._websocket)throw Error(ERROR_NOT_A_BROWSER);return this._websocket},set:function(e){this._websocket=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){if(!this._window)throw Error(ERROR_NOT_A_BROWSER);return this._window},set:function(e){this._window=e},enumerable:!1,configurable:!0}),e.prototype.setConfig=function(e){var t,r;try{for(var n=__values(["framePerSeconds","console","websocketConnectionTimeout","newWebsocket","window"]),i=n.next();!i.done;i=n.next()){var o=i.value;o in e&&(this[o]=e[o])}}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e}(),newWebsocket=void 0;"undefined"!=typeof WebSocket&&(newWebsocket=function(e,t){return new WebSocket(e,t)});var config=new GenvidConfig({framePerSeconds:30,console:console,websocketConnectionTimeout:30,gameDataMaxAge:8,newWebsocket:newWebsocket,window:"undefined"==typeof window?void 0:window});function setConfig(e){config.setConfig(e)}function getConfig(){return config}function _callConsoleMethod(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=getConfig().console;if(n){var i=n[e];i&&i.apply(void 0,__spread(t))}}function log(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];_callConsoleMethod.apply(void 0,__spread(["log",e],t))}function warn(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];_callConsoleMethod.apply(void 0,__spread(["warn",e],t))}function error(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];_callConsoleMethod.apply(void 0,__spread(["error",e],t))}function info(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];_callConsoleMethod.apply(void 0,__spread(["info",e],t))}function trace(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];_callConsoleMethod.apply(void 0,__spread(["trace",e],t))}function assert(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];e||_callConsoleMethod.apply(void 0,__spread(["assert",e,t],r))}function clear(){_callConsoleMethod("clear")}function count(e){_callConsoleMethod("count",e)}function time(e){_callConsoleMethod("time",e)}function timeEnd(e){_callConsoleMethod("timeEnd",e)}var tokens="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function getInvTokens(){for(var e=[],t=tokens.length,r=0;r<t;++r)e[tokens.charCodeAt(r)]=r;return e}var invTokens=getInvTokens();function getNumPaddingEquals(e){for(var t=e.length-1,r=0;t-r>=0&&"="===e[t-r];)++r;return r}function decode(e){var t=e.length,r=getNumPaddingEquals(e),n=new ArrayBuffer(3*t/4-r),i=new Uint8Array(n),o=t;r>0&&(o-=4);var s,a,c=0;for(a=0;a<o;a+=4)s=invTokens[e.charCodeAt(a)],s<<=6,s|=invTokens[e.charCodeAt(a+1)],s<<=6,s|=invTokens[e.charCodeAt(a+2)],s<<=6,s|=invTokens[e.charCodeAt(a+3)],i[c++]=s>>16&255,i[c++]=s>>8&255,i[c++]=255&s;return r>0&&(s=invTokens[e.charCodeAt(a)],s<<=6,s|=invTokens[e.charCodeAt(a+1)],s<<=6,s|=invTokens[e.charCodeAt(a+2)],s<<=6,s|=invTokens[e.charCodeAt(a+3)],1===r?(i[c++]=s>>16&255,i[c++]=s>>8&255):i[c++]=s>>16&255),n}function UTF8ToString(e){var t,r,n,i,o,s,a="",c=String.fromCodePoint||String.fromCharCode,u=(s=e instanceof ArrayBuffer?new Uint8Array(e):e).length;for(t=0;t<u;++t)if((r=s[t])<128)a+=c(r);else if(r<194)warn("Invalid UTF-8: Unexpected continuation sequence at byte "+t+": "+r+"."),a+="�";else if(r>244)warn("Invalid UTF-8: Non-normalized character at byte "+t+": "+r+".");else{if(r<224?(i=1,n=31&r):r<240?(i=2,n=15&r):(i=3,n=7&r),t+i>=u){warn("Invalid UTF-8: Last continuation at byte "+t+" extends past end-of-data."),a+="�";break}o=!0;for(var l=0;l<i;++l){if((r=s[t+l+1])<128||r>193){warn("Invalid UTF-8: Non-continuation at byte "+(t+l)+": "+r+"."),a+="�",o=!1,i=l;break}n*=64,n+=63&r}o&&(a+=c(n),t+=i)}return a}function UTF16ToString(e){var t,r,n,i,o,s="",a=String.fromCodePoint||String.fromCharCode,c=(o=e instanceof ArrayBuffer?new Uint16Array(e):e).length;for(t=0,c>=1&&65279===o[t]&&++t;t<c;++t)if(55296===(n=64512&(r=o[t]))){if(i=r-n,!(++t<c)){warn("Invalid UTF-16: out-of-bound access."),s+="�";break}56320===(n=64512&(r=o[t]))?(i*=1024,i+=r-n,warn("["+t+"]: "+(i+=65536)+" "+a(i)),s+=a(i)):(warn("Invalid UTF-16: expecting low surrogate."),s+="�")}else 56320===n?(warn("Invalid UTF-16: unexpected low surrogate."),s+="�"):s+=a(r);return s}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function createCommonjsModule(e,t){return e(t={exports:{}},t.exports),t.exports}var aspromise=asPromise;function asPromise(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(i,s){r[n]=function(e){if(o)if(o=!1,e)s(e);else{for(var t=new Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];i.apply(null,t)}};try{e.apply(t||null,r)}catch(e){o&&(o=!1,s(e))}})}var base64_1=createCommonjsModule(function(e,t){var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=new Array(64),i=new Array(123),o=0;o<64;)i[n[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;r.encode=function(e,t,r){for(var i,o=null,s=[],a=0,c=0;t<r;){var u=e[t++];switch(c){case 0:s[a++]=n[u>>2],i=(3&u)<<4,c=1;break;case 1:s[a++]=n[i|u>>4],i=(15&u)<<2,c=2;break;case 2:s[a++]=n[i|u>>6],s[a++]=n[63&u],c=0}a>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),a=0)}return c&&(s[a++]=n[i],s[a++]=61,1===c&&(s[a++]=61)),o?(a&&o.push(String.fromCharCode.apply(String,s.slice(0,a))),o.join("")):String.fromCharCode.apply(String,s.slice(0,a))};r.decode=function(e,t,r){for(var n,o=r,s=0,a=0;a<e.length;){var c=e.charCodeAt(a++);if(61===c&&s>1)break;if(void 0===(c=i[c]))throw Error("invalid encoding");switch(s){case 0:n=c,s=1;break;case 1:t[r++]=n<<2|(48&c)>>4,n=c,s=2;break;case 2:t[r++]=(15&n)<<4|(60&c)>>2,n=c,s=3;break;case 3:t[r++]=(3&n)<<6|c,s=0}}if(1===s)throw Error("invalid encoding");return r-o},r.test=function(e){return/^(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(e)}}),eventemitter=EventEmitter;function EventEmitter(){this._listeners={}}EventEmitter.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},EventEmitter.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],n=0;n<r.length;)r[n].fn===t?r.splice(n,1):++n;return this},EventEmitter.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,r)}return this};var float_1=factory(factory);function factory(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=128===r[3];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function o(e,n,i){t[0]=e,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],t[0]}function a(e,n){return r[3]=e[n],r[2]=e[n+1],r[1]=e[n+2],r[0]=e[n+3],t[0]}e.writeFloatLE=n?i:o,e.writeFloatBE=n?o:i,e.readFloatLE=n?s:a,e.readFloatBE=n?a:s}():function(){function t(e,t,r,n){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,r,n);else if(isNaN(t))e(2143289344,r,n);else if(t>3.4028234663852886e38)e((i<<31|2139095040)>>>0,r,n);else if(t<1.1754943508222875e-38)e((i<<31|Math.round(t/1.401298464324817e-45))>>>0,r,n);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,r,n)}}function r(e,t,r){var n=e(t,r),i=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:i*(1/0):0===o?1.401298464324817e-45*i*s:i*Math.pow(2,o-150)*(s+8388608)}e.writeFloatLE=t.bind(null,writeUintLE),e.writeFloatBE=t.bind(null,writeUintBE),e.readFloatLE=r.bind(null,readUintLE),e.readFloatBE=r.bind(null,readUintBE)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=128===r[7];function i(e,n,i){t[0]=e,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function o(e,n,i){t[0]=e,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function s(e,n){return r[0]=e[n],r[1]=e[n+1],r[2]=e[n+2],r[3]=e[n+3],r[4]=e[n+4],r[5]=e[n+5],r[6]=e[n+6],r[7]=e[n+7],t[0]}function a(e,n){return r[7]=e[n],r[6]=e[n+1],r[5]=e[n+2],r[4]=e[n+3],r[3]=e[n+4],r[2]=e[n+5],r[1]=e[n+6],r[0]=e[n+7],t[0]}e.writeDoubleLE=n?i:o,e.writeDoubleBE=n?o:i,e.readDoubleLE=n?s:a,e.readDoubleBE=n?a:s}():function(){function t(e,t,r,n,i,o){var s=n<0?1:0;if(s&&(n=-n),0===n)e(0,i,o+t),e(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))e(0,i,o+t),e(2146959360,i,o+r);else if(n>1.7976931348623157e308)e(0,i,o+t),e((s<<31|2146435072)>>>0,i,o+r);else{var a;if(n<2.2250738585072014e-308)e((a=n/5e-324)>>>0,i,o+t),e((s<<31|a/4294967296)>>>0,i,o+r);else{var c=Math.floor(Math.log(n)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=n*Math.pow(2,-c))>>>0,i,o+t),e((s<<31|c+1023<<20|1048576*a&1048575)>>>0,i,o+r)}}}function r(e,t,r,n,i){var o=e(n,i+t),s=e(n,i+r),a=2*(s>>31)+1,c=s>>>20&2047,u=4294967296*(1048575&s)+o;return 2047===c?u?NaN:a*(1/0):0===c?5e-324*a*u:a*Math.pow(2,c-1075)*(u+4503599627370496)}e.writeDoubleLE=t.bind(null,writeUintLE,0,4),e.writeDoubleBE=t.bind(null,writeUintBE,4,0),e.readDoubleLE=r.bind(null,readUintLE,0,4),e.readDoubleBE=r.bind(null,readUintBE,4,0)}(),e}function writeUintLE(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function writeUintBE(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function readUintLE(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function readUintBE(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}var utf8_1=createCommonjsModule(function(e,t){var r=t;r.length=function(e){for(var t=0,r=0,n=0;n<e.length;++n)(r=e.charCodeAt(n))<128?t+=1:r<2048?t+=2:55296==(64512&r)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},r.read=function(e,t,r){if(r-t<1)return"";for(var n,i=null,o=[],s=0;t<r;)(n=e[t++])<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},r.write=function(e,t,r){for(var n,i,o=r,s=0;s<e.length;++s)(n=e.charCodeAt(s))<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=e.charCodeAt(s+1)))?(n=65536+((1023&n)<<10)+(1023&i),++s,t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128);return r-o}}),pool_1=pool;function pool(e,t,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(r){if(r<1||r>i)return e(r);s+r>n&&(o=e(n),s=0);var a=t.call(o,s,s+=r);return 7&s&&(s=1+(7|s)),a}}var longbits=LongBits;function LongBits(e,t){this.lo=e>>>0,this.hi=t>>>0}var zero=LongBits.zero=new LongBits(0,0);zero.toNumber=function(){return 0},zero.zzEncode=zero.zzDecode=function(){return this},zero.length=function(){return 1};var zeroHash=LongBits.zeroHash="\0\0\0\0\0\0\0\0";LongBits.fromNumber=function(e){if(0===e)return zero;var t=e<0;t&&(e=-e);var r=e>>>0,n=(e-r)/4294967296>>>0;return t&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new LongBits(r,n)},LongBits.from=function(e){if("number"==typeof e)return LongBits.fromNumber(e);if(minimal.isString(e)){if(!minimal.Long)return LongBits.fromNumber(parseInt(e,10));e=minimal.Long.fromString(e)}return e.low||e.high?new LongBits(e.low>>>0,e.high>>>0):zero},LongBits.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+4294967296*r)}return this.lo+4294967296*this.hi},LongBits.prototype.toLong=function(e){return minimal.Long?new minimal.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var charCodeAt=String.prototype.charCodeAt;LongBits.fromHash=function(e){return e===zeroHash?zero:new LongBits((charCodeAt.call(e,0)|charCodeAt.call(e,1)<<8|charCodeAt.call(e,2)<<16|charCodeAt.call(e,3)<<24)>>>0,(charCodeAt.call(e,4)|charCodeAt.call(e,5)<<8|charCodeAt.call(e,6)<<16|charCodeAt.call(e,7)<<24)>>>0)},LongBits.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},LongBits.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},LongBits.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},LongBits.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10};var minimal=createCommonjsModule(function(e,t){var r=t;function n(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)void 0!==e[n[i]]&&r||(e[n[i]]=t[n[i]]);return e}function i(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&n(this,r)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=aspromise,r.base64=base64_1,r.EventEmitter=eventemitter,r.float=float_1,r.inquire=inquire_1,r.utf8=utf8_1,r.pool=pool_1,r.LongBits=longbits,r.isNode=Boolean(void 0!==commonjsGlobal&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),r.global=r.isNode&&commonjsGlobal||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||commonjsGlobal,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==typeof e},r.isset=r.isSet=function(e,t){var r=e[t];return!(null==r||!e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=n,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=i,r.ProtocolError=i("ProtocolError"),r.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},r.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}}),writer=Writer,BufferWriter,LongBits$1=minimal.LongBits,base64=minimal.base64,utf8=minimal.utf8;function Op(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function noop(){}function State(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function Writer(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create=function(){return minimal.Buffer?function(){return(Writer.create=function(){return new BufferWriter})()}:function(){return new Writer}};function writeByte(e,t,r){t[r]=255&e}function writeVarint32(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e}function VarintOp(e,t){this.len=e,this.next=void 0,this.val=t}function writeVarint64(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function writeFixed32(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}Writer.create=create(),Writer.alloc=function(e){return new minimal.Array(e)},minimal.Array!==Array&&(Writer.alloc=minimal.pool(Writer.alloc,minimal.Array.prototype.subarray)),Writer.prototype._push=function(e,t,r){return this.tail=this.tail.next=new Op(e,t,r),this.len+=t,this},VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new VarintOp((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},Writer.prototype.int32=function(e){return e<0?this._push(writeVarint64,10,LongBits$1.fromNumber(e)):this.uint32(e)},Writer.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},Writer.prototype.uint64=function(e){var t=LongBits$1.from(e);return this._push(writeVarint64,t.length(),t)},Writer.prototype.int64=Writer.prototype.uint64,Writer.prototype.sint64=function(e){var t=LongBits$1.from(e).zzEncode();return this._push(writeVarint64,t.length(),t)},Writer.prototype.bool=function(e){return this._push(writeByte,1,e?1:0)},Writer.prototype.fixed32=function(e){return this._push(writeFixed32,4,e>>>0)},Writer.prototype.sfixed32=Writer.prototype.fixed32,Writer.prototype.fixed64=function(e){var t=LongBits$1.from(e);return this._push(writeFixed32,4,t.lo)._push(writeFixed32,4,t.hi)},Writer.prototype.sfixed64=Writer.prototype.fixed64,Writer.prototype.float=function(e){return this._push(minimal.float.writeFloatLE,4,e)},Writer.prototype.double=function(e){return this._push(minimal.float.writeDoubleLE,8,e)};var writeBytes=minimal.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var n=0;n<e.length;++n)t[r+n]=e[n]};Writer.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(writeByte,1,0);if(minimal.isString(e)){var r=Writer.alloc(t=base64.length(e));base64.decode(e,r,0),e=r}return this.uint32(t)._push(writeBytes,t,e)},Writer.prototype.string=function(e){var t=utf8.length(e);return t?this.uint32(t)._push(utf8.write,t,e):this._push(writeByte,1,0)},Writer.prototype.fork=function(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},Writer.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},Writer._configure=function(e){BufferWriter=e,Writer.create=create(),BufferWriter._configure()};var writer_buffer=BufferWriter$1;function BufferWriter$1(){writer.call(this)}function writeStringBuffer(e,t,r){e.length<40?minimal.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}(BufferWriter$1.prototype=Object.create(writer.prototype)).constructor=BufferWriter$1,BufferWriter$1._configure=function(){BufferWriter$1.alloc=minimal._Buffer_allocUnsafe,BufferWriter$1.writeBytesBuffer=minimal.Buffer&&minimal.Buffer.prototype instanceof Uint8Array&&"set"===minimal.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var n=0;n<e.length;)t[r++]=e[n++]}},BufferWriter$1.prototype.bytes=function(e){minimal.isString(e)&&(e=minimal._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(BufferWriter$1.writeBytesBuffer,t,e),this},BufferWriter$1.prototype.string=function(e){var t=minimal.Buffer.byteLength(e);return this.uint32(t),t&&this._push(writeStringBuffer,t,e),this},BufferWriter$1._configure();var reader=Reader,BufferReader,LongBits$2=minimal.LongBits,utf8$1=minimal.utf8;function indexOutOfRange(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Reader(e){this.buf=e,this.pos=0,this.len=e.length}var create_array="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Reader(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Reader(e);throw Error("illegal buffer")},create$1=function(){return minimal.Buffer?function(e){return(Reader.create=function(e){return minimal.Buffer.isBuffer(e)?new BufferReader(e):create_array(e)})(e)}:create_array};function readLongVarint(){var e=new LongBits$2(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw indexOutOfRange(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function readFixed32_end(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits$2(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader.create=create$1(),Reader.prototype._slice=minimal.Array.prototype.subarray||minimal.Array.prototype.slice,Reader.prototype.uint32=function(){var e=4294967295;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return e;if(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return e;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return e}}(),Reader.prototype.int32=function(){return 0|this.uint32()},Reader.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},Reader.prototype.bool=function(){return 0!==this.uint32()},Reader.prototype.fixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.sfixed32=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return 0|readFixed32_end(this.buf,this.pos+=4)},Reader.prototype.float=function(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},Reader.prototype.double=function(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var e=minimal.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},Reader.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw indexOutOfRange(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,r):t===r?new this.buf.constructor(0):this._slice.call(this.buf,t,r)},Reader.prototype.string=function(){var e=this.bytes();return utf8$1.read(e,0,e.length)},Reader.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw indexOutOfRange(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw indexOutOfRange(this)}while(128&this.buf[this.pos++]);return this},Reader.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},Reader._configure=function(e){BufferReader=e,Reader.create=create$1(),BufferReader._configure();var t=minimal.Long?"toLong":"toNumber";minimal.merge(Reader.prototype,{int64:function(){return readLongVarint.call(this)[t](!1)},uint64:function(){return readLongVarint.call(this)[t](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[t](!1)},fixed64:function(){return readFixed64.call(this)[t](!0)},sfixed64:function(){return readFixed64.call(this)[t](!1)}})};var reader_buffer=BufferReader$1;function BufferReader$1(e){reader.call(this,e)}(BufferReader$1.prototype=Object.create(reader.prototype)).constructor=BufferReader$1,BufferReader$1._configure=function(){minimal.Buffer&&(BufferReader$1.prototype._slice=minimal.Buffer.prototype.slice)},BufferReader$1.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},BufferReader$1._configure();var service=Service;function Service(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");minimal.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(r)}(Service.prototype=Object.create(minimal.EventEmitter.prototype)).constructor=Service,Service.prototype.rpcCall=function e(t,r,n,i,o){if(!i)throw TypeError("request must be specified");var s=this;if(!o)return minimal.asPromise(e,s,t,r,n,i);if(s.rpcImpl)try{return s.rpcImpl(t,r[s.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(e,r){if(e)return s.emit("error",e,t),o(e);if(null!==r){if(!(r instanceof n))try{r=n[s.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return s.emit("error",e,t),o(e)}return s.emit("data",r,t),o(null,r)}s.end(!0)})}catch(e){return s.emit("error",e,t),void setTimeout(function(){o(e)},0)}else setTimeout(function(){o(Error("already ended"))},0)},Service.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this};var rpc_1=createCommonjsModule(function(e,t){t.Service=service}),roots={},indexMinimal=createCommonjsModule(function(e,t){var r=t;function n(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=writer,r.BufferWriter=writer_buffer,r.Reader=reader,r.BufferReader=reader_buffer,r.util=minimal,r.rpc=rpc_1,r.roots=roots,r.configure=n,n()}),minimal$1=indexMinimal,$Reader=minimal$1.Reader,$Writer=minimal$1.Writer,$util=minimal$1.util,$root=minimal$1.roots.default||(minimal$1.roots.default={});$root.genvid=function(){var e,t,r,n={};return n.proto=((r={}).DataFrames=function(){function e(e){if(this.annotations=[],this.streams=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.annotations=$util.emptyArray,e.prototype.streams=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.annotations&&e.annotations.length)for(var r=0;r<e.annotations.length;++r)$root.genvid.proto.Stream.encode(e.annotations[r],t.uint32(10).fork()).ldelim();if(null!=e.streams&&e.streams.length)for(r=0;r<e.streams.length;++r)$root.genvid.proto.Stream.encode(e.streams[r],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.DataFrames;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.annotations&&n.annotations.length||(n.annotations=[]),n.annotations.push($root.genvid.proto.Stream.decode(e,e.uint32()));break;case 2:n.streams&&n.streams.length||(n.streams=[]),n.streams.push($root.genvid.proto.Stream.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.annotations&&e.hasOwnProperty("annotations")){if(!Array.isArray(e.annotations))return"annotations: array expected";for(var t=0;t<e.annotations.length;++t)if(r=$root.genvid.proto.Stream.verify(e.annotations[t]))return"annotations."+r}if(null!=e.streams&&e.hasOwnProperty("streams")){if(!Array.isArray(e.streams))return"streams: array expected";for(t=0;t<e.streams.length;++t){var r;if(r=$root.genvid.proto.Stream.verify(e.streams[t]))return"streams."+r}}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.DataFrames)return e;var t=new $root.genvid.proto.DataFrames;if(e.annotations){if(!Array.isArray(e.annotations))throw TypeError(".genvid.proto.DataFrames.annotations: array expected");t.annotations=[];for(var r=0;r<e.annotations.length;++r){if("object"!=typeof e.annotations[r])throw TypeError(".genvid.proto.DataFrames.annotations: object expected");t.annotations[r]=$root.genvid.proto.Stream.fromObject(e.annotations[r])}}if(e.streams){if(!Array.isArray(e.streams))throw TypeError(".genvid.proto.DataFrames.streams: array expected");for(t.streams=[],r=0;r<e.streams.length;++r){if("object"!=typeof e.streams[r])throw TypeError(".genvid.proto.DataFrames.streams: object expected");t.streams[r]=$root.genvid.proto.Stream.fromObject(e.streams[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.annotations=[],r.streams=[]),e.annotations&&e.annotations.length){r.annotations=[];for(var n=0;n<e.annotations.length;++n)r.annotations[n]=$root.genvid.proto.Stream.toObject(e.annotations[n],t)}if(e.streams&&e.streams.length)for(r.streams=[],n=0;n<e.streams.length;++n)r.streams[n]=$root.genvid.proto.Stream.toObject(e.streams[n],t);return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Stream=function(){function e(e){if(this.frames=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.id="",e.prototype.fps=0,e.prototype.sessionId="",e.prototype.frames=$util.emptyArray,e.prototype.v2SessionId=0,e.prototype.v2SourceId=0,e.prototype.v2StreamId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(10).string(e.id),null!=e.fps&&Object.hasOwnProperty.call(e,"fps")&&t.uint32(17).double(e.fps),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(26).string(e.sessionId),null!=e.frames&&e.frames.length)for(var r=0;r<e.frames.length;++r)$root.genvid.proto.Frame.encode(e.frames[r],t.uint32(34).fork()).ldelim();return null!=e.v2SessionId&&Object.hasOwnProperty.call(e,"v2SessionId")&&t.uint32(40).uint32(e.v2SessionId),null!=e.v2SourceId&&Object.hasOwnProperty.call(e,"v2SourceId")&&t.uint32(48).uint32(e.v2SourceId),null!=e.v2StreamId&&Object.hasOwnProperty.call(e,"v2StreamId")&&t.uint32(56).uint32(e.v2StreamId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Stream;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.id=e.string();break;case 2:n.fps=e.double();break;case 3:n.sessionId=e.string();break;case 4:n.frames&&n.frames.length||(n.frames=[]),n.frames.push($root.genvid.proto.Frame.decode(e,e.uint32()));break;case 5:n.v2SessionId=e.uint32();break;case 6:n.v2SourceId=e.uint32();break;case 7:n.v2StreamId=e.uint32();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.id&&e.hasOwnProperty("id")&&!$util.isString(e.id))return"id: string expected";if(null!=e.fps&&e.hasOwnProperty("fps")&&"number"!=typeof e.fps)return"fps: number expected";if(null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!$util.isString(e.sessionId))return"sessionId: string expected";if(null!=e.frames&&e.hasOwnProperty("frames")){if(!Array.isArray(e.frames))return"frames: array expected";for(var t=0;t<e.frames.length;++t){var r=$root.genvid.proto.Frame.verify(e.frames[t]);if(r)return"frames."+r}}return null!=e.v2SessionId&&e.hasOwnProperty("v2SessionId")&&!$util.isInteger(e.v2SessionId)?"v2SessionId: integer expected":null!=e.v2SourceId&&e.hasOwnProperty("v2SourceId")&&!$util.isInteger(e.v2SourceId)?"v2SourceId: integer expected":null!=e.v2StreamId&&e.hasOwnProperty("v2StreamId")&&!$util.isInteger(e.v2StreamId)?"v2StreamId: integer expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Stream)return e;var t=new $root.genvid.proto.Stream;if(null!=e.id&&(t.id=String(e.id)),null!=e.fps&&(t.fps=Number(e.fps)),null!=e.sessionId&&(t.sessionId=String(e.sessionId)),e.frames){if(!Array.isArray(e.frames))throw TypeError(".genvid.proto.Stream.frames: array expected");t.frames=[];for(var r=0;r<e.frames.length;++r){if("object"!=typeof e.frames[r])throw TypeError(".genvid.proto.Stream.frames: object expected");t.frames[r]=$root.genvid.proto.Frame.fromObject(e.frames[r])}}return null!=e.v2SessionId&&(t.v2SessionId=e.v2SessionId>>>0),null!=e.v2SourceId&&(t.v2SourceId=e.v2SourceId>>>0),null!=e.v2StreamId&&(t.v2StreamId=e.v2StreamId>>>0),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.frames=[]),t.defaults&&(r.id="",r.fps=0,r.sessionId="",r.v2SessionId=0,r.v2SourceId=0,r.v2StreamId=0),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),null!=e.fps&&e.hasOwnProperty("fps")&&(r.fps=t.json&&!isFinite(e.fps)?String(e.fps):e.fps),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(r.sessionId=e.sessionId),e.frames&&e.frames.length){r.frames=[];for(var n=0;n<e.frames.length;++n)r.frames[n]=$root.genvid.proto.Frame.toObject(e.frames[n],t)}return null!=e.v2SessionId&&e.hasOwnProperty("v2SessionId")&&(r.v2SessionId=e.v2SessionId),null!=e.v2SourceId&&e.hasOwnProperty("v2SourceId")&&(r.v2SourceId=e.v2SourceId),null!=e.v2StreamId&&e.hasOwnProperty("v2StreamId")&&(r.v2StreamId=e.v2StreamId),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.StreamFormat=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.sessionId=0,e.prototype.sourceId=0,e.prototype.streamId=0,e.prototype.sessionName="",e.prototype.sourceName="",e.prototype.streamName="",e.prototype.fps=0,e.prototype.alive=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(8).uint32(e.sessionId),null!=e.sourceId&&Object.hasOwnProperty.call(e,"sourceId")&&t.uint32(16).uint32(e.sourceId),null!=e.streamId&&Object.hasOwnProperty.call(e,"streamId")&&t.uint32(24).uint32(e.streamId),null!=e.sessionName&&Object.hasOwnProperty.call(e,"sessionName")&&t.uint32(34).string(e.sessionName),null!=e.sourceName&&Object.hasOwnProperty.call(e,"sourceName")&&t.uint32(42).string(e.sourceName),null!=e.streamName&&Object.hasOwnProperty.call(e,"streamName")&&t.uint32(50).string(e.streamName),null!=e.fps&&Object.hasOwnProperty.call(e,"fps")&&t.uint32(61).float(e.fps),null!=e.alive&&Object.hasOwnProperty.call(e,"alive")&&t.uint32(64).bool(e.alive),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.StreamFormat;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.sessionId=e.uint32();break;case 2:n.sourceId=e.uint32();break;case 3:n.streamId=e.uint32();break;case 4:n.sessionName=e.string();break;case 5:n.sourceName=e.string();break;case 6:n.streamName=e.string();break;case 7:n.fps=e.float();break;case 8:n.alive=e.bool();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!$util.isInteger(e.sessionId)?"sessionId: integer expected":null!=e.sourceId&&e.hasOwnProperty("sourceId")&&!$util.isInteger(e.sourceId)?"sourceId: integer expected":null!=e.streamId&&e.hasOwnProperty("streamId")&&!$util.isInteger(e.streamId)?"streamId: integer expected":null!=e.sessionName&&e.hasOwnProperty("sessionName")&&!$util.isString(e.sessionName)?"sessionName: string expected":null!=e.sourceName&&e.hasOwnProperty("sourceName")&&!$util.isString(e.sourceName)?"sourceName: string expected":null!=e.streamName&&e.hasOwnProperty("streamName")&&!$util.isString(e.streamName)?"streamName: string expected":null!=e.fps&&e.hasOwnProperty("fps")&&"number"!=typeof e.fps?"fps: number expected":null!=e.alive&&e.hasOwnProperty("alive")&&"boolean"!=typeof e.alive?"alive: boolean expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.StreamFormat)return e;var t=new $root.genvid.proto.StreamFormat;return null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.sourceId&&(t.sourceId=e.sourceId>>>0),null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.sessionName&&(t.sessionName=String(e.sessionName)),null!=e.sourceName&&(t.sourceName=String(e.sourceName)),null!=e.streamName&&(t.streamName=String(e.streamName)),null!=e.fps&&(t.fps=Number(e.fps)),null!=e.alive&&(t.alive=Boolean(e.alive)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.sessionId=0,r.sourceId=0,r.streamId=0,r.sessionName="",r.sourceName="",r.streamName="",r.fps=0,r.alive=!1),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(r.sessionId=e.sessionId),null!=e.sourceId&&e.hasOwnProperty("sourceId")&&(r.sourceId=e.sourceId),null!=e.streamId&&e.hasOwnProperty("streamId")&&(r.streamId=e.streamId),null!=e.sessionName&&e.hasOwnProperty("sessionName")&&(r.sessionName=e.sessionName),null!=e.sourceName&&e.hasOwnProperty("sourceName")&&(r.sourceName=e.sourceName),null!=e.streamName&&e.hasOwnProperty("streamName")&&(r.streamName=e.streamName),null!=e.fps&&e.hasOwnProperty("fps")&&(r.fps=t.json&&!isFinite(e.fps)?String(e.fps):e.fps),null!=e.alive&&e.hasOwnProperty("alive")&&(r.alive=e.alive),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Frame=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timecode=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.pts=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.timestamp=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sendingTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.startIngestTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.composition=null,e.prototype.data=$util.newBuffer([]),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.timecode&&Object.hasOwnProperty.call(e,"timecode")&&t.uint32(8).int64(e.timecode),null!=e.pts&&Object.hasOwnProperty.call(e,"pts")&&t.uint32(16).int64(e.pts),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(24).int64(e.timestamp),null!=e.sendingTime&&Object.hasOwnProperty.call(e,"sendingTime")&&t.uint32(32).int64(e.sendingTime),null!=e.startIngestTime&&Object.hasOwnProperty.call(e,"startIngestTime")&&t.uint32(40).int64(e.startIngestTime),null!=e.composition&&Object.hasOwnProperty.call(e,"composition")&&$root.genvid.proto.Composition.encode(e.composition,t.uint32(50).fork()).ldelim(),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(58).bytes(e.data),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Frame;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.timecode=e.int64();break;case 2:n.pts=e.int64();break;case 3:n.timestamp=e.int64();break;case 4:n.sendingTime=e.int64();break;case 5:n.startIngestTime=e.int64();break;case 6:n.composition=$root.genvid.proto.Composition.decode(e,e.uint32());break;case 7:n.data=e.bytes();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.timecode&&e.hasOwnProperty("timecode")&&!($util.isInteger(e.timecode)||e.timecode&&$util.isInteger(e.timecode.low)&&$util.isInteger(e.timecode.high)))return"timecode: integer|Long expected";if(null!=e.pts&&e.hasOwnProperty("pts")&&!($util.isInteger(e.pts)||e.pts&&$util.isInteger(e.pts.low)&&$util.isInteger(e.pts.high)))return"pts: integer|Long expected";if(null!=e.timestamp&&e.hasOwnProperty("timestamp")&&!($util.isInteger(e.timestamp)||e.timestamp&&$util.isInteger(e.timestamp.low)&&$util.isInteger(e.timestamp.high)))return"timestamp: integer|Long expected";if(null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&!($util.isInteger(e.sendingTime)||e.sendingTime&&$util.isInteger(e.sendingTime.low)&&$util.isInteger(e.sendingTime.high)))return"sendingTime: integer|Long expected";if(null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&!($util.isInteger(e.startIngestTime)||e.startIngestTime&&$util.isInteger(e.startIngestTime.low)&&$util.isInteger(e.startIngestTime.high)))return"startIngestTime: integer|Long expected";if(null!=e.composition&&e.hasOwnProperty("composition")){var t=$root.genvid.proto.Composition.verify(e.composition);if(t)return"composition."+t}return null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||$util.isString(e.data))?"data: buffer expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Frame)return e;var t=new $root.genvid.proto.Frame;if(null!=e.timecode&&($util.Long?(t.timecode=$util.Long.fromValue(e.timecode)).unsigned=!1:"string"==typeof e.timecode?t.timecode=parseInt(e.timecode,10):"number"==typeof e.timecode?t.timecode=e.timecode:"object"==typeof e.timecode&&(t.timecode=new $util.LongBits(e.timecode.low>>>0,e.timecode.high>>>0).toNumber())),null!=e.pts&&($util.Long?(t.pts=$util.Long.fromValue(e.pts)).unsigned=!1:"string"==typeof e.pts?t.pts=parseInt(e.pts,10):"number"==typeof e.pts?t.pts=e.pts:"object"==typeof e.pts&&(t.pts=new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber())),null!=e.timestamp&&($util.Long?(t.timestamp=$util.Long.fromValue(e.timestamp)).unsigned=!1:"string"==typeof e.timestamp?t.timestamp=parseInt(e.timestamp,10):"number"==typeof e.timestamp?t.timestamp=e.timestamp:"object"==typeof e.timestamp&&(t.timestamp=new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber())),null!=e.sendingTime&&($util.Long?(t.sendingTime=$util.Long.fromValue(e.sendingTime)).unsigned=!1:"string"==typeof e.sendingTime?t.sendingTime=parseInt(e.sendingTime,10):"number"==typeof e.sendingTime?t.sendingTime=e.sendingTime:"object"==typeof e.sendingTime&&(t.sendingTime=new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber())),null!=e.startIngestTime&&($util.Long?(t.startIngestTime=$util.Long.fromValue(e.startIngestTime)).unsigned=!1:"string"==typeof e.startIngestTime?t.startIngestTime=parseInt(e.startIngestTime,10):"number"==typeof e.startIngestTime?t.startIngestTime=e.startIngestTime:"object"==typeof e.startIngestTime&&(t.startIngestTime=new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber())),null!=e.composition){if("object"!=typeof e.composition)throw TypeError(".genvid.proto.Frame.composition: object expected");t.composition=$root.genvid.proto.Composition.fromObject(e.composition)}return null!=e.data&&("string"==typeof e.data?$util.base64.decode(e.data,t.data=$util.newBuffer($util.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if($util.Long){var n=new $util.Long(0,0,!1);r.timecode=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.timecode=t.longs===String?"0":0;$util.Long?(n=new $util.Long(0,0,!1),r.pts=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.pts=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.timestamp=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.timestamp=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.sendingTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.sendingTime=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.startIngestTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.startIngestTime=t.longs===String?"0":0,r.composition=null,t.bytes===String?r.data="":(r.data=[],t.bytes!==Array&&(r.data=$util.newBuffer(r.data)))}return null!=e.timecode&&e.hasOwnProperty("timecode")&&("number"==typeof e.timecode?r.timecode=t.longs===String?String(e.timecode):e.timecode:r.timecode=t.longs===String?$util.Long.prototype.toString.call(e.timecode):t.longs===Number?new $util.LongBits(e.timecode.low>>>0,e.timecode.high>>>0).toNumber():e.timecode),null!=e.pts&&e.hasOwnProperty("pts")&&("number"==typeof e.pts?r.pts=t.longs===String?String(e.pts):e.pts:r.pts=t.longs===String?$util.Long.prototype.toString.call(e.pts):t.longs===Number?new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber():e.pts),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&("number"==typeof e.timestamp?r.timestamp=t.longs===String?String(e.timestamp):e.timestamp:r.timestamp=t.longs===String?$util.Long.prototype.toString.call(e.timestamp):t.longs===Number?new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber():e.timestamp),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&("number"==typeof e.sendingTime?r.sendingTime=t.longs===String?String(e.sendingTime):e.sendingTime:r.sendingTime=t.longs===String?$util.Long.prototype.toString.call(e.sendingTime):t.longs===Number?new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber():e.sendingTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&("number"==typeof e.startIngestTime?r.startIngestTime=t.longs===String?String(e.startIngestTime):e.startIngestTime:r.startIngestTime=t.longs===String?$util.Long.prototype.toString.call(e.startIngestTime):t.longs===Number?new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber():e.startIngestTime),null!=e.composition&&e.hasOwnProperty("composition")&&(r.composition=$root.genvid.proto.Composition.toObject(e.composition,t)),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?$util.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Composition=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.item=null,e.prototype.components=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.item&&Object.hasOwnProperty.call(e,"item")&&$root.genvid.proto.Item.encode(e.item,t.uint32(10).fork()).ldelim(),null!=e.components&&Object.hasOwnProperty.call(e,"components")&&$root.genvid.proto.Component.encode(e.components,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Composition;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.item=$root.genvid.proto.Item.decode(e,e.uint32());break;case 2:n.components=$root.genvid.proto.Component.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.item&&e.hasOwnProperty("item")&&(t=$root.genvid.proto.Item.verify(e.item))?"item."+t:null!=e.components&&e.hasOwnProperty("components")&&(t=$root.genvid.proto.Component.verify(e.components))?"components."+t:null;var t},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Composition)return e;var t=new $root.genvid.proto.Composition;if(null!=e.item){if("object"!=typeof e.item)throw TypeError(".genvid.proto.Composition.item: object expected");t.item=$root.genvid.proto.Item.fromObject(e.item)}if(null!=e.components){if("object"!=typeof e.components)throw TypeError(".genvid.proto.Composition.components: object expected");t.components=$root.genvid.proto.Component.fromObject(e.components)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.item=null,r.components=null),null!=e.item&&e.hasOwnProperty("item")&&(r.item=$root.genvid.proto.Item.toObject(e.item,t)),null!=e.components&&e.hasOwnProperty("components")&&(r.components=$root.genvid.proto.Component.toObject(e.components,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Component=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.item=null,e.prototype.affine=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.item&&Object.hasOwnProperty.call(e,"item")&&$root.genvid.proto.Item.encode(e.item,t.uint32(10).fork()).ldelim(),null!=e.affine&&Object.hasOwnProperty.call(e,"affine")&&$root.genvid.proto.Affine.encode(e.affine,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Component;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.item=$root.genvid.proto.Item.decode(e,e.uint32());break;case 2:n.affine=$root.genvid.proto.Affine.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.item&&e.hasOwnProperty("item")&&(t=$root.genvid.proto.Item.verify(e.item))?"item."+t:null!=e.affine&&e.hasOwnProperty("affine")&&(t=$root.genvid.proto.Affine.verify(e.affine))?"affine."+t:null;var t},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Component)return e;var t=new $root.genvid.proto.Component;if(null!=e.item){if("object"!=typeof e.item)throw TypeError(".genvid.proto.Component.item: object expected");t.item=$root.genvid.proto.Item.fromObject(e.item)}if(null!=e.affine){if("object"!=typeof e.affine)throw TypeError(".genvid.proto.Component.affine: object expected");t.affine=$root.genvid.proto.Affine.fromObject(e.affine)}return t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.item=null,r.affine=null),null!=e.item&&e.hasOwnProperty("item")&&(r.item=$root.genvid.proto.Item.toObject(e.item,t)),null!=e.affine&&e.hasOwnProperty("affine")&&(r.affine=$root.genvid.proto.Affine.toObject(e.affine,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Item=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.timestamp=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sessionid=0,e.prototype.streamid=0,e.prototype.classname="",e.prototype.sourceid=0,e.prototype.videoSourceCompositionType="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(8).int64(e.timestamp),null!=e.sessionid&&Object.hasOwnProperty.call(e,"sessionid")&&t.uint32(16).uint32(e.sessionid),null!=e.streamid&&Object.hasOwnProperty.call(e,"streamid")&&t.uint32(24).int32(e.streamid),null!=e.classname&&Object.hasOwnProperty.call(e,"classname")&&t.uint32(34).string(e.classname),null!=e.sourceid&&Object.hasOwnProperty.call(e,"sourceid")&&t.uint32(40).uint32(e.sourceid),null!=e.videoSourceCompositionType&&Object.hasOwnProperty.call(e,"videoSourceCompositionType")&&t.uint32(50).string(e.videoSourceCompositionType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Item;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.timestamp=e.int64();break;case 2:n.sessionid=e.uint32();break;case 3:n.streamid=e.int32();break;case 4:n.classname=e.string();break;case 5:n.sourceid=e.uint32();break;case 6:n.videoSourceCompositionType=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.timestamp&&e.hasOwnProperty("timestamp")&&!($util.isInteger(e.timestamp)||e.timestamp&&$util.isInteger(e.timestamp.low)&&$util.isInteger(e.timestamp.high))?"timestamp: integer|Long expected":null!=e.sessionid&&e.hasOwnProperty("sessionid")&&!$util.isInteger(e.sessionid)?"sessionid: integer expected":null!=e.streamid&&e.hasOwnProperty("streamid")&&!$util.isInteger(e.streamid)?"streamid: integer expected":null!=e.classname&&e.hasOwnProperty("classname")&&!$util.isString(e.classname)?"classname: string expected":null!=e.sourceid&&e.hasOwnProperty("sourceid")&&!$util.isInteger(e.sourceid)?"sourceid: integer expected":null!=e.videoSourceCompositionType&&e.hasOwnProperty("videoSourceCompositionType")&&!$util.isString(e.videoSourceCompositionType)?"videoSourceCompositionType: string expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Item)return e;var t=new $root.genvid.proto.Item;return null!=e.timestamp&&($util.Long?(t.timestamp=$util.Long.fromValue(e.timestamp)).unsigned=!1:"string"==typeof e.timestamp?t.timestamp=parseInt(e.timestamp,10):"number"==typeof e.timestamp?t.timestamp=e.timestamp:"object"==typeof e.timestamp&&(t.timestamp=new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber())),null!=e.sessionid&&(t.sessionid=e.sessionid>>>0),null!=e.streamid&&(t.streamid=0|e.streamid),null!=e.classname&&(t.classname=String(e.classname)),null!=e.sourceid&&(t.sourceid=e.sourceid>>>0),null!=e.videoSourceCompositionType&&(t.videoSourceCompositionType=String(e.videoSourceCompositionType)),t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if($util.Long){var n=new $util.Long(0,0,!1);r.timestamp=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.timestamp=t.longs===String?"0":0;r.sessionid=0,r.streamid=0,r.classname="",r.sourceid=0,r.videoSourceCompositionType=""}return null!=e.timestamp&&e.hasOwnProperty("timestamp")&&("number"==typeof e.timestamp?r.timestamp=t.longs===String?String(e.timestamp):e.timestamp:r.timestamp=t.longs===String?$util.Long.prototype.toString.call(e.timestamp):t.longs===Number?new $util.LongBits(e.timestamp.low>>>0,e.timestamp.high>>>0).toNumber():e.timestamp),null!=e.sessionid&&e.hasOwnProperty("sessionid")&&(r.sessionid=e.sessionid),null!=e.streamid&&e.hasOwnProperty("streamid")&&(r.streamid=e.streamid),null!=e.classname&&e.hasOwnProperty("classname")&&(r.classname=e.classname),null!=e.sourceid&&e.hasOwnProperty("sourceid")&&(r.sourceid=e.sourceid),null!=e.videoSourceCompositionType&&e.hasOwnProperty("videoSourceCompositionType")&&(r.videoSourceCompositionType=e.videoSourceCompositionType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Affine=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.source=null,e.prototype.matrix=null,e.prototype.opacity=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.source&&Object.hasOwnProperty.call(e,"source")&&$root.genvid.proto.Item.encode(e.source,t.uint32(10).fork()).ldelim(),null!=e.matrix&&Object.hasOwnProperty.call(e,"matrix")&&$root.genvid.proto.Matrix3.encode(e.matrix,t.uint32(18).fork()).ldelim(),null!=e.opacity&&Object.hasOwnProperty.call(e,"opacity")&&t.uint32(29).float(e.opacity),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Affine;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.source=$root.genvid.proto.Item.decode(e,e.uint32());break;case 2:n.matrix=$root.genvid.proto.Matrix3.decode(e,e.uint32());break;case 3:n.opacity=e.float();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.source&&e.hasOwnProperty("source")&&(t=$root.genvid.proto.Item.verify(e.source))?"source."+t:null!=e.matrix&&e.hasOwnProperty("matrix")&&(t=$root.genvid.proto.Matrix3.verify(e.matrix))?"matrix."+t:null!=e.opacity&&e.hasOwnProperty("opacity")&&"number"!=typeof e.opacity?"opacity: number expected":null;var t},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Affine)return e;var t=new $root.genvid.proto.Affine;if(null!=e.source){if("object"!=typeof e.source)throw TypeError(".genvid.proto.Affine.source: object expected");t.source=$root.genvid.proto.Item.fromObject(e.source)}if(null!=e.matrix){if("object"!=typeof e.matrix)throw TypeError(".genvid.proto.Affine.matrix: object expected");t.matrix=$root.genvid.proto.Matrix3.fromObject(e.matrix)}return null!=e.opacity&&(t.opacity=Number(e.opacity)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.source=null,r.matrix=null,r.opacity=0),null!=e.source&&e.hasOwnProperty("source")&&(r.source=$root.genvid.proto.Item.toObject(e.source,t)),null!=e.matrix&&e.hasOwnProperty("matrix")&&(r.matrix=$root.genvid.proto.Matrix3.toObject(e.matrix,t)),null!=e.opacity&&e.hasOwnProperty("opacity")&&(r.opacity=t.json&&!isFinite(e.opacity)?String(e.opacity):e.opacity),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Matrix3=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.c0r0=0,e.prototype.c0r1=0,e.prototype.c0r2=0,e.prototype.c1r0=0,e.prototype.c1r1=0,e.prototype.c1r2=0,e.prototype.c2r0=0,e.prototype.c2r1=0,e.prototype.c2r2=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.c0r0&&Object.hasOwnProperty.call(e,"c0r0")&&t.uint32(13).float(e.c0r0),null!=e.c0r1&&Object.hasOwnProperty.call(e,"c0r1")&&t.uint32(21).float(e.c0r1),null!=e.c0r2&&Object.hasOwnProperty.call(e,"c0r2")&&t.uint32(29).float(e.c0r2),null!=e.c1r0&&Object.hasOwnProperty.call(e,"c1r0")&&t.uint32(37).float(e.c1r0),null!=e.c1r1&&Object.hasOwnProperty.call(e,"c1r1")&&t.uint32(45).float(e.c1r1),null!=e.c1r2&&Object.hasOwnProperty.call(e,"c1r2")&&t.uint32(53).float(e.c1r2),null!=e.c2r0&&Object.hasOwnProperty.call(e,"c2r0")&&t.uint32(61).float(e.c2r0),null!=e.c2r1&&Object.hasOwnProperty.call(e,"c2r1")&&t.uint32(69).float(e.c2r1),null!=e.c2r2&&Object.hasOwnProperty.call(e,"c2r2")&&t.uint32(77).float(e.c2r2),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Matrix3;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.c0r0=e.float();break;case 2:n.c0r1=e.float();break;case 3:n.c0r2=e.float();break;case 4:n.c1r0=e.float();break;case 5:n.c1r1=e.float();break;case 6:n.c1r2=e.float();break;case 7:n.c2r0=e.float();break;case 8:n.c2r1=e.float();break;case 9:n.c2r2=e.float();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.c0r0&&e.hasOwnProperty("c0r0")&&"number"!=typeof e.c0r0?"c0r0: number expected":null!=e.c0r1&&e.hasOwnProperty("c0r1")&&"number"!=typeof e.c0r1?"c0r1: number expected":null!=e.c0r2&&e.hasOwnProperty("c0r2")&&"number"!=typeof e.c0r2?"c0r2: number expected":null!=e.c1r0&&e.hasOwnProperty("c1r0")&&"number"!=typeof e.c1r0?"c1r0: number expected":null!=e.c1r1&&e.hasOwnProperty("c1r1")&&"number"!=typeof e.c1r1?"c1r1: number expected":null!=e.c1r2&&e.hasOwnProperty("c1r2")&&"number"!=typeof e.c1r2?"c1r2: number expected":null!=e.c2r0&&e.hasOwnProperty("c2r0")&&"number"!=typeof e.c2r0?"c2r0: number expected":null!=e.c2r1&&e.hasOwnProperty("c2r1")&&"number"!=typeof e.c2r1?"c2r1: number expected":null!=e.c2r2&&e.hasOwnProperty("c2r2")&&"number"!=typeof e.c2r2?"c2r2: number expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Matrix3)return e;var t=new $root.genvid.proto.Matrix3;return null!=e.c0r0&&(t.c0r0=Number(e.c0r0)),null!=e.c0r1&&(t.c0r1=Number(e.c0r1)),null!=e.c0r2&&(t.c0r2=Number(e.c0r2)),null!=e.c1r0&&(t.c1r0=Number(e.c1r0)),null!=e.c1r1&&(t.c1r1=Number(e.c1r1)),null!=e.c1r2&&(t.c1r2=Number(e.c1r2)),null!=e.c2r0&&(t.c2r0=Number(e.c2r0)),null!=e.c2r1&&(t.c2r1=Number(e.c2r1)),null!=e.c2r2&&(t.c2r2=Number(e.c2r2)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.c0r0=0,r.c0r1=0,r.c0r2=0,r.c1r0=0,r.c1r1=0,r.c1r2=0,r.c2r0=0,r.c2r1=0,r.c2r2=0),null!=e.c0r0&&e.hasOwnProperty("c0r0")&&(r.c0r0=t.json&&!isFinite(e.c0r0)?String(e.c0r0):e.c0r0),null!=e.c0r1&&e.hasOwnProperty("c0r1")&&(r.c0r1=t.json&&!isFinite(e.c0r1)?String(e.c0r1):e.c0r1),null!=e.c0r2&&e.hasOwnProperty("c0r2")&&(r.c0r2=t.json&&!isFinite(e.c0r2)?String(e.c0r2):e.c0r2),null!=e.c1r0&&e.hasOwnProperty("c1r0")&&(r.c1r0=t.json&&!isFinite(e.c1r0)?String(e.c1r0):e.c1r0),null!=e.c1r1&&e.hasOwnProperty("c1r1")&&(r.c1r1=t.json&&!isFinite(e.c1r1)?String(e.c1r1):e.c1r1),null!=e.c1r2&&e.hasOwnProperty("c1r2")&&(r.c1r2=t.json&&!isFinite(e.c1r2)?String(e.c1r2):e.c1r2),null!=e.c2r0&&e.hasOwnProperty("c2r0")&&(r.c2r0=t.json&&!isFinite(e.c2r0)?String(e.c2r0):e.c2r0),null!=e.c2r1&&e.hasOwnProperty("c2r1")&&(r.c2r1=t.json&&!isFinite(e.c2r1)?String(e.c2r1):e.c2r1),null!=e.c2r2&&e.hasOwnProperty("c2r2")&&(r.c2r2=t.json&&!isFinite(e.c2r2)?String(e.c2r2):e.c2r2),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.DebugConfig=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.streamIdStampingEnabled=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.streamIdStampingEnabled&&Object.hasOwnProperty.call(e,"streamIdStampingEnabled")&&t.uint32(8).bool(e.streamIdStampingEnabled),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.DebugConfig;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.streamIdStampingEnabled=e.bool();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.streamIdStampingEnabled&&e.hasOwnProperty("streamIdStampingEnabled")&&"boolean"!=typeof e.streamIdStampingEnabled?"streamIdStampingEnabled: boolean expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.DebugConfig)return e;var t=new $root.genvid.proto.DebugConfig;return null!=e.streamIdStampingEnabled&&(t.streamIdStampingEnabled=Boolean(e.streamIdStampingEnabled)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.streamIdStampingEnabled=!1),null!=e.streamIdStampingEnabled&&e.hasOwnProperty("streamIdStampingEnabled")&&(r.streamIdStampingEnabled=e.streamIdStampingEnabled),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.DataNotifications=function(){function e(e){if(this.notifications=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.notifications=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.notifications&&e.notifications.length)for(var r=0;r<e.notifications.length;++r)$root.genvid.proto.DataNotification.encode(e.notifications[r],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.DataNotifications;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.notifications&&n.notifications.length||(n.notifications=[]),n.notifications.push($root.genvid.proto.DataNotification.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.notifications&&e.hasOwnProperty("notifications")){if(!Array.isArray(e.notifications))return"notifications: array expected";for(var t=0;t<e.notifications.length;++t){var r=$root.genvid.proto.DataNotification.verify(e.notifications[t]);if(r)return"notifications."+r}}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.DataNotifications)return e;var t=new $root.genvid.proto.DataNotifications;if(e.notifications){if(!Array.isArray(e.notifications))throw TypeError(".genvid.proto.DataNotifications.notifications: array expected");t.notifications=[];for(var r=0;r<e.notifications.length;++r){if("object"!=typeof e.notifications[r])throw TypeError(".genvid.proto.DataNotifications.notifications: object expected");t.notifications[r]=$root.genvid.proto.DataNotification.fromObject(e.notifications[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.notifications=[]),e.notifications&&e.notifications.length){r.notifications=[];for(var n=0;n<e.notifications.length;++n)r.notifications[n]=$root.genvid.proto.DataNotification.toObject(e.notifications[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.DataNotification=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.id="",e.prototype.data=$util.newBuffer([]),e.prototype.sessionid="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(10).string(e.id),null!=e.data&&Object.hasOwnProperty.call(e,"data")&&t.uint32(18).bytes(e.data),null!=e.sessionid&&Object.hasOwnProperty.call(e,"sessionid")&&t.uint32(26).string(e.sessionid),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.DataNotification;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.id=e.string();break;case 2:n.data=e.bytes();break;case 3:n.sessionid=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.id&&e.hasOwnProperty("id")&&!$util.isString(e.id)?"id: string expected":null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||$util.isString(e.data))?"data: buffer expected":null!=e.sessionid&&e.hasOwnProperty("sessionid")&&!$util.isString(e.sessionid)?"sessionid: string expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.DataNotification)return e;var t=new $root.genvid.proto.DataNotification;return null!=e.id&&(t.id=String(e.id)),null!=e.data&&("string"==typeof e.data?$util.base64.decode(e.data,t.data=$util.newBuffer($util.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.sessionid&&(t.sessionid=String(e.sessionid)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.id="",t.bytes===String?r.data="":(r.data=[],t.bytes!==Array&&(r.data=$util.newBuffer(r.data))),r.sessionid=""),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),null!=e.data&&e.hasOwnProperty("data")&&(r.data=t.bytes===String?$util.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),null!=e.sessionid&&e.hasOwnProperty("sessionid")&&(r.sessionid=e.sessionid),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Event=function(){function e(e){if(this.keyValue=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.keyValue=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.keyValue&&e.keyValue.length)for(var r=0;r<e.keyValue.length;++r)$root.genvid.proto.KeyValue.encode(e.keyValue[r],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Event;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.keyValue&&n.keyValue.length||(n.keyValue=[]),n.keyValue.push($root.genvid.proto.KeyValue.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.keyValue&&e.hasOwnProperty("keyValue")){if(!Array.isArray(e.keyValue))return"keyValue: array expected";for(var t=0;t<e.keyValue.length;++t){var r=$root.genvid.proto.KeyValue.verify(e.keyValue[t]);if(r)return"keyValue."+r}}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Event)return e;var t=new $root.genvid.proto.Event;if(e.keyValue){if(!Array.isArray(e.keyValue))throw TypeError(".genvid.proto.Event.keyValue: array expected");t.keyValue=[];for(var r=0;r<e.keyValue.length;++r){if("object"!=typeof e.keyValue[r])throw TypeError(".genvid.proto.Event.keyValue: object expected");t.keyValue[r]=$root.genvid.proto.KeyValue.fromObject(e.keyValue[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.keyValue=[]),e.keyValue&&e.keyValue.length){r.keyValue=[];for(var n=0;n<e.keyValue.length;++n)r.keyValue[n]=$root.genvid.proto.KeyValue.toObject(e.keyValue[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.KeyValue=function(){function e(e){if(this.key=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key=$util.emptyArray,e.prototype.value="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.key&&e.key.length)for(var r=0;r<e.key.length;++r)t.uint32(10).string(e.key[r]);return null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(18).string(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.KeyValue;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.key&&n.key.length||(n.key=[]),n.key.push(e.string());break;case 2:n.value=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.key&&e.hasOwnProperty("key")){if(!Array.isArray(e.key))return"key: array expected";for(var t=0;t<e.key.length;++t)if(!$util.isString(e.key[t]))return"key: string[] expected"}return null!=e.value&&e.hasOwnProperty("value")&&!$util.isString(e.value)?"value: string expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.KeyValue)return e;var t=new $root.genvid.proto.KeyValue;if(e.key){if(!Array.isArray(e.key))throw TypeError(".genvid.proto.KeyValue.key: array expected");t.key=[];for(var r=0;r<e.key.length;++r)t.key[r]=String(e.key[r])}return null!=e.value&&(t.value=String(e.value)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.key=[]),t.defaults&&(r.value=""),e.key&&e.key.length){r.key=[];for(var n=0;n<e.key.length;++n)r.key[n]=e.key[n]}return null!=e.value&&e.hasOwnProperty("value")&&(r.value=e.value),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.ClientMetrics=function(){function e(e){if(this.clientMetrics=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.clientMetrics=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.clientMetrics&&e.clientMetrics.length)for(var r=0;r<e.clientMetrics.length;++r)$root.genvid.proto.ClientMetric.encode(e.clientMetrics[r],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.ClientMetrics;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.clientMetrics&&n.clientMetrics.length||(n.clientMetrics=[]),n.clientMetrics.push($root.genvid.proto.ClientMetric.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.clientMetrics&&e.hasOwnProperty("clientMetrics")){if(!Array.isArray(e.clientMetrics))return"clientMetrics: array expected";for(var t=0;t<e.clientMetrics.length;++t){var r=$root.genvid.proto.ClientMetric.verify(e.clientMetrics[t]);if(r)return"clientMetrics."+r}}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.ClientMetrics)return e;var t=new $root.genvid.proto.ClientMetrics;if(e.clientMetrics){if(!Array.isArray(e.clientMetrics))throw TypeError(".genvid.proto.ClientMetrics.clientMetrics: array expected");t.clientMetrics=[];for(var r=0;r<e.clientMetrics.length;++r){if("object"!=typeof e.clientMetrics[r])throw TypeError(".genvid.proto.ClientMetrics.clientMetrics: object expected");t.clientMetrics[r]=$root.genvid.proto.ClientMetric.fromObject(e.clientMetrics[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.clientMetrics=[]),e.clientMetrics&&e.clientMetrics.length){r.clientMetrics=[];for(var n=0;n<e.clientMetrics.length;++n)r.clientMetrics[n]=$root.genvid.proto.ClientMetric.toObject(e.clientMetrics[n],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.ClientMetric=function(){function e(e){if(this.tags=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.key="",e.prototype.value=0,e.prototype.tags=$util.emptyArray,e.prototype.operation="",e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.key&&Object.hasOwnProperty.call(e,"key")&&t.uint32(10).string(e.key),null!=e.value&&Object.hasOwnProperty.call(e,"value")&&t.uint32(17).double(e.value),null!=e.tags&&e.tags.length)for(var r=0;r<e.tags.length;++r)t.uint32(26).string(e.tags[r]);return null!=e.operation&&Object.hasOwnProperty.call(e,"operation")&&t.uint32(34).string(e.operation),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.ClientMetric;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.key=e.string();break;case 2:n.value=e.double();break;case 3:n.tags&&n.tags.length||(n.tags=[]),n.tags.push(e.string());break;case 4:n.operation=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.key&&e.hasOwnProperty("key")&&!$util.isString(e.key))return"key: string expected";if(null!=e.value&&e.hasOwnProperty("value")&&"number"!=typeof e.value)return"value: number expected";if(null!=e.tags&&e.hasOwnProperty("tags")){if(!Array.isArray(e.tags))return"tags: array expected";for(var t=0;t<e.tags.length;++t)if(!$util.isString(e.tags[t]))return"tags: string[] expected"}return null!=e.operation&&e.hasOwnProperty("operation")&&!$util.isString(e.operation)?"operation: string expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.ClientMetric)return e;var t=new $root.genvid.proto.ClientMetric;if(null!=e.key&&(t.key=String(e.key)),null!=e.value&&(t.value=Number(e.value)),e.tags){if(!Array.isArray(e.tags))throw TypeError(".genvid.proto.ClientMetric.tags: array expected");t.tags=[];for(var r=0;r<e.tags.length;++r)t.tags[r]=String(e.tags[r])}return null!=e.operation&&(t.operation=String(e.operation)),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.tags=[]),t.defaults&&(r.key="",r.value=0,r.operation=""),null!=e.key&&e.hasOwnProperty("key")&&(r.key=e.key),null!=e.value&&e.hasOwnProperty("value")&&(r.value=t.json&&!isFinite(e.value)?String(e.value):e.value),e.tags&&e.tags.length){r.tags=[];for(var n=0;n<e.tags.length;++n)r.tags[n]=e.tags[n]}return null!=e.operation&&e.hasOwnProperty("operation")&&(r.operation=e.operation),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.LeafMethod=(e={},(t=Object.create(e))[e[0]="REPLY"]=0,t[e[2]="EVENT"]=2,t[e[3]="DATA_FRAMES"]=3,t[e[4]="DATA_NOTIFICATIONS"]=4,t[e[5]="CLIENT_METRICS"]=5,t[e[6]="METRICS_CONFIG"]=6,t[e[7]="STREAM_FORMAT"]=7,t[e[8]="DEBUG_CONFIG"]=8,t),r.LeafEnvelope=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.method=0,e.prototype.params=$util.newBuffer([]),e.prototype.result=$util.newBuffer([]),e.prototype.error=null,e.prototype.id=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.method&&Object.hasOwnProperty.call(e,"method")&&t.uint32(8).int32(e.method),null!=e.params&&Object.hasOwnProperty.call(e,"params")&&t.uint32(18).bytes(e.params),null!=e.result&&Object.hasOwnProperty.call(e,"result")&&t.uint32(26).bytes(e.result),null!=e.error&&Object.hasOwnProperty.call(e,"error")&&$root.genvid.proto.LeafError.encode(e.error,t.uint32(34).fork()).ldelim(),null!=e.id&&Object.hasOwnProperty.call(e,"id")&&t.uint32(40).int32(e.id),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.LeafEnvelope;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.method=e.int32();break;case 2:n.params=e.bytes();break;case 3:n.result=e.bytes();break;case 4:n.error=$root.genvid.proto.LeafError.decode(e,e.uint32());break;case 5:n.id=e.int32();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.method&&e.hasOwnProperty("method"))switch(e.method){default:return"method: enum value expected";case 0:case 2:case 3:case 4:case 5:case 6:case 7:case 8:}if(null!=e.params&&e.hasOwnProperty("params")&&!(e.params&&"number"==typeof e.params.length||$util.isString(e.params)))return"params: buffer expected";if(null!=e.result&&e.hasOwnProperty("result")&&!(e.result&&"number"==typeof e.result.length||$util.isString(e.result)))return"result: buffer expected";if(null!=e.error&&e.hasOwnProperty("error")){var t=$root.genvid.proto.LeafError.verify(e.error);if(t)return"error."+t}return null!=e.id&&e.hasOwnProperty("id")&&!$util.isInteger(e.id)?"id: integer expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.LeafEnvelope)return e;var t=new $root.genvid.proto.LeafEnvelope;switch(e.method){case"REPLY":case 0:t.method=0;break;case"EVENT":case 2:t.method=2;break;case"DATA_FRAMES":case 3:t.method=3;break;case"DATA_NOTIFICATIONS":case 4:t.method=4;break;case"CLIENT_METRICS":case 5:t.method=5;break;case"METRICS_CONFIG":case 6:t.method=6;break;case"STREAM_FORMAT":case 7:t.method=7;break;case"DEBUG_CONFIG":case 8:t.method=8}if(null!=e.params&&("string"==typeof e.params?$util.base64.decode(e.params,t.params=$util.newBuffer($util.base64.length(e.params)),0):e.params.length&&(t.params=e.params)),null!=e.result&&("string"==typeof e.result?$util.base64.decode(e.result,t.result=$util.newBuffer($util.base64.length(e.result)),0):e.result.length&&(t.result=e.result)),null!=e.error){if("object"!=typeof e.error)throw TypeError(".genvid.proto.LeafEnvelope.error: object expected");t.error=$root.genvid.proto.LeafError.fromObject(e.error)}return null!=e.id&&(t.id=0|e.id),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.method=t.enums===String?"REPLY":0,t.bytes===String?r.params="":(r.params=[],t.bytes!==Array&&(r.params=$util.newBuffer(r.params))),t.bytes===String?r.result="":(r.result=[],t.bytes!==Array&&(r.result=$util.newBuffer(r.result))),r.error=null,r.id=0),null!=e.method&&e.hasOwnProperty("method")&&(r.method=t.enums===String?$root.genvid.proto.LeafMethod[e.method]:e.method),null!=e.params&&e.hasOwnProperty("params")&&(r.params=t.bytes===String?$util.base64.encode(e.params,0,e.params.length):t.bytes===Array?Array.prototype.slice.call(e.params):e.params),null!=e.result&&e.hasOwnProperty("result")&&(r.result=t.bytes===String?$util.base64.encode(e.result,0,e.result.length):t.bytes===Array?Array.prototype.slice.call(e.result):e.result),null!=e.error&&e.hasOwnProperty("error")&&(r.error=$root.genvid.proto.LeafError.toObject(e.error,t)),null!=e.id&&e.hasOwnProperty("id")&&(r.id=e.id),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.LeafError=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.code=0,e.prototype.message="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.code&&Object.hasOwnProperty.call(e,"code")&&t.uint32(8).int32(e.code),null!=e.message&&Object.hasOwnProperty.call(e,"message")&&t.uint32(18).string(e.message),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.LeafError;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.code=e.int32();break;case 2:n.message=e.string();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.code&&e.hasOwnProperty("code")&&!$util.isInteger(e.code)?"code: integer expected":null!=e.message&&e.hasOwnProperty("message")&&!$util.isString(e.message)?"message: string expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.LeafError)return e;var t=new $root.genvid.proto.LeafError;return null!=e.code&&(t.code=0|e.code),null!=e.message&&(t.message=String(e.message)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.code=0,r.message=""),null!=e.code&&e.hasOwnProperty("code")&&(r.code=e.code),null!=e.message&&e.hasOwnProperty("message")&&(r.message=e.message),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.MetricsConfig=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.periodSeconds=0,e.prototype.enabled=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.periodSeconds&&Object.hasOwnProperty.call(e,"periodSeconds")&&t.uint32(8).uint32(e.periodSeconds),null!=e.enabled&&Object.hasOwnProperty.call(e,"enabled")&&t.uint32(16).bool(e.enabled),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.MetricsConfig;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.periodSeconds=e.uint32();break;case 2:n.enabled=e.bool();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.periodSeconds&&e.hasOwnProperty("periodSeconds")&&!$util.isInteger(e.periodSeconds)?"periodSeconds: integer expected":null!=e.enabled&&e.hasOwnProperty("enabled")&&"boolean"!=typeof e.enabled?"enabled: boolean expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.MetricsConfig)return e;var t=new $root.genvid.proto.MetricsConfig;return null!=e.periodSeconds&&(t.periodSeconds=e.periodSeconds>>>0),null!=e.enabled&&(t.enabled=Boolean(e.enabled)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.periodSeconds=0,r.enabled=!1),null!=e.periodSeconds&&e.hasOwnProperty("periodSeconds")&&(r.periodSeconds=e.periodSeconds),null!=e.enabled&&e.hasOwnProperty("enabled")&&(r.enabled=e.enabled),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.FrameStatus=function(){function e(e){if(this.sources=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.frameNum=0,e.prototype.reason=0,e.prototype.pts=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.encodingTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.packetSize=0,e.prototype.timestamp=0,e.prototype.duration=0,e.prototype.sendingTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.composition=null,e.prototype.sources=$util.emptyArray,e.prototype.encodedTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.startIngestTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.frameNum&&Object.hasOwnProperty.call(e,"frameNum")&&t.uint32(8).int32(e.frameNum),null!=e.reason&&Object.hasOwnProperty.call(e,"reason")&&t.uint32(16).int32(e.reason),null!=e.pts&&Object.hasOwnProperty.call(e,"pts")&&t.uint32(24).int64(e.pts),null!=e.encodingTime&&Object.hasOwnProperty.call(e,"encodingTime")&&t.uint32(32).int64(e.encodingTime),null!=e.packetSize&&Object.hasOwnProperty.call(e,"packetSize")&&t.uint32(40).int32(e.packetSize),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(49).double(e.timestamp),null!=e.duration&&Object.hasOwnProperty.call(e,"duration")&&t.uint32(57).double(e.duration),null!=e.sendingTime&&Object.hasOwnProperty.call(e,"sendingTime")&&t.uint32(64).int64(e.sendingTime),null!=e.composition&&Object.hasOwnProperty.call(e,"composition")&&$root.genvid.proto.CompositionNode.encode(e.composition,t.uint32(74).fork()).ldelim(),null!=e.sources&&e.sources.length)for(var r=0;r<e.sources.length;++r)$root.genvid.proto.SyncSource.encode(e.sources[r],t.uint32(82).fork()).ldelim();return null!=e.encodedTime&&Object.hasOwnProperty.call(e,"encodedTime")&&t.uint32(88).int64(e.encodedTime),null!=e.startIngestTime&&Object.hasOwnProperty.call(e,"startIngestTime")&&t.uint32(96).int64(e.startIngestTime),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.FrameStatus;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.frameNum=e.int32();break;case 2:n.reason=e.int32();break;case 3:n.pts=e.int64();break;case 4:n.encodingTime=e.int64();break;case 5:n.packetSize=e.int32();break;case 6:n.timestamp=e.double();break;case 7:n.duration=e.double();break;case 8:n.sendingTime=e.int64();break;case 9:n.composition=$root.genvid.proto.CompositionNode.decode(e,e.uint32());break;case 10:n.sources&&n.sources.length||(n.sources=[]),n.sources.push($root.genvid.proto.SyncSource.decode(e,e.uint32()));break;case 11:n.encodedTime=e.int64();break;case 12:n.startIngestTime=e.int64();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.frameNum&&e.hasOwnProperty("frameNum")&&!$util.isInteger(e.frameNum))return"frameNum: integer expected";if(null!=e.reason&&e.hasOwnProperty("reason"))switch(e.reason){default:return"reason: enum value expected";case 0:case 1:case 2:}if(null!=e.pts&&e.hasOwnProperty("pts")&&!($util.isInteger(e.pts)||e.pts&&$util.isInteger(e.pts.low)&&$util.isInteger(e.pts.high)))return"pts: integer|Long expected";if(null!=e.encodingTime&&e.hasOwnProperty("encodingTime")&&!($util.isInteger(e.encodingTime)||e.encodingTime&&$util.isInteger(e.encodingTime.low)&&$util.isInteger(e.encodingTime.high)))return"encodingTime: integer|Long expected";if(null!=e.packetSize&&e.hasOwnProperty("packetSize")&&!$util.isInteger(e.packetSize))return"packetSize: integer expected";if(null!=e.timestamp&&e.hasOwnProperty("timestamp")&&"number"!=typeof e.timestamp)return"timestamp: number expected";if(null!=e.duration&&e.hasOwnProperty("duration")&&"number"!=typeof e.duration)return"duration: number expected";if(null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&!($util.isInteger(e.sendingTime)||e.sendingTime&&$util.isInteger(e.sendingTime.low)&&$util.isInteger(e.sendingTime.high)))return"sendingTime: integer|Long expected";if(null!=e.composition&&e.hasOwnProperty("composition")&&(r=$root.genvid.proto.CompositionNode.verify(e.composition)))return"composition."+r;if(null!=e.sources&&e.hasOwnProperty("sources")){if(!Array.isArray(e.sources))return"sources: array expected";for(var t=0;t<e.sources.length;++t){var r;if(r=$root.genvid.proto.SyncSource.verify(e.sources[t]))return"sources."+r}}return null!=e.encodedTime&&e.hasOwnProperty("encodedTime")&&!($util.isInteger(e.encodedTime)||e.encodedTime&&$util.isInteger(e.encodedTime.low)&&$util.isInteger(e.encodedTime.high))?"encodedTime: integer|Long expected":null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&!($util.isInteger(e.startIngestTime)||e.startIngestTime&&$util.isInteger(e.startIngestTime.low)&&$util.isInteger(e.startIngestTime.high))?"startIngestTime: integer|Long expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.FrameStatus)return e;var t=new $root.genvid.proto.FrameStatus;switch(null!=e.frameNum&&(t.frameNum=0|e.frameNum),e.reason){case"VIDEOFRAMEENCODED":case 0:t.reason=0;break;case"IDLE":case 1:t.reason=1;break;case"UNDEFINEDEREASON":case 2:t.reason=2}if(null!=e.pts&&($util.Long?(t.pts=$util.Long.fromValue(e.pts)).unsigned=!1:"string"==typeof e.pts?t.pts=parseInt(e.pts,10):"number"==typeof e.pts?t.pts=e.pts:"object"==typeof e.pts&&(t.pts=new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber())),null!=e.encodingTime&&($util.Long?(t.encodingTime=$util.Long.fromValue(e.encodingTime)).unsigned=!1:"string"==typeof e.encodingTime?t.encodingTime=parseInt(e.encodingTime,10):"number"==typeof e.encodingTime?t.encodingTime=e.encodingTime:"object"==typeof e.encodingTime&&(t.encodingTime=new $util.LongBits(e.encodingTime.low>>>0,e.encodingTime.high>>>0).toNumber())),null!=e.packetSize&&(t.packetSize=0|e.packetSize),null!=e.timestamp&&(t.timestamp=Number(e.timestamp)),null!=e.duration&&(t.duration=Number(e.duration)),null!=e.sendingTime&&($util.Long?(t.sendingTime=$util.Long.fromValue(e.sendingTime)).unsigned=!1:"string"==typeof e.sendingTime?t.sendingTime=parseInt(e.sendingTime,10):"number"==typeof e.sendingTime?t.sendingTime=e.sendingTime:"object"==typeof e.sendingTime&&(t.sendingTime=new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber())),null!=e.composition){if("object"!=typeof e.composition)throw TypeError(".genvid.proto.FrameStatus.composition: object expected");t.composition=$root.genvid.proto.CompositionNode.fromObject(e.composition)}if(e.sources){if(!Array.isArray(e.sources))throw TypeError(".genvid.proto.FrameStatus.sources: array expected");t.sources=[];for(var r=0;r<e.sources.length;++r){if("object"!=typeof e.sources[r])throw TypeError(".genvid.proto.FrameStatus.sources: object expected");t.sources[r]=$root.genvid.proto.SyncSource.fromObject(e.sources[r])}}return null!=e.encodedTime&&($util.Long?(t.encodedTime=$util.Long.fromValue(e.encodedTime)).unsigned=!1:"string"==typeof e.encodedTime?t.encodedTime=parseInt(e.encodedTime,10):"number"==typeof e.encodedTime?t.encodedTime=e.encodedTime:"object"==typeof e.encodedTime&&(t.encodedTime=new $util.LongBits(e.encodedTime.low>>>0,e.encodedTime.high>>>0).toNumber())),null!=e.startIngestTime&&($util.Long?(t.startIngestTime=$util.Long.fromValue(e.startIngestTime)).unsigned=!1:"string"==typeof e.startIngestTime?t.startIngestTime=parseInt(e.startIngestTime,10):"number"==typeof e.startIngestTime?t.startIngestTime=e.startIngestTime:"object"==typeof e.startIngestTime&&(t.startIngestTime=new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.sources=[]),t.defaults){if(r.frameNum=0,r.reason=t.enums===String?"VIDEOFRAMEENCODED":0,$util.Long){var n=new $util.Long(0,0,!1);r.pts=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.pts=t.longs===String?"0":0;$util.Long?(n=new $util.Long(0,0,!1),r.encodingTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.encodingTime=t.longs===String?"0":0,r.packetSize=0,r.timestamp=0,r.duration=0,$util.Long?(n=new $util.Long(0,0,!1),r.sendingTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.sendingTime=t.longs===String?"0":0,r.composition=null,$util.Long?(n=new $util.Long(0,0,!1),r.encodedTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.encodedTime=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.startIngestTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.startIngestTime=t.longs===String?"0":0}if(null!=e.frameNum&&e.hasOwnProperty("frameNum")&&(r.frameNum=e.frameNum),null!=e.reason&&e.hasOwnProperty("reason")&&(r.reason=t.enums===String?$root.genvid.proto.Reason[e.reason]:e.reason),null!=e.pts&&e.hasOwnProperty("pts")&&("number"==typeof e.pts?r.pts=t.longs===String?String(e.pts):e.pts:r.pts=t.longs===String?$util.Long.prototype.toString.call(e.pts):t.longs===Number?new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber():e.pts),null!=e.encodingTime&&e.hasOwnProperty("encodingTime")&&("number"==typeof e.encodingTime?r.encodingTime=t.longs===String?String(e.encodingTime):e.encodingTime:r.encodingTime=t.longs===String?$util.Long.prototype.toString.call(e.encodingTime):t.longs===Number?new $util.LongBits(e.encodingTime.low>>>0,e.encodingTime.high>>>0).toNumber():e.encodingTime),null!=e.packetSize&&e.hasOwnProperty("packetSize")&&(r.packetSize=e.packetSize),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&(r.timestamp=t.json&&!isFinite(e.timestamp)?String(e.timestamp):e.timestamp),null!=e.duration&&e.hasOwnProperty("duration")&&(r.duration=t.json&&!isFinite(e.duration)?String(e.duration):e.duration),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&("number"==typeof e.sendingTime?r.sendingTime=t.longs===String?String(e.sendingTime):e.sendingTime:r.sendingTime=t.longs===String?$util.Long.prototype.toString.call(e.sendingTime):t.longs===Number?new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber():e.sendingTime),null!=e.composition&&e.hasOwnProperty("composition")&&(r.composition=$root.genvid.proto.CompositionNode.toObject(e.composition,t)),e.sources&&e.sources.length){r.sources=[];for(var i=0;i<e.sources.length;++i)r.sources[i]=$root.genvid.proto.SyncSource.toObject(e.sources[i],t)}return null!=e.encodedTime&&e.hasOwnProperty("encodedTime")&&("number"==typeof e.encodedTime?r.encodedTime=t.longs===String?String(e.encodedTime):e.encodedTime:r.encodedTime=t.longs===String?$util.Long.prototype.toString.call(e.encodedTime):t.longs===Number?new $util.LongBits(e.encodedTime.low>>>0,e.encodedTime.high>>>0).toNumber():e.encodedTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&("number"==typeof e.startIngestTime?r.startIngestTime=t.longs===String?String(e.startIngestTime):e.startIngestTime:r.startIngestTime=t.longs===String?$util.Long.prototype.toString.call(e.startIngestTime):t.longs===Number?new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber():e.startIngestTime),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.CompositionFrame=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.pts=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sendingTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.startIngestTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.composition=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.pts&&Object.hasOwnProperty.call(e,"pts")&&t.uint32(8).int64(e.pts),null!=e.sendingTime&&Object.hasOwnProperty.call(e,"sendingTime")&&t.uint32(16).int64(e.sendingTime),null!=e.startIngestTime&&Object.hasOwnProperty.call(e,"startIngestTime")&&t.uint32(24).int64(e.startIngestTime),null!=e.composition&&Object.hasOwnProperty.call(e,"composition")&&$root.genvid.proto.CompositionNode.encode(e.composition,t.uint32(34).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.CompositionFrame;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.pts=e.int64();break;case 2:n.sendingTime=e.int64();break;case 3:n.startIngestTime=e.int64();break;case 4:n.composition=$root.genvid.proto.CompositionNode.decode(e,e.uint32());break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.pts&&e.hasOwnProperty("pts")&&!($util.isInteger(e.pts)||e.pts&&$util.isInteger(e.pts.low)&&$util.isInteger(e.pts.high)))return"pts: integer|Long expected";if(null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&!($util.isInteger(e.sendingTime)||e.sendingTime&&$util.isInteger(e.sendingTime.low)&&$util.isInteger(e.sendingTime.high)))return"sendingTime: integer|Long expected";if(null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&!($util.isInteger(e.startIngestTime)||e.startIngestTime&&$util.isInteger(e.startIngestTime.low)&&$util.isInteger(e.startIngestTime.high)))return"startIngestTime: integer|Long expected";if(null!=e.composition&&e.hasOwnProperty("composition")){var t=$root.genvid.proto.CompositionNode.verify(e.composition);if(t)return"composition."+t}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.CompositionFrame)return e;var t=new $root.genvid.proto.CompositionFrame;if(null!=e.pts&&($util.Long?(t.pts=$util.Long.fromValue(e.pts)).unsigned=!1:"string"==typeof e.pts?t.pts=parseInt(e.pts,10):"number"==typeof e.pts?t.pts=e.pts:"object"==typeof e.pts&&(t.pts=new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber())),null!=e.sendingTime&&($util.Long?(t.sendingTime=$util.Long.fromValue(e.sendingTime)).unsigned=!1:"string"==typeof e.sendingTime?t.sendingTime=parseInt(e.sendingTime,10):"number"==typeof e.sendingTime?t.sendingTime=e.sendingTime:"object"==typeof e.sendingTime&&(t.sendingTime=new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber())),null!=e.startIngestTime&&($util.Long?(t.startIngestTime=$util.Long.fromValue(e.startIngestTime)).unsigned=!1:"string"==typeof e.startIngestTime?t.startIngestTime=parseInt(e.startIngestTime,10):"number"==typeof e.startIngestTime?t.startIngestTime=e.startIngestTime:"object"==typeof e.startIngestTime&&(t.startIngestTime=new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber())),null!=e.composition){if("object"!=typeof e.composition)throw TypeError(".genvid.proto.CompositionFrame.composition: object expected");t.composition=$root.genvid.proto.CompositionNode.fromObject(e.composition)}return t},e.toObject=function(e,t){t||(t={});var r={};if(t.defaults){if($util.Long){var n=new $util.Long(0,0,!1);r.pts=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.pts=t.longs===String?"0":0;$util.Long?(n=new $util.Long(0,0,!1),r.sendingTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.sendingTime=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.startIngestTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.startIngestTime=t.longs===String?"0":0,r.composition=null}return null!=e.pts&&e.hasOwnProperty("pts")&&("number"==typeof e.pts?r.pts=t.longs===String?String(e.pts):e.pts:r.pts=t.longs===String?$util.Long.prototype.toString.call(e.pts):t.longs===Number?new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber():e.pts),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&("number"==typeof e.sendingTime?r.sendingTime=t.longs===String?String(e.sendingTime):e.sendingTime:r.sendingTime=t.longs===String?$util.Long.prototype.toString.call(e.sendingTime):t.longs===Number?new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber():e.sendingTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&("number"==typeof e.startIngestTime?r.startIngestTime=t.longs===String?String(e.startIngestTime):e.startIngestTime:r.startIngestTime=t.longs===String?$util.Long.prototype.toString.call(e.startIngestTime):t.longs===Number?new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber():e.startIngestTime),null!=e.composition&&e.hasOwnProperty("composition")&&(r.composition=$root.genvid.proto.CompositionNode.toObject(e.composition,t)),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.SyncSource=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.sessionId=0,e.prototype.streamId=0,e.prototype.timestamp=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(8).uint32(e.sessionId),null!=e.streamId&&Object.hasOwnProperty.call(e,"streamId")&&t.uint32(16).uint32(e.streamId),null!=e.timestamp&&Object.hasOwnProperty.call(e,"timestamp")&&t.uint32(25).double(e.timestamp),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.SyncSource;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.sessionId=e.uint32();break;case 2:n.streamId=e.uint32();break;case 3:n.timestamp=e.double();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!$util.isInteger(e.sessionId)?"sessionId: integer expected":null!=e.streamId&&e.hasOwnProperty("streamId")&&!$util.isInteger(e.streamId)?"streamId: integer expected":null!=e.timestamp&&e.hasOwnProperty("timestamp")&&"number"!=typeof e.timestamp?"timestamp: number expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.SyncSource)return e;var t=new $root.genvid.proto.SyncSource;return null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.timestamp&&(t.timestamp=Number(e.timestamp)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.sessionId=0,r.streamId=0,r.timestamp=0),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(r.sessionId=e.sessionId),null!=e.streamId&&e.hasOwnProperty("streamId")&&(r.streamId=e.streamId),null!=e.timestamp&&e.hasOwnProperty("timestamp")&&(r.timestamp=t.json&&!isFinite(e.timestamp)?String(e.timestamp):e.timestamp),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.SyncFrame=function(){function e(e){if(this.sources=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.pts=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.sendingTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.startIngestTime=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.syncTime=0,e.prototype.sources=$util.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.pts&&Object.hasOwnProperty.call(e,"pts")&&t.uint32(8).int64(e.pts),null!=e.sendingTime&&Object.hasOwnProperty.call(e,"sendingTime")&&t.uint32(16).int64(e.sendingTime),null!=e.startIngestTime&&Object.hasOwnProperty.call(e,"startIngestTime")&&t.uint32(24).int64(e.startIngestTime),null!=e.syncTime&&Object.hasOwnProperty.call(e,"syncTime")&&t.uint32(32).int32(e.syncTime),null!=e.sources&&e.sources.length)for(var r=0;r<e.sources.length;++r)$root.genvid.proto.SyncSource.encode(e.sources[r],t.uint32(42).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.SyncFrame;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.pts=e.int64();break;case 2:n.sendingTime=e.int64();break;case 3:n.startIngestTime=e.int64();break;case 4:n.syncTime=e.int32();break;case 5:n.sources&&n.sources.length||(n.sources=[]),n.sources.push($root.genvid.proto.SyncSource.decode(e,e.uint32()));break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.pts&&e.hasOwnProperty("pts")&&!($util.isInteger(e.pts)||e.pts&&$util.isInteger(e.pts.low)&&$util.isInteger(e.pts.high)))return"pts: integer|Long expected";if(null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&!($util.isInteger(e.sendingTime)||e.sendingTime&&$util.isInteger(e.sendingTime.low)&&$util.isInteger(e.sendingTime.high)))return"sendingTime: integer|Long expected";if(null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&!($util.isInteger(e.startIngestTime)||e.startIngestTime&&$util.isInteger(e.startIngestTime.low)&&$util.isInteger(e.startIngestTime.high)))return"startIngestTime: integer|Long expected";if(null!=e.syncTime&&e.hasOwnProperty("syncTime")&&!$util.isInteger(e.syncTime))return"syncTime: integer expected";if(null!=e.sources&&e.hasOwnProperty("sources")){if(!Array.isArray(e.sources))return"sources: array expected";for(var t=0;t<e.sources.length;++t){var r=$root.genvid.proto.SyncSource.verify(e.sources[t]);if(r)return"sources."+r}}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.SyncFrame)return e;var t=new $root.genvid.proto.SyncFrame;if(null!=e.pts&&($util.Long?(t.pts=$util.Long.fromValue(e.pts)).unsigned=!1:"string"==typeof e.pts?t.pts=parseInt(e.pts,10):"number"==typeof e.pts?t.pts=e.pts:"object"==typeof e.pts&&(t.pts=new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber())),null!=e.sendingTime&&($util.Long?(t.sendingTime=$util.Long.fromValue(e.sendingTime)).unsigned=!1:"string"==typeof e.sendingTime?t.sendingTime=parseInt(e.sendingTime,10):"number"==typeof e.sendingTime?t.sendingTime=e.sendingTime:"object"==typeof e.sendingTime&&(t.sendingTime=new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber())),null!=e.startIngestTime&&($util.Long?(t.startIngestTime=$util.Long.fromValue(e.startIngestTime)).unsigned=!1:"string"==typeof e.startIngestTime?t.startIngestTime=parseInt(e.startIngestTime,10):"number"==typeof e.startIngestTime?t.startIngestTime=e.startIngestTime:"object"==typeof e.startIngestTime&&(t.startIngestTime=new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber())),null!=e.syncTime&&(t.syncTime=0|e.syncTime),e.sources){if(!Array.isArray(e.sources))throw TypeError(".genvid.proto.SyncFrame.sources: array expected");t.sources=[];for(var r=0;r<e.sources.length;++r){if("object"!=typeof e.sources[r])throw TypeError(".genvid.proto.SyncFrame.sources: object expected");t.sources[r]=$root.genvid.proto.SyncSource.fromObject(e.sources[r])}}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.sources=[]),t.defaults){if($util.Long){var n=new $util.Long(0,0,!1);r.pts=t.longs===String?n.toString():t.longs===Number?n.toNumber():n}else r.pts=t.longs===String?"0":0;$util.Long?(n=new $util.Long(0,0,!1),r.sendingTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.sendingTime=t.longs===String?"0":0,$util.Long?(n=new $util.Long(0,0,!1),r.startIngestTime=t.longs===String?n.toString():t.longs===Number?n.toNumber():n):r.startIngestTime=t.longs===String?"0":0,r.syncTime=0}if(null!=e.pts&&e.hasOwnProperty("pts")&&("number"==typeof e.pts?r.pts=t.longs===String?String(e.pts):e.pts:r.pts=t.longs===String?$util.Long.prototype.toString.call(e.pts):t.longs===Number?new $util.LongBits(e.pts.low>>>0,e.pts.high>>>0).toNumber():e.pts),null!=e.sendingTime&&e.hasOwnProperty("sendingTime")&&("number"==typeof e.sendingTime?r.sendingTime=t.longs===String?String(e.sendingTime):e.sendingTime:r.sendingTime=t.longs===String?$util.Long.prototype.toString.call(e.sendingTime):t.longs===Number?new $util.LongBits(e.sendingTime.low>>>0,e.sendingTime.high>>>0).toNumber():e.sendingTime),null!=e.startIngestTime&&e.hasOwnProperty("startIngestTime")&&("number"==typeof e.startIngestTime?r.startIngestTime=t.longs===String?String(e.startIngestTime):e.startIngestTime:r.startIngestTime=t.longs===String?$util.Long.prototype.toString.call(e.startIngestTime):t.longs===Number?new $util.LongBits(e.startIngestTime.low>>>0,e.startIngestTime.high>>>0).toNumber():e.startIngestTime),null!=e.syncTime&&e.hasOwnProperty("syncTime")&&(r.syncTime=e.syncTime),e.sources&&e.sources.length){r.sources=[];for(var i=0;i<e.sources.length;++i)r.sources[i]=$root.genvid.proto.SyncSource.toObject(e.sources[i],t)}return r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.Mat3=function(){function e(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.c0r0=0,e.prototype.c0r1=0,e.prototype.c0r2=0,e.prototype.c1r0=0,e.prototype.c1r1=0,e.prototype.c1r2=0,e.prototype.c2r0=0,e.prototype.c2r1=0,e.prototype.c2r2=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=$Writer.create()),null!=e.c0r0&&Object.hasOwnProperty.call(e,"c0r0")&&t.uint32(13).float(e.c0r0),null!=e.c0r1&&Object.hasOwnProperty.call(e,"c0r1")&&t.uint32(21).float(e.c0r1),null!=e.c0r2&&Object.hasOwnProperty.call(e,"c0r2")&&t.uint32(29).float(e.c0r2),null!=e.c1r0&&Object.hasOwnProperty.call(e,"c1r0")&&t.uint32(37).float(e.c1r0),null!=e.c1r1&&Object.hasOwnProperty.call(e,"c1r1")&&t.uint32(45).float(e.c1r1),null!=e.c1r2&&Object.hasOwnProperty.call(e,"c1r2")&&t.uint32(53).float(e.c1r2),null!=e.c2r0&&Object.hasOwnProperty.call(e,"c2r0")&&t.uint32(61).float(e.c2r0),null!=e.c2r1&&Object.hasOwnProperty.call(e,"c2r1")&&t.uint32(69).float(e.c2r1),null!=e.c2r2&&Object.hasOwnProperty.call(e,"c2r2")&&t.uint32(77).float(e.c2r2),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.Mat3;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.c0r0=e.float();break;case 2:n.c0r1=e.float();break;case 3:n.c0r2=e.float();break;case 4:n.c1r0=e.float();break;case 5:n.c1r1=e.float();break;case 6:n.c1r2=e.float();break;case 7:n.c2r0=e.float();break;case 8:n.c2r1=e.float();break;case 9:n.c2r2=e.float();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.c0r0&&e.hasOwnProperty("c0r0")&&"number"!=typeof e.c0r0?"c0r0: number expected":null!=e.c0r1&&e.hasOwnProperty("c0r1")&&"number"!=typeof e.c0r1?"c0r1: number expected":null!=e.c0r2&&e.hasOwnProperty("c0r2")&&"number"!=typeof e.c0r2?"c0r2: number expected":null!=e.c1r0&&e.hasOwnProperty("c1r0")&&"number"!=typeof e.c1r0?"c1r0: number expected":null!=e.c1r1&&e.hasOwnProperty("c1r1")&&"number"!=typeof e.c1r1?"c1r1: number expected":null!=e.c1r2&&e.hasOwnProperty("c1r2")&&"number"!=typeof e.c1r2?"c1r2: number expected":null!=e.c2r0&&e.hasOwnProperty("c2r0")&&"number"!=typeof e.c2r0?"c2r0: number expected":null!=e.c2r1&&e.hasOwnProperty("c2r1")&&"number"!=typeof e.c2r1?"c2r1: number expected":null!=e.c2r2&&e.hasOwnProperty("c2r2")&&"number"!=typeof e.c2r2?"c2r2: number expected":null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.Mat3)return e;var t=new $root.genvid.proto.Mat3;return null!=e.c0r0&&(t.c0r0=Number(e.c0r0)),null!=e.c0r1&&(t.c0r1=Number(e.c0r1)),null!=e.c0r2&&(t.c0r2=Number(e.c0r2)),null!=e.c1r0&&(t.c1r0=Number(e.c1r0)),null!=e.c1r1&&(t.c1r1=Number(e.c1r1)),null!=e.c1r2&&(t.c1r2=Number(e.c1r2)),null!=e.c2r0&&(t.c2r0=Number(e.c2r0)),null!=e.c2r1&&(t.c2r1=Number(e.c2r1)),null!=e.c2r2&&(t.c2r2=Number(e.c2r2)),t},e.toObject=function(e,t){t||(t={});var r={};return t.defaults&&(r.c0r0=0,r.c0r1=0,r.c0r2=0,r.c1r0=0,r.c1r1=0,r.c1r2=0,r.c2r0=0,r.c2r1=0,r.c2r2=0),null!=e.c0r0&&e.hasOwnProperty("c0r0")&&(r.c0r0=t.json&&!isFinite(e.c0r0)?String(e.c0r0):e.c0r0),null!=e.c0r1&&e.hasOwnProperty("c0r1")&&(r.c0r1=t.json&&!isFinite(e.c0r1)?String(e.c0r1):e.c0r1),null!=e.c0r2&&e.hasOwnProperty("c0r2")&&(r.c0r2=t.json&&!isFinite(e.c0r2)?String(e.c0r2):e.c0r2),null!=e.c1r0&&e.hasOwnProperty("c1r0")&&(r.c1r0=t.json&&!isFinite(e.c1r0)?String(e.c1r0):e.c1r0),null!=e.c1r1&&e.hasOwnProperty("c1r1")&&(r.c1r1=t.json&&!isFinite(e.c1r1)?String(e.c1r1):e.c1r1),null!=e.c1r2&&e.hasOwnProperty("c1r2")&&(r.c1r2=t.json&&!isFinite(e.c1r2)?String(e.c1r2):e.c1r2),null!=e.c2r0&&e.hasOwnProperty("c2r0")&&(r.c2r0=t.json&&!isFinite(e.c2r0)?String(e.c2r0):e.c2r0),null!=e.c2r1&&e.hasOwnProperty("c2r1")&&(r.c2r1=t.json&&!isFinite(e.c2r1)?String(e.c2r1):e.c2r1),null!=e.c2r2&&e.hasOwnProperty("c2r2")&&(r.c2r2=t.json&&!isFinite(e.c2r2)?String(e.c2r2):e.c2r2),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.CompositionNode=function(){function e(e){if(this.children=[],e)for(var t=Object.keys(e),r=0;r<t.length;++r)null!=e[t[r]]&&(this[t[r]]=e[t[r]])}return e.prototype.type=0,e.prototype.sessionId=0,e.prototype.streamId=0,e.prototype.children=$util.emptyArray,e.prototype.source=null,e.prototype.affineMatrix=null,e.prototype.opacity=0,e.prototype.sourceId=0,e.prototype.videoSourceCompositionType=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=$Writer.create()),null!=e.type&&Object.hasOwnProperty.call(e,"type")&&t.uint32(8).int32(e.type),null!=e.sessionId&&Object.hasOwnProperty.call(e,"sessionId")&&t.uint32(16).uint32(e.sessionId),null!=e.streamId&&Object.hasOwnProperty.call(e,"streamId")&&t.uint32(24).uint32(e.streamId),null!=e.children&&e.children.length)for(var r=0;r<e.children.length;++r)$root.genvid.proto.CompositionNode.encode(e.children[r],t.uint32(42).fork()).ldelim();return null!=e.source&&Object.hasOwnProperty.call(e,"source")&&$root.genvid.proto.CompositionNode.encode(e.source,t.uint32(50).fork()).ldelim(),null!=e.affineMatrix&&Object.hasOwnProperty.call(e,"affineMatrix")&&$root.genvid.proto.Mat3.encode(e.affineMatrix,t.uint32(58).fork()).ldelim(),null!=e.opacity&&Object.hasOwnProperty.call(e,"opacity")&&t.uint32(69).float(e.opacity),null!=e.sourceId&&Object.hasOwnProperty.call(e,"sourceId")&&t.uint32(72).uint32(e.sourceId),null!=e.videoSourceCompositionType&&Object.hasOwnProperty.call(e,"videoSourceCompositionType")&&t.uint32(80).int32(e.videoSourceCompositionType),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof $Reader||(e=$Reader.create(e));for(var r=void 0===t?e.len:e.pos+t,n=new $root.genvid.proto.CompositionNode;e.pos<r;){var i=e.uint32();switch(i>>>3){case 1:n.type=e.int32();break;case 2:n.sessionId=e.uint32();break;case 3:n.streamId=e.uint32();break;case 5:n.children&&n.children.length||(n.children=[]),n.children.push($root.genvid.proto.CompositionNode.decode(e,e.uint32()));break;case 6:n.source=$root.genvid.proto.CompositionNode.decode(e,e.uint32());break;case 7:n.affineMatrix=$root.genvid.proto.Mat3.decode(e,e.uint32());break;case 8:n.opacity=e.float();break;case 9:n.sourceId=e.uint32();break;case 10:n.videoSourceCompositionType=e.int32();break;default:e.skipType(7&i)}}return n},e.decodeDelimited=function(e){return e instanceof $Reader||(e=new $Reader(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:}if(null!=e.sessionId&&e.hasOwnProperty("sessionId")&&!$util.isInteger(e.sessionId))return"sessionId: integer expected";if(null!=e.streamId&&e.hasOwnProperty("streamId")&&!$util.isInteger(e.streamId))return"streamId: integer expected";if(null!=e.children&&e.hasOwnProperty("children")){if(!Array.isArray(e.children))return"children: array expected";for(var t=0;t<e.children.length;++t)if(r=$root.genvid.proto.CompositionNode.verify(e.children[t]))return"children."+r}var r;if(null!=e.source&&e.hasOwnProperty("source")&&(r=$root.genvid.proto.CompositionNode.verify(e.source)))return"source."+r;if(null!=e.affineMatrix&&e.hasOwnProperty("affineMatrix")&&(r=$root.genvid.proto.Mat3.verify(e.affineMatrix)))return"affineMatrix."+r;if(null!=e.opacity&&e.hasOwnProperty("opacity")&&"number"!=typeof e.opacity)return"opacity: number expected";if(null!=e.sourceId&&e.hasOwnProperty("sourceId")&&!$util.isInteger(e.sourceId))return"sourceId: integer expected";if(null!=e.videoSourceCompositionType&&e.hasOwnProperty("videoSourceCompositionType"))switch(e.videoSourceCompositionType){default:return"videoSourceCompositionType: enum value expected";case 0:case 1:case 2:case 3:}return null},e.fromObject=function(e){if(e instanceof $root.genvid.proto.CompositionNode)return e;var t=new $root.genvid.proto.CompositionNode;switch(e.type){case"DEFAULT":case 0:t.type=0;break;case"RTMSP":case 1:t.type=1;break;case"COMPOSITE":case 2:t.type=2;break;case"AFFINE":case 3:t.type=3;break;case"STILLIMAGE":case 4:t.type=4}if(null!=e.sessionId&&(t.sessionId=e.sessionId>>>0),null!=e.streamId&&(t.streamId=e.streamId>>>0),e.children){if(!Array.isArray(e.children))throw TypeError(".genvid.proto.CompositionNode.children: array expected");t.children=[];for(var r=0;r<e.children.length;++r){if("object"!=typeof e.children[r])throw TypeError(".genvid.proto.CompositionNode.children: object expected");t.children[r]=$root.genvid.proto.CompositionNode.fromObject(e.children[r])}}if(null!=e.source){if("object"!=typeof e.source)throw TypeError(".genvid.proto.CompositionNode.source: object expected");t.source=$root.genvid.proto.CompositionNode.fromObject(e.source)}if(null!=e.affineMatrix){if("object"!=typeof e.affineMatrix)throw TypeError(".genvid.proto.CompositionNode.affineMatrix: object expected");t.affineMatrix=$root.genvid.proto.Mat3.fromObject(e.affineMatrix)}switch(null!=e.opacity&&(t.opacity=Number(e.opacity)),null!=e.sourceId&&(t.sourceId=e.sourceId>>>0),e.videoSourceCompositionType){case"UNDEFINEDLAYOUT":case 0:t.videoSourceCompositionType=0;break;case"PIPVIDEOLAYOUT":case 1:t.videoSourceCompositionType=1;break;case"CHROMAKEYVIDEOLAYOUT":case 2:t.videoSourceCompositionType=2;break;case"NOTSET":case 3:t.videoSourceCompositionType=3}return t},e.toObject=function(e,t){t||(t={});var r={};if((t.arrays||t.defaults)&&(r.children=[]),t.defaults&&(r.type=t.enums===String?"DEFAULT":0,r.sessionId=0,r.streamId=0,r.source=null,r.affineMatrix=null,r.opacity=0,r.sourceId=0,r.videoSourceCompositionType=t.enums===String?"UNDEFINEDLAYOUT":0),null!=e.type&&e.hasOwnProperty("type")&&(r.type=t.enums===String?$root.genvid.proto.NodeType[e.type]:e.type),null!=e.sessionId&&e.hasOwnProperty("sessionId")&&(r.sessionId=e.sessionId),null!=e.streamId&&e.hasOwnProperty("streamId")&&(r.streamId=e.streamId),e.children&&e.children.length){r.children=[];for(var n=0;n<e.children.length;++n)r.children[n]=$root.genvid.proto.CompositionNode.toObject(e.children[n],t)}return null!=e.source&&e.hasOwnProperty("source")&&(r.source=$root.genvid.proto.CompositionNode.toObject(e.source,t)),null!=e.affineMatrix&&e.hasOwnProperty("affineMatrix")&&(r.affineMatrix=$root.genvid.proto.Mat3.toObject(e.affineMatrix,t)),null!=e.opacity&&e.hasOwnProperty("opacity")&&(r.opacity=t.json&&!isFinite(e.opacity)?String(e.opacity):e.opacity),null!=e.sourceId&&e.hasOwnProperty("sourceId")&&(r.sourceId=e.sourceId),null!=e.videoSourceCompositionType&&e.hasOwnProperty("videoSourceCompositionType")&&(r.videoSourceCompositionType=t.enums===String?$root.genvid.proto.CompositionType[e.videoSourceCompositionType]:e.videoSourceCompositionType),r},e.prototype.toJSON=function(){return this.constructor.toObject(this,minimal$1.util.toJSONOptions)},e}(),r.NodeType=function(){var e={},t=Object.create(e);return t[e[0]="DEFAULT"]=0,t[e[1]="RTMSP"]=1,t[e[2]="COMPOSITE"]=2,t[e[3]="AFFINE"]=3,t[e[4]="STILLIMAGE"]=4,t}(),r.Reason=function(){var e={},t=Object.create(e);return t[e[0]="VIDEOFRAMEENCODED"]=0,t[e[1]="IDLE"]=1,t[e[2]="UNDEFINEDEREASON"]=2,t}(),r.CompositionType=function(){var e={},t=Object.create(e);return t[e[0]="UNDEFINEDLAYOUT"]=0,t[e[1]="PIPVIDEOLAYOUT"]=1,t[e[2]="CHROMAKEYVIDEOLAYOUT"]=2,t[e[3]="NOTSET"]=3,t}(),r),n}();var genvidproto=$root;const version="1.36.2";var EnumCompositionType=["Undefined","PipVideoLayout","ChromaKeyVideoLayout","NotSet"],EnumNodeType=["DEFAULT","RTMSP","COMPOSITE","AFFINE","STILLIMAGE"];function protoToMatrix(e){return e?[e.c0r0||0,e.c0r1||0,e.c0r2||0,e.c1r0||0,e.c1r1||0,e.c1r2||0,e.c2r0||0,e.c2r1||0,e.c2r2||0]:[0,0,0,0,0,0,0,0,0]}function protoToCompositiondata(e){var t,r;switch(e.type){case genvidproto.genvid.proto.NodeType.AFFINE:return e.source?protoToCompositiondata(e.source).map(function(t){return t.affineMatrix=mat3ToArray(prodmat3(mat3FromArray(protoToMatrix(e.affineMatrix)),mat3FromArray(t.affineMatrix))),t.opacity=t.opacity*(e.opacity||0),t}):[];case genvidproto.genvid.proto.NodeType.COMPOSITE:var n=[];try{for(var i=__values(e.children||[]),o=i.next();!o.done;o=i.next()){var s=o.value;n.push.apply(n,__spread(protoToCompositiondata(s).map(function(t){return t.type=EnumCompositionType[e.videoSourceCompositionType||0],t})))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n;case genvidproto.genvid.proto.NodeType.RTMSP:return[{affineMatrix:[1,0,0,0,1,0,0,0,1],opacity:1,sessionId:""+(e.sessionId||0),streamId:""+(e.streamId||0),type:EnumCompositionType[e.videoSourceCompositionType||0]}];default:return error("Composition data translation not implemented for node of type",EnumNodeType[e.type||0]),[]}}function mat3FromArray(e){if(9!==e.length)throw new Error("Cannot convert this object into a matrix, wrong size: "+e.length);var t=__read(e,9),r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],c=t[6],u=t[7],l=t[8];return mat3(vec3(r,o,c),vec3(n,s,u),vec3(i,a,l))}function mat3ToArray(e){return[e.rows[0].x,e.rows[1].x,e.rows[2].x,e.rows[0].y,e.rows[1].y,e.rows[2].y,e.rows[0].z,e.rows[1].z,e.rows[2].z]}function prodmat3(e,t){var r=transposemat3(t);return mat3(mulmat3(r,e.rows[0]),mulmat3(r,e.rows[1]),mulmat3(r,e.rows[2]))}function mulmat3(e,t){return vec3(dot3D(e.rows[0],t),dot3D(e.rows[1],t),dot3D(e.rows[2],t))}function vec3(e,t,r){return{x:e,y:t,z:r}}function dot3D(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}function mat3(e,t,r){return{rows:[e,t,r]}}function transposemat3(e){var t=e.rows[0],r=e.rows[1],n=e.rows[2];return mat3(vec3(t.x,r.x,n.x),vec3(t.y,r.y,n.y),vec3(t.z,r.z,n.z))}function newRpcWrapper(){return new RpcWrapper}var RpcWrapper=function(){function e(){this.idCounter=1,this.requestMap={},this.msgMap={},this.LeafEnvelope=genvidproto.genvid.proto.LeafEnvelope}return e.prototype.init=function(e,t){var r=this;this.ws=e,this.ws.onmessage=function(e){t(e),r.wsOnMessage(e)}},e.prototype.registerMessage=function(e,t){this.msgMap[e]=t},e.prototype.wsOnMessage=function(e){try{this.LeafEnvelope.create();var t=this.LeafEnvelope.decode(new Uint8Array(e.data));if(t.method)this.onMethodReceived(t);else{if(!t.result&&!t.error)throw Error("Unknown message");this.onReplyReceived(t)}}catch(e){throw error(e),e}},e.prototype.onReplyReceived=function(e){var t=this.requestMap[e.id];t?(e.result?t.executor(e.result):t.reject(e.error),delete this.requestMap[e.id]):error("Callback not found")},e.prototype.onMethodReceived=function(e){var t=this.msgMap[e.method];if(!t)throw e.id&&this.sendError(e.id,-32601,"Method not found"),Error("Method not found");try{var r=t(e.params);if(e.id){var n={id:e.id,result:r},i=this.LeafEnvelope.create(n),o=this.LeafEnvelope.encode(i).finish();this.ws&&this.ws.send(o)}}catch(t){throw e.id&&this.sendError(e.id,-32603,"Internal error"),t}},e.prototype.sendError=function(e,t,r){var n=this.LeafEnvelope.create({id:e,error:{code:t,message:r}}),i=this.LeafEnvelope.encode(n).finish();this.ws&&this.ws.send(i)},e.prototype.sendMsg=function(e,t){var r=this.LeafEnvelope.create({method:e,params:t}),n=this.LeafEnvelope.encode(r).finish();this.ws&&this.ws.send(n)},e.prototype.sendRequest=function(e,t){var r=this;return new Promise(function(n,i){var o=r.idCounter++,s=r.LeafEnvelope.create({method:e,params:t,id:o}),a={env:s,executor:n,reject:i};r.requestMap[o]=a;var c=r.LeafEnvelope.encode(s).finish();r.ws&&r.ws.send(c)})},e}();function newTimeSmoother(e,t,r){return void 0===e&&(e=0),void 0===t&&(t=new Date),void 0===r&&(r=1/0),new TimeSmoother(e,t,r)}var TimeSmoother=function(){function e(e,t,r){void 0===e&&(e=0),void 0===t&&(t=new Date),void 0===r&&(r=1/0),this.lastObservedTime=e,this.lastObservedTimeClient=t||new Date,this.maxEstimationDuration=r}return e.prototype.set=function(e,t){void 0===t&&(t=new Date),e!==this.lastObservedTime&&(this.lastObservedTime=e,this.lastObservedTimeClient=t||new Date)},e.prototype.get=function(e){void 0===e&&(e=new Date);var t=(e=e||new Date).getTime()-this.lastObservedTimeClient.getTime();return t=Math.min(t,this.maxEstimationDuration),this.lastObservedTime+t},e.prototype.set_get=function(e,t){return void 0===t&&(t=new Date),this.set(e,t),this.get(t)},e.prototype.set_max_estimation_duration=function(e){this.maxEstimationDuration=e},e}(),PlayerEvents={PLAYING:"playing",PAUSE:"pause"};function newFakePlayer(e,t,r,n){return new FakePlayer(e,t,r,n)}var FakePlayer=function(){function e(e,t,r,n){this.paused=!1,this.muted=!1,this.volume=1,this.playerDiv=getConfig().window.document.getElementById(e),this.playerDiv.setAttribute("style","width: 100%; height: 100%;"),this.channel=t,this.options=n,r&&r(this.playerDiv)}return e.prototype.getSyncTime=function(e){return Date.now()/1e3},e.prototype.getCurrentTime=function(){return Date.now()/1e3},e.prototype.play=function(){this.paused=!1,this.eventPlaying&&this.eventPlaying(PlayerEvents.PLAYING)},e.prototype.pause=function(){this.paused=!0,this.eventPlaying&&this.eventPause&&this.eventPause(PlayerEvents.PAUSE)},e.prototype.isPaused=function(){return this.paused},e.prototype.getMuted=function(){return this.muted},e.prototype.setMuted=function(e){this.muted=e},e.prototype.getVolume=function(){return this.volume},e.prototype.setVolume=function(e){this.volume=e<0?0:e>1?1:e},e.prototype.addEventListener=function(e,t){switch(e){case PlayerEvents.PLAYING:this.eventPlaying=t;break;case PlayerEvents.PAUSE:this.eventPause=t;break;default:throw Error("Invalid event:"+e)}},e}(),HttpClient=function(){function e(){}return e.prototype.get=function(e,t){var r=new XMLHttpRequest;r.onreadystatechange=function(){4===r.readyState&&200===r.status&&t(r.responseText)},r.open("GET",e,!0),r.send()},e}();function newTwitchPlayer(e,t,r,n,i){return new TwitchPlayer(e,t,r,n,i)}function getAverageNtpTransportTimeSinceLastCall(e){if(e instanceof TwitchPlayer){var t=e.totalNtpTransportTimeMS/e.numNtpRequests;return e.totalNtpTransportTimeMS=0,e.numNtpRequests=0,t}return-1}var TwitchPlayer=function(){function e(e,t,r,n,i){var o=this;this.playerReady=!1,this.twitchOptions={},this.clientSendTimeMS=0,this.ntpTimeOffsetMS=0,this.numNtpRequests=0,this.totalNtpTransportTimeMS=0,this.paused=!1,this.muted=!1,this.volume=100,this.ntpPollingIntervalMS=1e4,this.ntpPollingHandle=-1,this.lastCurrentTimeMS=-1,this.firstPlaybackStats=0,this.twitchOptions=n||{},this.twitchOptions.width=n.width||"100%",this.twitchOptions.height=n.height||"100%",this.twitchOptions.channel=n.channel||t,this.twitchOptions.parent=n.parent||[],this.ntpURL=i,this.twitchReady=r,this.twitchDiv=e;var s=document.createElement("script");s.src="https://player.twitch.tv/js/embed/v1.js";var a=document.getElementsByTagName("script")[0];if(!a||!a.parentNode)throw Error("No script tag insertable");a.parentNode.insertBefore(s,a),s.onload=this.onTwitchApiReady.bind(this),this.httpRequestNtpTime(),this.ntpPollingHandle=window.setInterval(function(){o.httpRequestNtpTime()},this.ntpPollingIntervalMS)}return e.prototype.close=function(){-1!==this.ntpPollingHandle&&clearInterval(this.ntpPollingHandle)},e.prototype.onTwitchApiReady=function(){this.player=new Twitch.Player(this.twitchDiv,this.twitchOptions),this.player.addEventListener(Twitch.Player.READY,this.onTwitchReady.bind(this))},e.prototype.onTwitchReady=function(){if(this.twitchReady&&!this.playerReady&&this.player){var e=getConfig().window.document.getElementById(this.twitchDiv);this.twitchReady(e),this.paused?this.pause():this.play(),this.setMuted(this.muted),this.setVolume(this.volume),this.playerReady=!0}},e.prototype.getCurrentTime=function(){var e=this.getPlaybackStats();return this.playerReady?this.player&&this.player.isPaused()||(this.ntpTimeOffsetMS&&e&&e.hlsLatencyBroadcaster?this.lastCurrentTimeMS=Date.now()-1e3*e.hlsLatencyBroadcaster+this.ntpTimeOffsetMS:this.lastCurrentTimeMS=-1):this.lastCurrentTimeMS=-1,this.lastCurrentTimeMS},e.prototype.httpRequestNtpTime=function(){var e=this,t=new HttpClient;this.clientSendTimeMS=(new Date).getTime(),t.get(this.ntpURL,function(t){return e.ntpResponse(t)})},e.prototype.ntpResponse=function(e){var t=(new Date).getTime(),r=(t-this.clientSendTimeMS)/2,n=JSON.parse(e),i=Date.parse(n.time);this.ntpTimeOffsetMS=i+r-t,this.totalNtpTransportTimeMS+=r,this.numNtpRequests++},e.prototype.play=function(){this.player&&(this.player.play(),this.paused=this.player.isPaused())},e.prototype.pause=function(){this.player&&(this.player.pause(),this.paused=this.player.isPaused())},e.prototype.isPaused=function(){return this.player&&(this.paused=this.player.isPaused()),this.paused},e.prototype.getMuted=function(){return this.player&&(this.muted=this.player.getMuted()),this.muted},e.prototype.setMuted=function(e){this.muted=!!e,this.player&&this.player.setMuted(this.muted)},e.prototype.getVolume=function(){return this.volume},e.prototype.setVolume=function(e){this.volume=Math.min(Math.max(0,e),100),this.player&&this.player.setVolume(this.volume/100)},e.prototype.setStreamInfo=function(e){e.ntpuri&&(this.ntpURL=e.ntpuri)},e.prototype.getPlaybackStats=function(){if(this.playerReady&&this.player){this.firstPlaybackStats=this.firstPlaybackStats||Date.now();var e=this.player.getPlaybackStats();return 0===e.hlsLatencyBroadcaster&&Date.now()-this.firstPlaybackStats>5e3&&(e.hlsLatencyBroadcaster=1e-4),e}},e.prototype.addEventListener=function(e,t){var r="";switch(e){case PlayerEvents.PLAYING:r=Twitch.Player.PLAY;break;case PlayerEvents.PAUSE:r=Twitch.Player.PAUSE;break;default:throw Error("Invalid event:"+e)}this.player&&this.player.addEventListener(r,function(){t(e)})},e.prototype.getSyncTime=function(e){return e.sendingTime},e}();function newTwitchExtPlayer(e,t,r,n,i){return new TwitchExtPlayer(e,t,r,n,i)}var EventInfo=function(){return function(e,t){this.name=e,this.handler=t}}(),TwitchExtPlayer=function(){function e(e,t,r,n,i){var o=this;this.playerReady=!1,this.init={},this.options={},this.clientSendTimeMS=0,this.ntpTimeOffsetMS=0,this.paused=!0,this.hlsLatencyBroadcasterS=-1,this.eventInfoArray=[],this.ntpPollingIntervalMS=1e4,this.ntpPollingHandle=-1,this.lastCurrentTimeMS=-1,this.options=n||{},this.options.channel=n.channel||t,this.ntpURL=i,this.onReady=r,getConfig().window.Twitch.ext.onContext(this.onTwitchExtContext.bind(this)),this.httpRequestNtpTime(),this.ntpPollingHandle=window.setInterval(function(){o.httpRequestNtpTime()},this.ntpPollingIntervalMS)}return e.prototype.close=function(){-1!==this.ntpPollingHandle&&clearInterval(this.ntpPollingHandle)},e.prototype.getCurrentTime=function(){return this.playerReady?this.player&&this.player.isPaused()||(this.ntpTimeOffsetMS&&this.hlsLatencyBroadcasterS>0?this.lastCurrentTimeMS=Date.now()-1e3*this.hlsLatencyBroadcasterS+this.ntpTimeOffsetMS:this.lastCurrentTimeMS=-1):this.lastCurrentTimeMS=-1,this.lastCurrentTimeMS},e.prototype.play=function(){throw Error("play() is not implemented for TwitchExtPlayer!")},e.prototype.pause=function(){throw Error("pause() is not implemented for TwitchExtPlayer!")},e.prototype.isPaused=function(){return this.paused},e.prototype.getMuted=function(){throw Error("getMuted() is not implemented for TwitchExtPlayer!")},e.prototype.setMuted=function(e){throw Error("setMuted() is not implemented for TwitchExtPlayer!")},e.prototype.getVolume=function(){throw Error("getVolume() is not implemented for TwitchExtPlayer!")},e.prototype.setVolume=function(e){throw Error("setVolume() is not implemented for TwitchExtPlayer!")},e.prototype.addEventListener=function(e,t){this.eventInfoArray.push(new EventInfo(e,t))},e.prototype.getSyncTime=function(e){return e.sendingTime},e.prototype.setStreamInfo=function(e){e.ntpuri&&(this.ntpURL=e.ntpuri)},e.prototype.onTwitchExtContext=function(e,t){var r,n;if(this.playerReady)try{for(var i=__values(t),o=i.next();!o.done;o=i.next()){switch(o.value){case"isPaused":this.paused!==e.isPaused&&(this.paused=e.isPaused,this.paused?this.fireEvent(PlayerEvents.PAUSE):this.fireEvent(PlayerEvents.PLAYING));break;case"hlsLatencyBroadcaster":this.hlsLatencyBroadcasterS=e.hlsLatencyBroadcaster}}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}else this.paused=e.isPaused,this.hlsLatencyBroadcasterS=e.hlsLatencyBroadcaster,this.playerReady||(this.init={},this.playerReady=!0,this.onReady());var s={context:e,contextFields:t};this.fireEvent("twitchextoncontext",s)},e.prototype.httpRequestNtpTime=function(){var e=this,t=new HttpClient;this.clientSendTimeMS=Date.now(),t.get(this.ntpURL,function(t){return e.ntpResponse(t)})},e.prototype.ntpResponse=function(e){var t=Date.now(),r=(t-this.clientSendTimeMS)/2,n=JSON.parse(e),i=Date.parse(n.time);this.ntpTimeOffsetMS=i+r-t},e.prototype.fireEvent=function(e,t){var r,n;void 0===t&&(t={});try{for(var i=__values(this.eventInfoArray),o=i.next();!o.done;o=i.next()){var s=o.value;s.name===e&&s.handler(e,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e}();function newFreeWheel(e){return new FreeWheel(e)}var FreeWheel=function(){function e(e){this.maxError=0,this.speed=0,this.lastPos=0,this.lastTime=0,this.maxError=e}return e.prototype.stop=function(){this.speed=0},e.prototype.isStopped=function(){return 0===this.speed},e.prototype.touch=function(e,t,r){var n=this.getPosition(e);return Math.abs(n-t)>this.maxError?(this.lastPos=t,this.lastTime=e,this.speed=r,t):r!==this.speed?(this.lastPos=n,this.lastTime=e,this.speed=r,n):n},e.prototype.getPosition=function(e){return this.lastPos+this.speed*(e-this.lastTime)},e}();function replaceTargetWith(e,t){var r=getConfig().window.document.getElementById(e);if(!r||!r.parentNode)throw Error("Impossible to find element: "+e);var n,i,o,s=r;for((i=document.createElement("div")).innerHTML=t,n=i.childNodes.length;n--;)r.parentNode.insertBefore(o=i.childNodes[n],s),s=o;r.parentNode.removeChild(r)}function newYouTubePlayer(e,t,r,n){return new YouTubePlayer(e,t,r,n)}var YouTubePlayer=function(){function e(e,t,r,n){if(this.playerPreviouslyInitialized=!1,this.init={},this.apiReady=!1,this.playerReady=!1,this.options={controls:0,disablekb:1,enablejsapi:1,autoplay:1,fs:0,playsinline:1,rel:0},this.videoTimeSmoother=newTimeSmoother(),this.maxVideoEstimationDurationMS=3e3,this.freeWheel=newFreeWheel(.045),this.paused=!1,this.muted=!1,this.volume=100,this.playerPreviouslyInitialized=!!getConfig().window.onYouTubeIframeAPIReady,this.videoDiv=e,this.channel=t,this.onReady=r,n)for(var i in n)this.options[i]=n[i];this.playerPreviouslyInitialized?(this.replaceVideoPlayer(),this.onYouTubeIframeAPIReady()):(this.loadYouTubeIFrameAPI(),this.replaceVideoPlayer()),this.videoTimeSmoother.set_max_estimation_duration(this.maxVideoEstimationDurationMS)}return e.prototype.loadYouTubeIFrameAPI=function(){getConfig().window.onYouTubeIframeAPIReady=this.onYouTubeIframeAPIReady.bind(this);var e=document.createElement("script");e.src="https://www.youtube.com/iframe_api";var t=document.getElementsByTagName("script")[0];if(!t||!t.parentNode)throw Error("Theoretically could not be reached");t.parentNode.insertBefore(e,t)},e.prototype.onYouTubeIframeAPIReady=function(){this.apiReady=!0,this.bindVideoPlayer()},e.prototype.onPlayerReady=function(e){if(this.playerReady=!0,this.paused?this.pause():this.play(),this.setMuted(this.muted),this.setVolume(this.volume),e.target.playVideo(),this.onReady){var t=getConfig().window.document.getElementById(this.videoDiv);this.onReady(t)}},e.prototype.replaceVideoPlayer=function(){var e=["channel="+this.channel];for(var t in this.options)e.push(t+"="+this.options[t]);var r='<iframe id="'+this.videoDiv+'" src="https://www.youtube.com/embed/'+this.channel+"?"+e.join("&")+'" frameborder="0" allow="autoplay \'src\'"></iframe>';replaceTargetWith(this.videoDiv,r)},e.prototype.bindVideoPlayer=function(){var e={width:"100%",height:"100%",videoId:this.channel,playerVars:this.options,events:{onReady:this.onPlayerReady.bind(this)}};this.player=new YT.Player(this.videoDiv,e)},e.prototype.getCurrentTime=function(){if(this.playerReady){var e=this.isPaused();e?this.videoTimeSmoother.set_max_estimation_duration(0):this.videoTimeSmoother.set_max_estimation_duration(this.maxVideoEstimationDurationMS);var t=new Date,r=1e3*this.player.getMediaReferenceTime();return r<=0?-1:(r=this.videoTimeSmoother.set_get(r,t),e||(r=this.freeWheel.touch(Date.now(),r,.001)),r)}return-1},e.prototype.play=function(){this.player&&this.player.playVideo()},e.prototype.pause=function(){this.player&&this.player.pauseVideo(),this.freeWheel.stop()},e.prototype.isPaused=function(){if(this.player){var e=this.player.getPlayerState();this.paused=e===YT.PlayerState.PAUSED}return this.paused},e.prototype.getMuted=function(){return this.player&&(this.muted=this.player.isMuted()),!!this.muted},e.prototype.setMuted=function(e){this.muted=!!e,this.player&&(this.muted?this.player.mute():this.player.unMute())},e.prototype.getVolume=function(){return this.volume},e.prototype.setVolume=function(e){this.volume=Math.min(Math.max(0,e),100),this.player&&this.player.setVolume(this.volume)},e.prototype.addEventListener=function(e,t){var r=0;switch(e){case PlayerEvents.PLAYING:r=YT.PlayerState.PLAYING;break;case PlayerEvents.PAUSE:r=YT.PlayerState.PAUSED;break;default:throw new Error("Invalid event:"+e)}this.player&&this.player.addEventListener("onStateChange",function(n){var i=n.data;r===i&&t(e)})},e.prototype.reloadVideoPlayer=function(e,t){this.player?(log("Reloading video player with new VideoID"),this.player.loadVideoById(e)):error("videoPlayer needs to be instantiated before being reloaded")},e.prototype.getSyncTime=function(e){return(e.startIngestTime||0)+(e.pts||0)},e}(),FBPlayerEvents;function newFacebookPlayer(e,t,r,n){return new FacebookPlayer(e,t,r,n)}!function(e){e.StartedPlaying="startedPlaying",e.Paused="paused",e.FinishedPlaying="finishedPlaying",e.StartedBuffering="startedBuffering",e.FinishedBuffering="finishedBuffering",e.Error="error"}(FBPlayerEvents||(FBPlayerEvents={}));var EventInfo$1=function(){return function(e,t){this.name=e,this.handler=t}}(),FacebookPlayer=function(){function e(e,t,r,n){var i=this;if(this.playerPreviouslyInitialized=!1,this.init={},this.apiLoaded=!1,this.playerReady=!1,this.settings={},this.options={controls:"false",allowfullscreen:"false",autoplay:"false",lazy:"false",width:"auto",showText:"false",showCaptions:"false",apiVersion:"undefined",appId:"undefined",debug:!1,fakeSync:!1,fakeSyncDelayMS:0},this.videoTimeSmoother=newTimeSmoother(),this.maxVideoEstimationDurationMS=3e3,this.freeWheel=newFreeWheel(.045),this.eventInfoArray=[],this.FBEventHandlers={},this.paused=!1,this.muted=!1,this.volume=100,this.currentPosition=0,this.duration=0,this.onPlayerReady=function(e){if("video"===e.type&&e.id===i.fbDivId){if(i.playerReady=!0,i.player=e.instance,i.player.mute(),i.paused?i.pause():i.play(),i.setMuted(i.muted),i.setVolume(i.volume),i.onReady){var t=getConfig().window.document.getElementById(i.videoDivId);i.onReady(t)}log("xfbml.ready for video",e.id)}},this.playerPreviouslyInitialized=!!getConfig().window.fbAsyncInit,this.videoDivId=e,this.channel=t,this.onReady=r,this.fbDivId="",n)for(var o in n)this.options[o]=n[o];this.options.debug?this.sdkSrc="https://connect.facebook.net/en_US/sdk/debug.js":this.sdkSrc="https://connect.facebook.net/en_US/sdk.js",this.playerPreviouslyInitialized?this.initFacebookApi():this.loadFacebookAPI(),this.videoTimeSmoother.set_max_estimation_duration(this.maxVideoEstimationDurationMS)}return e.prototype.loadFacebookAPI=function(){var e=getConfig().window;if(null!==e.fbAsyncInit){e.fbAsyncInit=this.onFacebookApiLoaded.bind(this);var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.defer=!0,t.crossOrigin="anonymous",t.src=this.sdkSrc;var r=document.body.firstChild;if(!r||!r.parentNode)throw Error("Theoretically could not be reached");r.parentNode.insertBefore(t,r)}},e.prototype.onFacebookApiLoaded=function(){this.apiLoaded=!0,this.initFacebookApi()},e.prototype.initFacebookApi=function(){if(null!=typeof FB){var e={appId:this.options.appId,xfbml:!0,version:this.options.apiVersion};FB.init(e),FB.Event.subscribe("xfbml.ready",this.onPlayerReady),this.onFacebookApiInit()}else error("FB object not found, we can't create a player.")},e.prototype.onFacebookApiInit=function(){var e=this.getFacebookPermalinkUrl();e&&this.createFacebookEmbedVideoPlayer(e)},e.prototype.subscribeToFBEvent=function(e){var t=this,r=this.player.subscribe(e,function(r){t.fireEvent(e,r)});this.FBEventHandlers[e]=r},e.prototype.fireEvent=function(e,t){var r,n;void 0===t&&(t={});try{for(var i=__values(this.eventInfoArray),o=i.next();!o.done;o=i.next()){var s=o.value;s.name===e&&s.handler(e,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e.prototype.createFacebookEmbedVideoPlayer=function(e,t){void 0===t&&(t=!1),this.playerReady=!1;var r=getConfig().window.document.getElementById(this.videoDivId);if(this.fbDivId=Date.now().toString(),!r)throw Error("No div id defined");if(r.querySelectorAll("*").forEach(function(e){return e.remove()}),!e||e.length<=0)warn("Channel is empty no video player will be instantiated.");else{var n=document.createElement("div");n.id=this.fbDivId,n.classList.add("fb-video"),n.dataset.href=e,n.dataset.controls=this.options.controls,n.dataset.allowfullscreen=this.options.allowfullscreen,n.dataset.autoplay=this.options.autoplay,n.dataset.lazy=this.options.lazy,n.dataset.width=this.options.width,n.dataset.showText=this.options.showText,n.dataset.showCaptions=this.options.showCaptions,r.appendChild(n),t&&setTimeout(function(){FB.XFBML.parse()},15e3)}},e.prototype.getFacebookPermalinkUrl=function(){return this.channel},e.prototype.getCurrentTime=function(){if(this.playerReady){var e=this.isPaused();e?this.videoTimeSmoother.set_max_estimation_duration(0):this.videoTimeSmoother.set_max_estimation_duration(this.maxVideoEstimationDurationMS);var t=new Date,r=this.options.fakeSync?new Date(Date.now()).getTime()-this.options.fakeSyncDelayMS:1e3*this.player.getCurrentPosition();return r<=0?-1:(r=this.videoTimeSmoother.set_get(r,t),e||(r=this.freeWheel.touch(Date.now(),r,.001)),r)}return-1},e.prototype.play=function(){this.player&&this.player.play(),this.paused=!1},e.prototype.pause=function(){this.player&&this.player.pause(),this.paused=!0},e.prototype.isPaused=function(){return this.paused},e.prototype.getMuted=function(){return this.player&&(this.muted=this.player.isMuted()),!!this.muted},e.prototype.setMuted=function(e){this.muted=!!e,this.player&&(this.muted?this.player.mute():this.player.unmute())},e.prototype.getVolume=function(){return this.player&&(this.volume=100*this.player.getVolume()),this.volume},e.prototype.setVolume=function(e){this.volume=Math.min(Math.max(0,e),100),this.player&&this.player.setVolume(this.volume/100)},e.prototype.getCurrentPosition=function(){return this.player&&(this.currentPosition=this.player.getCurrentPosition()),this.currentPosition},e.prototype.getDuration=function(){return this.player&&(this.duration=this.player.getDuration()),this.duration},e.prototype.addEventListener=function(e,t){switch(e){case PlayerEvents.PLAYING:this.checkAndAddListener(FBPlayerEvents.StartedPlaying,t);break;case PlayerEvents.PAUSE:this.checkAndAddListener(FBPlayerEvents.Paused,t);break;case FBPlayerEvents.FinishedPlaying:case FBPlayerEvents.StartedBuffering:case FBPlayerEvents.FinishedBuffering:case FBPlayerEvents.Error:this.checkAndAddListener(e,t);break;default:console.error("Unsupported event ! event:",e)}},e.prototype.checkAndAddListener=function(e,t){this.FBEventHandlers[e]||this.subscribeToFBEvent(e),this.eventInfoArray.push(new EventInfo$1(e,t))},e.prototype.removeEventListener=function(e){this.FBEventHandlers&&this.FBEventHandlers[e]&&(this.FBEventHandlers[e].release(e),delete this.FBEventHandlers[e],this.eventInfoArray=this.eventInfoArray.filter(function(t){return t.name!==e}))},e.prototype.close=function(){var e=getConfig().window.document.getElementById(this.videoDivId);e&&e.querySelectorAll("*").forEach(function(e){return e.remove()}),FB.Event.unsubscribe("xfbml.ready",this.onPlayerReady),this.onReady(null),this.playerReady=!1},e.prototype.reloadVideoPlayer=function(e,t){var r=this;this.player?(log("Reloading video player with new permalinkUrl."),setTimeout(function(){r.close(),FB.Event.subscribe("xfbml.ready",r.onPlayerReady),r.createFacebookEmbedVideoPlayer(e,!0)},t)):error("videoPlayer needs to be instantiated before being reloaded")},e.prototype.getSyncTime=function(e){e.sendingTime,e.pts;return this.options.fakeSync?e.sendingTime:e.pts},e}(),EventInfo$2=function(){return function(e,t){this.name=e,this.handler=t}}();function newIGFacebookPlayer(e,t,r,n){return new FacebookIGPlayer(e,t,r,n)}var FacebookIGPlayer=function(){function e(e,t,r,n){if(this.videoID="",this.playerReady=!1,this.videoPlayerInstanceOptions={volume:0,play:!0},this.paused=!1,this.volume=0,this.currentPositionMS=0,this.videoTimeSmoother=newTimeSmoother(),this.maxVideoEstimationDurationMS=3e3,this.eventInfoArray=[],this.videoDivId=e,this.channel=t,this.onReady=r,n)for(var i in n)this.videoPlayerInstanceOptions[i]=n[i];this.videoTimeSmoother.set_max_estimation_duration(this.maxVideoEstimationDurationMS),this.initFbIGApi()}return e.prototype.initFbIGApi=function(){if(null==typeof FBInstant)throw Error("Facebook Instant Game SDK not found");var e=this.getFacebookPermalinkUrl();if(e){var t=this.getVideoIDFromChannel(e),r=this.videoPlayerInstanceOptions;this.createFacebookIGVideoPlayer(t,r)}},e.prototype.createFacebookIGVideoPlayer=function(e,t){var r=this;FBInstant.videoPlayer.createAsync(e,t).then(function(e){r.videoPlayerInstance=e,r.videoPlayerInstance.getStateAsync().then(function(e){if(r.videoPlayerInstanceOptions=__assign({},e),r.playerReady=!0,r.onReady){var t=getConfig().window.document.getElementById(r.videoDivId);r.onReady(t)}})}).catch(function(e){return error("error creating a new video player instance:",e.message)})},e.prototype.getFacebookPermalinkUrl=function(){return this.channel},e.prototype.getCurrentVideoID=function(){return this.videoPlayerInstance&&(this.videoID=this.videoPlayerInstance.getVideoID()),this.videoID},e.prototype.play=function(){this.videoPlayerInstance.setState({play:!0}),this.updateVideoPlayerState()},e.prototype.pause=function(){this.videoPlayerInstance.setState({play:!1}),this.updateVideoPlayerState()},e.prototype.updateVideoPlayerState=function(){var e=this;this.videoPlayerInstance.getStateAsync().then(function(t){e.videoPlayerInstanceOptions=__assign({},t),log("video player state",e.videoPlayerInstanceOptions),e.onFacebookStateChange(e.videoPlayerInstanceOptions)})},e.prototype.isPaused=function(){return!this.videoPlayerInstanceOptions.play},e.prototype.getMuted=function(){this.updateVideoPlayerState();var e=this.videoPlayerInstanceOptions.volume;return!(e&&e>0)},e.prototype.setMuted=function(e){e?this.videoPlayerInstance.setState({muted:!0,volume:0}):(0===this.volume&&(this.volume=1),this.videoPlayerInstance.setState({muted:!1,volume:this.volume}))},e.prototype.getVolume=function(){throw Error("not implemented, please use getVolumeAsync()")},e.prototype.getVolumeAsync=function(){if(this.videoPlayerInstance)return this.videoPlayerInstance.getStateAsync().then(function(e){return e.volume});throw Error("no video player instance found")},e.prototype.setVolume=function(e){if(!(e>=0&&e<=1))throw Error("volume level must be between 0.0 and 1.0");this.volume=e,this.videoPlayerInstance&&this.videoPlayerInstance.setState({play:!0,volume:this.volume})},e.prototype.addEventListener=function(e,t){this.eventInfoArray.push(new EventInfo$2(e,t))},e.prototype.getCurrentTimeStampMS=function(){return this.videoPlayerInstance&&(this.currentPositionMS=this.videoPlayerInstance.getCurrentTimeStamp()),this.currentPositionMS},e.prototype.getCurrentTime=function(){if(this.videoPlayerInstance){var e=this.videoPlayerInstance.getCurrentTimestamp();if(e<=0)return-1;var t=new Date;return e=this.videoTimeSmoother.set_get(e,t)}return-1},e.prototype.reloadVideoPlayer=function(e,t){var r=this;this.videoPlayerInstance?(log("Reloading video player with new permalinkUrl."),setTimeout(function(){var t=r.getMuted();r.videoPlayerInstance.destroy();var n=r.getVideoIDFromChannel(e),i={play:!0,volume:t?0:r.volume};r.createFacebookIGVideoPlayer(n,i)},t)):error("videoPlayer needs to be instantiated before being reloaded")},e.prototype.getVideoIDFromChannel=function(e){var t=e.replace(/\/$/,"");return e.substring(t.lastIndexOf("/videos/")+8,e.length).replace("/","")},e.prototype.getSyncTime=function(e){return e.pts},e.prototype.onFacebookStateChange=function(e){this.paused=!e.play,this.paused?this.fireEvent(PlayerEvents.PAUSE):this.fireEvent(PlayerEvents.PLAYING)},e.prototype.close=function(){this.videoPlayerInstance.destroy(),this.onReady(null)},e.prototype.fireEvent=function(e,t){var r,n;void 0===t&&(t={});try{for(var i=__values(this.eventInfoArray),o=i.next();!o.done;o=i.next()){var s=o.value;s.name===e&&s.handler(e,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}},e}(),kPauseSkipIntervalMS=1e4,kResumeLatencyS=0;function newStandalonePlayer(e,t,r,n){return new StandalonePlayer(e,t,r,n)}var FetchIncrementalLoader=function(){function e(){}return e.prototype.get=function(e,t,r,n){var i,o;return __awaiter(this,void 0,void 0,function(){var s,a,c,u,l,d,p,h,m,f;return __generator(this,function(g){switch(g.label){case 0:return g.trys.push([0,2,,3]),[4,fetch(e)];case 1:return s=g.sent(),[3,3];case 2:return a=g.sent(),n(a),[2];case 3:if(!(c=s.headers.get("Content-Type")))throw Error("No codec given in Content-Type header");if(u=0,(l=s.headers.get("x-genvid-start-pts"))&&(u=1e3*parseFloat(l)),!t(c,u))return[3,19];g.label=4;case 4:if(g.trys.push([4,17,,18]),!s.body)throw Error("Cannot read stream, the response does not contain a body");g.label=5;case 5:g.trys.push([5,10,11,16]),d=__asyncValues(this.streamToIterator(s.body)),g.label=6;case 6:return[4,d.next()];case 7:if((p=g.sent()).done)return[3,9];h=p.value,r(h),g.label=8;case 8:return[3,6];case 9:return[3,16];case 10:return m=g.sent(),i={error:m},[3,16];case 11:return g.trys.push([11,,14,15]),p&&!p.done&&(o=d.return)?[4,o.call(d)]:[3,13];case 12:g.sent(),g.label=13;case 13:return[3,15];case 14:if(i)throw i.error;return[7];case 15:return[7];case 16:return[3,18];case 17:return f=g.sent(),n(f),[2];case 18:return[3,20];case 19:setTimeout(function(){window.location.reload()},2e3),g.label=20;case 20:return[2]}})})},e.prototype.streamToIterator=function(e){return __asyncGenerator(this,arguments,function(){var t,r,n,i;return __generator(this,function(o){switch(o.label){case 0:t=e.getReader(),o.label=1;case 1:o.trys.push([1,,9,10]),o.label=2;case 2:return[4,__await(t.read())];case 3:return r=o.sent(),n=r.done,i=r.value,n?[4,__await(void 0)]:[3,5];case 4:return[2,o.sent()];case 5:return[4,__await(i)];case 6:return[4,o.sent()];case 7:return o.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})},e}(),StandalonePlayer=function(){function e(e,t,r,n){this.streamingMetaUrl="",this.playerReady=!1,this.timeOffsetMS=0,this.pendingSegmentArray=[],this.freeWheel=newFreeWheel(45),this.streamingMetaUrl=t.replace(".mp4","-meta.json"),this.videoPlayerOptions=n,this.onPlayerReady=r,this.insertVideoPlayer(e,t),this.timeSinceLastSkip=Date.now()}return e.prototype.getSyncTime=function(e){return e.pts||0},e.prototype.getDeviationFromLatestFrame=function(){return this.videoElement&&this.videoElement.seekable.length>0?1e3*(this.videoElement.seekable.end(0)-this.videoElement.currentTime):-1},e.prototype.getPlaybackRate=function(){return this.videoElement?this.videoElement.playbackRate:1},e.prototype.getVideoEmulatedTime=function(e){var t=this.videoElement;return"frame"===e?t.webkitDecodedFrameCount/30:"bit"===e&&this.streamingMeta?t.webkitVideoDecodedByteCount/(8*this.streamingMeta.video["bit-rate"]):void 0},e.prototype.httpRequestStreamingMeta=function(){var e=this;(new HttpClient).get(this.streamingMetaUrl,function(t){e.streamingMeta=JSON.parse(t),e.timeOffsetMS=1e3*e.streamingMeta["last-start-pts"]})},e.prototype.initMediaSource=function(e){if(this.MediaSource=window.MediaSource||window.WebKitMediaSource,!this.MediaSource)return warn("MediaSource is not supported"),!1;var t=new this.MediaSource;return this.mediaSource=t,t.addEventListener("sourceopen",function(t){return e()},!1),t.addEventListener("webkitsourceopen",function(t){return e()},!1),t.addEventListener("sourceended",function(e){return log("sourceended:"+t.readyState)}),t.addEventListener("sourceclose",function(e){return log("sourceclose:"+t.readyState)}),t.addEventListener("error",function(e){return log("media source error:"+t.readyState)}),!0},e.prototype.initSourceBuffer=function(e){var t=this;if(this.sourceBuffer&&this.mediaSource)return info("No need to reinit the source buffer"),!0;if(log(e,"isTypeSupported:",this.MediaSource.isTypeSupported(e)),!this.mediaSource)throw Error("Impossible to init source buffer: mediaSource not initialized");return"open"===this.mediaSource.readyState&&this.MediaSource.isTypeSupported(e)?(this.sourceBuffer=this.mediaSource.addSourceBuffer(e),this.sourceBuffer.mode="sequence",this.sourceBuffer.addEventListener("updateend",function(e){t.pendingSegmentArray.length>0&&t.sourceBuffer&&!t.sourceBuffer.updating&&t.sourceBuffer.appendBuffer(t.pendingSegmentArray.shift())}),this.sourceBuffer.addEventListener("error",function(e){return log("source buffer error: "+t&&t.mediaSource&&t.mediaSource.readyState,e)}),this.sourceBuffer.addEventListener("abort",function(e){return log("source buffer abort: "+t&&t.mediaSource&&t.mediaSource.readyState)}),!0):(warn("Could not initialize the source buffer: media source not open or type not supported."),!1)},e.prototype.startLoader=function(e){var t=this;(new FetchIncrementalLoader).get(e,function(e,r){var n=t.initSourceBuffer(e);return r&&(t.timeOffsetMS=r),n},function(e){e&&t.sourceBuffer&&(t.sourceBuffer.updating?t.pendingSegmentArray.push(e):t.pendingSegmentArray.length>0?t.pendingSegmentArray.push(e):(t.isPaused()&&t.videoElement&&t.sourceBuffer.buffered.length>0&&t.sourceBuffer.buffered.end(0)-kResumeLatencyS>t.videoElement.currentTime&&t.timeSinceLastSkip+kPauseSkipIntervalMS<Date.now()&&(t.timeSinceLastSkip=Date.now(),t.videoElement.currentTime=t.sourceBuffer.buffered.end(0)-kResumeLatencyS),t.sourceBuffer.appendBuffer(e)))},function(r){error(r),setTimeout(function(){return t.startLoader(e)},2e3)})},e.prototype.insertVideoPlayer=function(e,t){var r=this,n=document.getElementById(e);if(!n)throw Error("Impossible to insert video player, could not find videoDivId: "+e);if(this.videoContainer=n,!this.videoContainer)throw Error("Element id not found: "+e);this.videoElement=document.createElement("video"),this.videoContainer.appendChild(this.videoElement),this.videoPlayerOptions.width&&(this.videoElement.width=this.videoPlayerOptions.width),this.videoPlayerOptions.height&&(this.videoElement.height=this.videoPlayerOptions.height),this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.autoplay=!0;var i=document.createElement("div");this.videoContainer.appendChild(i),i.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAACXBIWXMAAAsTAAALEwEAmpwYAAAFEmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIiB4bXA6Q3JlYXRlRGF0ZT0iMjAxOC0wNS0yMlQwOToxMzoyOC0wNDowMCIgeG1wOk1vZGlmeURhdGU9IjIwMTgtMTAtMjRUMTI6NTM6NDItMDQ6MDAiIHhtcDpNZXRhZGF0YURhdGU9IjIwMTgtMTAtMjRUMTI6NTM6NDItMDQ6MDAiIGRjOmZvcm1hdD0iaW1hZ2UvcG5nIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6YmYwNWMyZjQtYTZhMC0xNTRlLWExZGYtZDYyMWViOTQzY2JiIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOmJmMDVjMmY0LWE2YTAtMTU0ZS1hMWRmLWQ2MjFlYjk0M2NiYiIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmJmMDVjMmY0LWE2YTAtMTU0ZS1hMWRmLWQ2MjFlYjk0M2NiYiI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YmYwNWMyZjQtYTZhMC0xNTRlLWExZGYtZDYyMWViOTQzY2JiIiBzdEV2dDp3aGVuPSIyMDE4LTA1LTIyVDA5OjEzOjI4LTA0OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIi8+IDwvcmRmOlNlcT4gPC94bXBNTTpIaXN0b3J5PiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pj8FVOsAAAVBSURBVHic7dhhjtNIFIVRZ8SmmCUN6xm2xLLMD8bQMOm047hc9eqeI/VfEgndTy91W9d1ATL91fsLAP0IAAQTAAgmABBMACCYAEAwAYBgAgDBBACCCQAEEwAIJgAQTAAgmABAMAGAYAIAwQQAggkABBMACCYAEEwAIJgAQDABgGACAMEEAIIJAAQTAAgmABBMACCYAEAwAYBgAgDBBACCCQAEEwAIJgAQTAAgmABAMAGAYAIAwQQAggkABBMACCYAEEwAIJgAQDABgGACAMEEAIIJAAQTAAgmABDsU/NP+PL32vwzTnL7+u3W+zvAW+vadj7tA8Bh6z+ft/99YaIJPwFqWP/7g1MJQC1CwKkEoCYR4BQCUJdrgJcJQH1CwGECMA8h4GkCMB8RYDcBmJNrgF0EYG5CwEMCkEEIuEsAsogAvxGAPK4BfhKAXEKAACACyQSAZXENxBIA3hKCMALAPUIQQgB4RAQmJwB8xDUwMQFgLyGYkADwLCGYiABwlAhMQAB4hWugOAHgDEJQlABwJiEoRgBoQQSKEABacQ0UIAC0JgQDEwCuIgIDEgCu5BoYjADQgxAMQgDoSQg6EwBGIAKdCACjcA10IACMRgguJACMSgguIACMTgQaEgAqcA00IgBUIgQnEwAqEoGTCABVuQZOIABUJwQvEABmIQQHCACzEYEnCAAzcg3sJADMTAg+IAAkEIJ3CABJROAPAkAa18AbAkAqIVgEAKJDIADwQ2QEBAB+ibsGBAD+LyYEAgDvmz4CAgCPTX0NCADsM2UIBACeM1UIBACOmSICAgDHlb8GBABeVzYEAgDnKRcCAYDzlYmAAEAbJa4BAYC2hg6BAMA1hgyBAMC1hoqAAMD1hrkGBAD66R4CAYD+ukVAAGAMXa4BAYCxXBoCAYAxXRICAYBgn3p/AeCu2xUfIgAwlkuGvxEAGMOlw994A4D+uox/WVwA0FO34W8EAK7XffgbPwHgWsOMf1lcAHCVoYa/EQBoa8jhbwQA2hh6+BtvAHC+EuNfFhcAnKnM8DcCAK8rN/yNAMBxZYe/8QYAx5Qf/7K4AOBZUwx/IwCwz1TD3wgAPDbl8DfeAOB9U49/WVwAcM/0w98IAPwSM/yNnwDwQ9z4l8UFAJHD3wgAqaKHvxEA0hj+G94ASGL8f3ABkMDw3yEAzMzwPyAAzMjwd/IGwGyM/wkuAGZh+AcIANUZ/gsEgKoM/wTeAKjI+E/iAqASwz+ZAFCB4TfiJwCjM/6GXACMyvAvIACMxvAvJACMwvA78AbACIy/ExcAPRl+ZwJAD4Y/CAHgSoY/GG8AXMX4B+QCoDXDH5gA0IrhF+AnAC0YfxEuAM5k+MUIAGcw/KIEgFcYfnHeADjK+CfgAuBZhj8RAWAvw5+QAPARw5+YNwAeMf7JuQC4x/BDCABvGX4YAWBZDD+WNwCMP5gLIJfhIwCBDJ+f/ATIYvz8xgWQwfC5SwDmZvg8JABzMnx28QYwH+NnNxfAPAyfpwlAfYbPYQJQl+HzMm8ANRk/p3AB1GL4nEoAajB8mhCAgd2+fjP8cOu/bf/927qubT8BGJZHQAgmABBMACCYAEAwAYBgAgDBBACCCQAEEwAIJgAQTAAgmABAMAGAYAIAwQQAggkABBMACCYAEEwAIJgAQDABgGACAMEEAIIJAAQTAAgmABBMACCYAEAwAYBgAgDBBACCCQAEEwAIJgAQTAAgmABAMAGAYAIAwQQAggkABBMACCYAEEwAIJgAQDABgGACAMEEAIIJAAQTAAgmABBMACCYAECw71XBksrygKczAAAAAElFTkSuQmCC')",i.style.backgroundRepeat="no-repeat",i.style.width="50%",i.style.height="50%",i.style.position="absolute",i.style.left="0%",i.style.right="0%",i.style.top="0%",i.style.bottom="0%",i.style.margin="auto",i.style.backgroundSize="contain",i.style.backgroundPosition="center";var o=this.initMediaSource(function(){r.startLoader(t)});this.videoElement.src=o?window.URL.createObjectURL(this.mediaSource):t,this.videoElement.addEventListener("play",function(){if(r.videoElement){if(i.hidden=!0,o){if(r.sourceBuffer&&r.sourceBuffer.buffered.length&&r.videoElement){var e=Math.max(r.sourceBuffer.buffered.start(0),r.sourceBuffer.buffered.end(0)-kResumeLatencyS);r.videoElement.currentTime=e}}else r.httpRequestStreamingMeta();r.firePlayerReady()}}),this.videoElement.addEventListener("pause",function(){i.hidden=!1}),this.videoElement.addEventListener("loadstart",function(){r.firePlayerReady()}),this.videoContainer.addEventListener("click",function(){r.isPaused()?r.play():r.pause()}),this.videoElement.addEventListener("canplay",function(){r.firePlayerReady()})},e.prototype.firePlayerReady=function(){this.playerReady||(this.onPlayerReady(this.videoContainer),this.playerReady=!0)},e.prototype.getCurrentTime=function(){return this.videoElement?1e3*this.videoElement.currentTime+this.timeOffsetMS:-1},e.prototype.play=function(){this.videoElement&&this.videoElement.play()},e.prototype.pause=function(){this.freeWheel.stop(),this.videoElement&&this.videoElement.pause()},e.prototype.isPaused=function(){return!!this.videoElement&&this.videoElement.paused},e.prototype.getMuted=function(){return!!this.videoElement&&this.videoElement.muted},e.prototype.setMuted=function(e){this.videoElement&&(this.videoElement.muted=!!e)},e.prototype.getVolume=function(){return this.videoElement?100*this.videoElement.volume:0},e.prototype.setVolume=function(e){e=Math.min(Math.max(0,e),100),this.videoElement&&(this.videoElement.volume=e/100)},e.prototype.addEventListener=function(e,t){switch(e){case PlayerEvents.PLAYING:this.videoElement&&this.videoElement.addEventListener("play",function(){return t(e)});break;case PlayerEvents.PAUSE:this.videoElement&&this.videoElement.addEventListener("pause",function(){return t(e)});break;default:error("Unsupported event ! event:",e)}},e}(),ClientMetricManager=function(){function e(e,t){this.metricsTimerID=0,this.sendMetricsPeriod=5,this.clientMetricList=[],this.emptyTags=[],this.videoTimeMS=0,this.numLatencyUpdates=0,this.latencyAggregate=0,this.onDrawStartTime=0,this.onDrawDurationAggregate=0,this.onDrawDurationMin=1/0,this.onDrawDurationMax=0,this.onDrawPreviousTime=0,this.onDrawIntervalAggregate=0,this.onDrawIntervalMin=1/0,this.onDrawIntervalMax=0,this.numDrawCalls=0,this.decodeFramesLength=0,this.numFrameDecodes=0,this.decodeNotificationsLength=0,this.numNotifDecode=0,this.numFramesDecodeErrors=0,this.numNotificationDecodeErrors=0,this.lastStreamsReceivedTime=0,this.delayBetweenStreamsReceived=0,this.numOnStreamsReceived=0,this.bytesMetrics=[],this.framesMetrics=[],this.cacheTimeCapacityMetrics=[],this.cacheByteCapacityMetrics=[],this.numCachePushUpdates=0,this.syncErrorAggregate=0,this.syncErrorMin=1/0,this.syncErrorMax=0,this.syncErrorCounts=0,this.eventsSentSinceLastSentMetrics=0,this.rpc=e,this.mediaPlayer=t,this.registerConfigReception()}return e.prototype.startMetrics=function(){var e=this;0!==this.metricsTimerID&&this.stopMetrics(),this.metricsTimerID=getConfig().window.setInterval(function(){e.sendMetrics()},1e3*this.sendMetricsPeriod)},e.prototype.stopMetrics=function(){clearInterval(this.metricsTimerID),this.metricsTimerID=0},e.prototype.sendMetrics=function(){this.clientMetricList=[],this.AddPlaybackRateMetric(),this.AddVideoPlayerBufferMetrics(),this.AddCurrentVideoTimeMetric(),this.AddLatencyMetric(),this.AddOnDrawMetrics(),this.AddTwitchNTPTransportTime(),this.AddDataMetrics(),this.AddNumEventsSent(),this.AddDecodeMetrics(),this.AddStreamsReceivedMetric(),this.AddSyncErrorMetric(),this.AddCacheMetrics();var e=genvidproto.genvid.proto.ClientMetrics.encode({clientMetrics:this.clientMetricList}).finish();this.rpc.sendMsg(genvidproto.genvid.proto.LeafMethod.CLIENT_METRICS,e)},e.prototype.AddPlaybackRateMetric=function(){this.mediaPlayer&&this.mediaPlayer.getPlaybackRate&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"playback.rate",value:this.mediaPlayer.getPlaybackRate(),tags:this.emptyTags,operation:"GAUGE"}))},e.prototype.AddVideoPlayerBufferMetrics=function(){if(this.mediaPlayer&&this.mediaPlayer.getDeviationFromLatestFrame){var e=this.mediaPlayer.getDeviationFromLatestFrame();e>=0&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"deviation.from.latest.frame",value:e,tags:this.emptyTags,operation:"GAUGE"}))}},e.prototype.AddCurrentVideoTimeMetric=function(){this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"videoTime",value:this.videoTimeMS,tags:this.emptyTags,operation:"GAUGE"}))},e.prototype.AddLatencyMetric=function(){this.numLatencyUpdates>0&&(this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"latency",value:this.latencyAggregate/this.numLatencyUpdates,tags:this.emptyTags,operation:"TIMING"})),this.latencyAggregate=0,this.numLatencyUpdates=0)},e.prototype.AddOnDrawMetrics=function(){this.numDrawCalls>0&&(this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.duration.mean",value:this.onDrawDurationAggregate/this.numDrawCalls,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.duration.min",value:this.onDrawDurationMin,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.duration.max",value:this.onDrawDurationMax,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.interval.mean",value:this.onDrawIntervalAggregate/this.numDrawCalls,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.interval.min",value:this.onDrawIntervalMin,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"onDraw.interval.max",value:this.onDrawIntervalMax,tags:this.emptyTags,operation:"TIMING"})),this.numDrawCalls=0,this.onDrawDurationAggregate=0,this.onDrawDurationMin=1/0,this.onDrawDurationMax=0,this.onDrawIntervalAggregate=0,this.onDrawIntervalMin=1/0,this.onDrawIntervalMax=0)},e.prototype.AddDecodeMetrics=function(){this.numFrameDecodes>0&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"frame.decode.duration",value:this.decodeFramesLength/this.numFrameDecodes,tags:this.emptyTags,operation:"TIMING"})),this.numNotifDecode>0&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"notification.decode.duration",value:this.decodeNotificationsLength/this.numNotifDecode,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"frame.decode.errors",value:this.numFramesDecodeErrors,tags:this.emptyTags,operation:"GAUGE"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"notification.decode.errors",value:this.numNotificationDecodeErrors,tags:this.emptyTags,operation:"GAUGE"})),this.decodeFramesLength=0,this.numFrameDecodes=0,this.decodeNotificationsLength=0,this.numNotifDecode=0,this.numFramesDecodeErrors=0,this.numNotificationDecodeErrors=0},e.prototype.AddStreamsReceivedMetric=function(){this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"streams.interval",value:this.delayBetweenStreamsReceived/this.numOnStreamsReceived,tags:this.emptyTags,operation:"TIMING"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"streams.received.Hz",value:this.numOnStreamsReceived/this.sendMetricsPeriod,tags:this.emptyTags,operation:"GAUGE"})),this.delayBetweenStreamsReceived=0,this.numOnStreamsReceived=0},e.prototype.AddTwitchNTPTransportTime=function(){if(this.mediaPlayer){var e=getAverageNtpTransportTimeSinceLastCall(this.mediaPlayer);e>=0&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"twitch.ntp.transport",value:e,tags:this.emptyTags,operation:"TIMING"}))}},e.prototype.AddDataMetrics=function(){var e,t,r,n;try{for(var i=__values(this.framesMetrics),o=i.next();!o.done;o=i.next()){o.value.value/=this.sendMetricsPeriod}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}try{for(var s=__values(this.bytesMetrics),a=s.next();!a.done;a=s.next()){a.value.value/=this.sendMetricsPeriod}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this.clientMetricList=this.clientMetricList.concat(this.framesMetrics,this.bytesMetrics),this.framesMetrics=[],this.bytesMetrics=[]},e.prototype.AddNumEventsSent=function(){this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"events.sent.Hz",value:this.eventsSentSinceLastSentMetrics/this.sendMetricsPeriod,tags:this.emptyTags,operation:"GAUGE"})),this.eventsSentSinceLastSentMetrics=0},e.prototype.AddSyncErrorMetric=function(){this.syncErrorCounts>0&&this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"sync.error.mean",value:this.syncErrorAggregate/this.syncErrorCounts,tags:this.emptyTags,operation:"GAUGE"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"sync.error.min",value:this.syncErrorMin,tags:this.emptyTags,operation:"GAUGE"})),this.clientMetricList.push(new genvidproto.genvid.proto.ClientMetric({key:"sync.error.max",value:this.syncErrorMax,tags:this.emptyTags,operation:"GAUGE"})),this.syncErrorAggregate=0,this.syncErrorMin=1/0,this.syncErrorMax=0,this.syncErrorCounts=0},e.prototype.AddCacheMetrics=function(){var e,t,r,n;if(this.numCachePushUpdates>0){try{for(var i=__values(this.cacheByteCapacityMetrics),o=i.next();!o.done;o=i.next()){o.value.value/=this.numCachePushUpdates}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}try{for(var s=__values(this.cacheTimeCapacityMetrics),a=s.next();!a.done;a=s.next()){a.value.value/=this.numCachePushUpdates}}catch(e){r={error:e}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this.clientMetricList=this.clientMetricList.concat(this.cacheByteCapacityMetrics,this.cacheTimeCapacityMetrics),this.numCachePushUpdates=0,this.cacheByteCapacityMetrics=[],this.cacheTimeCapacityMetrics=[]}},e.prototype.UpdateMetricsOnStreamReception=function(e){this.delayBetweenStreamsReceived+=Date.now()-this.lastStreamsReceivedTime,this.lastStreamsReceivedTime=Date.now(),this.numOnStreamsReceived+=e.annotations.length+e.streams.length,this.UpdateStreamMetrics(e.annotations,"annotation"),this.UpdateStreamMetrics(e.streams,"data")},e.prototype.UpdateStreamMetrics=function(e,t){var r,n,i,o,s="received."+t+".frames.Hz",a="received."+t+".bytes.Hz";try{for(var c=__values(e),u=c.next();!u.done;u=c.next()){var l=u.value,d=this.FindMetricIndex(this.framesMetrics,s,["stream",l.id]);if(d>=0?this.framesMetrics[d]?this.framesMetrics[d].value+=l.frames.length:error("Frame metric with index "+d+" is invalid"):this.framesMetrics.push(new genvidproto.genvid.proto.ClientMetric({key:s,value:l.frames.length,tags:["stream",l.id],operation:"GAUGE"})),(d=this.FindMetricIndex(this.bytesMetrics,a,["stream",l.id]))<0&&(this.bytesMetrics.push(new genvidproto.genvid.proto.ClientMetric({key:a,value:0,tags:["stream",l.id],operation:"GAUGE"})),d=this.bytesMetrics.length-1),this.bytesMetrics[d])try{for(var p=(i=void 0,__values(l.frames)),h=p.next();!h.done;h=p.next()){var m=h.value;this.bytesMetrics[d].value+=m.rawdata.byteLength}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}else error("Byte metric with index "+d+" is invalid")}}catch(e){r={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}},e.prototype.FindMetricIndex=function(e,t,r){var n,i,o=0;try{for(var s=__values(e),a=s.next();!a.done;a=s.next()){var c=a.value;if(c.key===t&&this.SameTags(c.tags,r))return o;o++}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}return-1},e.prototype.SameTags=function(e,t){if(!e||!t||e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},e.prototype.UpdateSyncError=function(e){this.syncErrorCounts++,this.syncErrorAggregate+=e,this.syncErrorMin=Math.min(e,this.syncErrorMin),this.syncErrorMax=Math.max(e,this.syncErrorMax)},e.prototype.UpdateLatency=function(e){this.latencyAggregate+=e,this.numLatencyUpdates++},e.prototype.UpdatePreDraw=function(e){this.numDrawCalls++,0==this.onDrawPreviousTime&&(this.onDrawPreviousTime=e);var t=e-this.onDrawPreviousTime;this.onDrawIntervalAggregate+=t,this.onDrawIntervalMin=Math.min(this.onDrawIntervalMin,t),this.onDrawIntervalMax=Math.max(this.onDrawIntervalMax,t),this.onDrawPreviousTime=e},e.prototype.UpdatePostDraw=function(e){var t=Date.now()-e;this.onDrawDurationAggregate+=t,this.onDrawDurationMin=Math.min(this.onDrawDurationMin,t),this.onDrawDurationMax=Math.max(this.onDrawDurationMax,t)},e.prototype.UpdateCacheMetrics=function(e){var t=this;this.numCachePushUpdates++,e.forEach(function(e,r){e.forEach(function(e,r){var n=["stream",r],i=0;e.frames.forEach(function(e){i+=e.rawdata.byteLength});var o=t.FindMetricIndex(t.cacheByteCapacityMetrics,"cached.bytes",n);if(o>=0?t.cacheByteCapacityMetrics[o].value+=i:t.cacheByteCapacityMetrics.push(new genvidproto.genvid.proto.ClientMetric({key:"cached.bytes",value:i,tags:n,operation:"GAUGE"})),e.fps&&e.fps>0){var s=t.FindMetricIndex(t.cacheTimeCapacityMetrics,"cached.seconds",n);s>=0?t.cacheTimeCapacityMetrics[s].value+=e.frames.length/e.fps:t.cacheTimeCapacityMetrics.push(new genvidproto.genvid.proto.ClientMetric({key:"cached.seconds",value:e.frames.length/e.fps,tags:n,operation:"GAUGE"}))}})})},e.prototype.registerConfigReception=function(){var e=this;this.rpc&&this.rpc.registerMessage(genvidproto.genvid.proto.LeafMethod.METRICS_CONFIG,function(t){var r=genvidproto.genvid.proto.MetricsConfig.decode(t);return e.sendMetricsPeriod=r.periodSeconds,r.enabled?e.startMetrics():e.stopMetrics(),new Uint8Array})},e}();function newClientMetricManager(e,t){return new ClientMetricManager(e,t)}function getFrameSnapDistance(e,t,r){return function(n){var i=e-r(n);return i>0?i:i<-t?-1/0:-i}}function findMinimum(e,t,r){for(var n=-1,i=1/0,o=0;o<e.length;o++){var s=t(e[o]);if(s>=0&&s<=i)i=s,n=o;else if(r)break}return n}function deepEqual(e,t){return JSON.stringify(e)===JSON.stringify(t)}var long_1=Long,wasm=null;try{wasm=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function Long(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function isLong(e){return!0===(e&&e.__isLong__)}Object.defineProperty(Long.prototype,"__isLong__",{value:!0}),Long.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=UINT_CACHE[e])?n:(r=fromBits(e,(0|e)<0?-1:0,!0),i&&(UINT_CACHE[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=INT_CACHE[e])?n:(r=fromBits(e,e<0?-1:0,!1),i&&(INT_CACHE[e]=r),r)}function fromNumber(e,t){if(isNaN(e))return t?UZERO:ZERO;if(t){if(e<0)return UZERO;if(e>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(e<=-TWO_PWR_63_DBL)return MIN_VALUE;if(e+1>=TWO_PWR_63_DBL)return MAX_VALUE}return e<0?fromNumber(-e,t).neg():fromBits(e%TWO_PWR_32_DBL|0,e/TWO_PWR_32_DBL|0,t)}function fromBits(e,t,r){return new Long(e,t,r)}Long.fromInt=fromInt,Long.fromNumber=fromNumber,Long.fromBits=fromBits;var pow_dbl=Math.pow;function fromString(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return ZERO;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return fromString(e.substring(1),t,r).neg();for(var i=fromNumber(pow_dbl(r,8)),o=ZERO,s=0;s<e.length;s+=8){var a=Math.min(8,e.length-s),c=parseInt(e.substring(s,s+a),r);if(a<8){var u=fromNumber(pow_dbl(r,a));o=o.mul(u).add(fromNumber(c))}else o=(o=o.mul(i)).add(fromNumber(c))}return o.unsigned=t,o}function fromValue(e,t){return"number"==typeof e?fromNumber(e,t):"string"==typeof e?fromString(e,t):fromBits(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}Long.fromString=fromString,Long.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long.ZERO=ZERO;var UZERO=fromInt(0,!0);Long.UZERO=UZERO;var ONE=fromInt(1);Long.ONE=ONE;var UONE=fromInt(1,!0);Long.UONE=UONE;var NEG_ONE=fromInt(-1);Long.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long.MIN_VALUE=MIN_VALUE;var LongPrototype=Long.prototype;LongPrototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(MIN_VALUE)){var t=fromNumber(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=fromNumber(pow_dbl(e,6),this.unsigned),o=this,s="";;){var a=o.div(i),c=(o.sub(a.mul(i)).toInt()>>>0).toString(e);if((o=a).isZero())return c+s;for(;c.length<6;)c="0"+c;s=""+c+s}},LongPrototype.getHighBits=function(){return this.high},LongPrototype.getHighBitsUnsigned=function(){return this.high>>>0},LongPrototype.getLowBits=function(){return this.low},LongPrototype.getLowBitsUnsigned=function(){return this.low>>>0},LongPrototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},LongPrototype.isZero=function(){return 0===this.high&&0===this.low},LongPrototype.eqz=LongPrototype.isZero,LongPrototype.isNegative=function(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function(){return this.unsigned||this.high>=0},LongPrototype.isOdd=function(){return 1==(1&this.low)},LongPrototype.isEven=function(){return 0==(1&this.low)},LongPrototype.equals=function(e){return isLong(e)||(e=fromValue(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function(e){return!this.eq(e)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.ne=LongPrototype.notEquals,LongPrototype.lessThan=function(e){return this.comp(e)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function(e){return this.comp(e)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.le=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function(e){return this.comp(e)>0},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function(e){return this.comp(e)>=0},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.ge=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function(e){if(isLong(e)||(e=fromValue(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function(e){isLong(e)||(e=fromValue(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,a=e.low>>>16,c=0,u=0,l=0,d=0;return l+=(d+=i+(65535&e.low))>>>16,u+=(l+=n+a)>>>16,c+=(u+=r+s)>>>16,c+=t+o,fromBits((l&=65535)<<16|(d&=65535),(c&=65535)<<16|(u&=65535),this.unsigned)},LongPrototype.subtract=function(e){return isLong(e)||(e=fromValue(e)),this.add(e.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function(e){if(this.isZero())return ZERO;if(isLong(e)||(e=fromValue(e)),wasm)return fromBits(wasm.mul(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned);if(e.isZero())return ZERO;if(this.eq(MIN_VALUE))return e.isOdd()?MIN_VALUE:ZERO;if(e.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(TWO_PWR_24)&&e.lt(TWO_PWR_24))return fromNumber(this.toNumber()*e.toNumber(),this.unsigned);var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,i=65535&this.low,o=e.high>>>16,s=65535&e.high,a=e.low>>>16,c=65535&e.low,u=0,l=0,d=0,p=0;return d+=(p+=i*c)>>>16,l+=(d+=n*c)>>>16,d&=65535,l+=(d+=i*a)>>>16,u+=(l+=r*c)>>>16,l&=65535,u+=(l+=n*a)>>>16,l&=65535,u+=(l+=i*s)>>>16,u+=t*c+r*a+n*s+i*o,fromBits((d&=65535)<<16|(p&=65535),(u&=65535)<<16|(l&=65535),this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function(e){if(isLong(e)||(e=fromValue(e)),e.isZero())throw Error("division by zero");var t,r,n;if(wasm)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?fromBits((this.unsigned?wasm.div_u:wasm.div_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?UZERO:ZERO;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return UZERO;if(e.gt(this.shru(1)))return UONE;n=UZERO}else{if(this.eq(MIN_VALUE))return e.eq(ONE)||e.eq(NEG_ONE)?MIN_VALUE:e.eq(MIN_VALUE)?ONE:(t=this.shr(1).div(e).shl(1)).eq(ZERO)?e.isNegative()?ONE:NEG_ONE:(r=this.sub(e.mul(t)),n=t.add(r.div(e)));if(e.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();n=ZERO}for(r=this;r.gte(e);){t=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var i=Math.ceil(Math.log(t)/Math.LN2),o=i<=48?1:pow_dbl(2,i-48),s=fromNumber(t),a=s.mul(e);a.isNegative()||a.gt(r);)a=(s=fromNumber(t-=o,this.unsigned)).mul(e);s.isZero()&&(s=ONE),n=n.add(s),r=r.sub(a)}return n},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function(e){return isLong(e)||(e=fromValue(e)),wasm?fromBits((this.unsigned?wasm.rem_u:wasm.rem_s)(this.low,this.high,e.low,e.high),wasm.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.rem=LongPrototype.modulo,LongPrototype.not=function(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.and=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low&e.low,this.high&e.high,this.unsigned)},LongPrototype.or=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low|e.low,this.high|e.high,this.unsigned)},LongPrototype.xor=function(e){return isLong(e)||(e=fromValue(e)),fromBits(this.low^e.low,this.high^e.high,this.unsigned)},LongPrototype.shiftLeft=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):fromBits(0,this.low<<e-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function(e){return isLong(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?fromBits(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):fromBits(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function(e){if(isLong(e)&&(e=e.toInt()),0===(e&=63))return this;var t=this.high;return e<32?fromBits(this.low>>>e|t<<32-e,t>>>e,this.unsigned):fromBits(32===e?t:t>>>e-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.shr_u=LongPrototype.shiftRightUnsigned,LongPrototype.toSigned=function(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},LongPrototype.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},Long.fromBytes=function(e,t,r){return r?Long.fromBytesLE(e,t):Long.fromBytesBE(e,t)},Long.fromBytesLE=function(e,t){return new Long(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},Long.fromBytesBE=function(e,t){return new Long(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var SyncCache=function(){function e(){this.elements=[],this.startIngestTime=-1,this.lastRemoved=e.invalidElement}return e.prototype.selectClosest=function(t,r){for(var n=-1,i=1/0,o=this.elements.length-1;o>=0;--o){var s=t-this.elements[o].syncTime;if(s>0){if(!(s<i))break;i=s,n=o}else Math.abs(s)<=r&&s<=i&&(i=s,n=o)}return n>=0?this.elements[n]:e.invalidElement},e.prototype.isSyncValid=function(e,t){var r=!0;return this.isEmpty()||(this.startIngestTime!==t?r=!1:this.elements[this.elements.length-1].syncTime>e&&(r=!1)),r},e.prototype.clear=function(){this.elements=[]},e.prototype.clearUntil=function(e){if(this.elements.length&&this.elements[this.elements.length-1].syncTime<e)return this.lastRemoved=Object.assign({},this.elements[this.elements.length-1]),void this.elements.splice(0,this.elements.length);for(var t=0;t<this.elements.length-1;){if(this.elements[t].syncTime>=e)return void(t>0&&(this.lastRemoved=Object.assign({},this.elements[t-1]),this.elements.splice(0,t)));++t}},e.prototype.add=function(e,t){return!!this.isSyncValid(e.syncTime,t)&&(this.elements.push(e),this.startIngestTime=t,!0)},e.prototype.autoAdd=function(e,t){this.isSyncValid(e.syncTime,t)||this.clear(),this.elements.push(e),this.startIngestTime=t},e.prototype.isEmpty=function(){return 0===this.elements.length},e.prototype.getStartIngestTime=function(){return this.startIngestTime},e.prototype.getLastRemoved=function(){return Object.assign({},this.lastRemoved)},e.prototype.getLength=function(){return this.elements.length},e.prototype.validStart=function(){return this.startIngestTime!==e.invalidElement.syncTime},e.invalidElement={syncTime:-1,data:null},e}(),kSystemSessionID="4294967295";function syncFrameToSyncData(e){return{pts:(e.pts?e.pts instanceof long_1?e.pts.toNumber():e.pts:0)/1e3,sendingTime:(e.sendingTime?e.sendingTime instanceof long_1?e.sendingTime.toNumber():e.sendingTime:0)/1e3,startIngestTime:(e.startIngestTime?e.startIngestTime instanceof long_1?e.startIngestTime.toNumber():e.startIngestTime:0)/1e3}}var DataStreamFrame=function(){function e(e,t,r){this.sessionid=e,this.streamId=t,this.user=void 0;var n=new ArrayBuffer(0);if(r.data){n=new ArrayBuffer(r.data.byteLength);for(var i=new Uint8Array(n),o=0;o<r.data.byteLength;o++)i[o]=r.data[o]}this.rawdata=n,this.pts=r.pts,this.sendingTime=r.sendingTime,this.startIngestTime=r.startIngestTime,this.timeCode=r.timecode,this.timestamp=r.timestamp,this.composition=r.composition}return Object.defineProperty(e.prototype,"data",{get:function(){return UTF8ToString(this.rawdata)},enumerable:!1,configurable:!0}),e.prototype.getCompositionData=function(){var e={composition:[{affineMatrix:[1,0,0,0,1,0,0,0,1],class:this.composition.item&&this.composition.item.classname||"",opacity:1,streamId:this.streamId,sessionId:""+(this.composition.item&&this.composition.item.sessionid),timestamp:this.composition.item&&this.composition.item.timestamp||0,type:this.composition.item?this.composition.item.videoSourceCompositionType:"Undefined"}],pts:this.pts,sending_time:this.sendingTime,start_ingest_time:this.startIngestTime,syncTime:0};if(this.composition.components&&this.composition.components.affine&&this.composition.components.affine.matrix&&this.composition.components.affine.source){var t=this.composition.components.affine.matrix,r=[t.c0r0||0,t.c0r1||0,t.c0r2||0,t.c1r0||0,t.c1r1||0,t.c1r2||0,t.c2r0||0,t.c2r1||0,t.c2r2||0];e.composition.push({affineMatrix:r,class:this.composition.components.affine.source.classname||"",opacity:this.composition.components.affine.opacity||0,streamId:this.streamId,sessionId:""+this.composition.components.affine.source.sessionid,timestamp:this.composition.components.affine.source.timestamp||0,type:this.composition.item?this.composition.item.videoSourceCompositionType:"Undefined"})}return e},e}(),DataNotification=function(){function e(e,t,r){this.sessionid=e,this.id=t,this.rawdata=r}return Object.defineProperty(e.prototype,"data",{get:function(){return UTF8ToString(this.rawdata)},enumerable:!1,configurable:!0}),e}(),DefaultComposition;!function(e){e[e.SessionId=4294967295]="SessionId",e[e.SourceId=4294967295]="SourceId",e[e.StreamId=4294967295]="StreamId"}(DefaultComposition||(DefaultComposition={}));var GenvidClient=function(){function e(e,t,r,n,i){var o=this;void 0===i&&(i={}),this.apiStreams=e,this.url=t,this.token=r,this.videoDivId=n,this.videoElemId="",this.videoWidth=0,this.videoHeight=0,this.videoAspectRatio=1280/720,this.rpc=newRpcWrapper(),this.frameRate=30,this.requestCount=0,this.onSyncIntervalHandle=0,this.connectionTimer=0,this.syncInterval=0,this.compositionCache=new SyncCache,this.streamInfoCache=new SyncCache,this.syncDataCache=new SyncCache,this.playerReady=!1,this.gameDataMaxAge=8,this.streamTimeSmoother=newTimeSmoother(),this.delayOffset=0,this.isAuthenticated=!1,this.streamLatencyMS=0,this.videoTimeMS=0,this.streamTimeMS=0,this.lastComposeTimeMS=0,this.composeTimeMS=0,this.syncTimeSmoother=newTimeSmoother(),this.syncError=0,this.targetCaptureCount=100,this.activateCapture=!1,this.currentCaptureCount=0,this.onCaptureData=function(){return warn("onCaptureData callback missing!"),!0},this.debugLevel=0,this.lastSyncTime=0,this.lastNow=0,this.lastSyncTimeReceived=0,this.startSyncTime=0,this.startWallTime=0,this.benchFrameNum=-1,this.StreamFormat=genvidproto.genvid.proto.StreamFormat,this.DataFrames=genvidproto.genvid.proto.DataFrames,this.DataNotifications=genvidproto.genvid.proto.DataNotifications,this.Event=genvidproto.genvid.proto.Event,this.DebugConfig=genvidproto.genvid.proto.DebugConfig,this.hasNewSessionId=!1,this.lastStreamInfoSent={},this.isFirstStreamInfo=!0,this.debugInfoDecoded={streamIdStampingEnabled:!1},this.logStampCounter=0,this.logStampCountMax=30,this.version=version,log("Genvid SDK version "+this.version+" initializing."),this.streamsFormat={},this.closedStreams={},this.streams=new Map,this.annotations=new Map,this.streamsFormat[DefaultComposition.SessionId]={},this.streamsFormat[DefaultComposition.SessionId][DefaultComposition.SourceId]={},this.streamsFormat[DefaultComposition.SessionId][DefaultComposition.SourceId][DefaultComposition.StreamId]={sessionName:"0",sourceName:"",streamName:"genvid.encoded",fps:1,alive:!0},this.gameDataMaxAge=getConfig().gameDataMaxAge,this.rpc.registerMessage(genvidproto.genvid.proto.LeafMethod.DEBUG_CONFIG,function(e){o.debugInfoDecoded=o.DebugConfig.decode(e);try{o.debugInfoDecoded.streamIdStampingEnabled&&log("Stream id stamping is enabled.")}catch(e){error(e)}return new Uint8Array}),this.rpc.registerMessage(genvidproto.genvid.proto.LeafMethod.STREAM_FORMAT,function(e){var t=o.StreamFormat.decode(e);o.streamsFormat[t.sessionId]=o.streamsFormat[t.sessionId]||{},o.streamsFormat[t.sessionId][t.sourceId]=o.streamsFormat[t.sessionId][t.sourceId]||{},o.streamsFormat[t.sessionId][t.sourceId][t.streamId]={sessionName:String(t.sessionId),sourceName:t.sourceName,streamName:t.streamName,fps:t.fps,alive:t.alive};var r=String(t.sessionId);return o.closedStreams[r]=o.closedStreams[r]||{},o.closedStreams[r][t.streamName]=!t.alive,r===DefaultComposition.SessionId.toString(10)||o.hasNewSessionId||(o.hasNewSessionId=!0),new Uint8Array}),this.rpc.registerMessage(genvidproto.genvid.proto.LeafMethod.DATA_FRAMES,function(e){var t=Date.now(),r=o.DataFrames.decode(e);try{o.videoPlayer&&o.receivedFrames(r)}catch(e){o.metricManager.numFramesDecodeErrors++,error(e)}return o.metricManager.numFrameDecodes++,o.metricManager.decodeFramesLength+=Date.now()-t,new Uint8Array}),this.rpc.registerMessage(genvidproto.genvid.proto.LeafMethod.DATA_NOTIFICATIONS,function(e){var t=Date.now(),r=o.DataNotifications.decode(e);try{o.receivedNotifications(r)}catch(e){o.metricManager.numNotificationDecodeErrors++,error(e)}return o.metricManager.decodeNotificationsLength+=Date.now()-t,o.metricManager.numNotifDecode++,new Uint8Array}),this.apiStreams&&(this.delayOffset=this.apiStreams.delayoffset,this.apiStreams.videowidth&&(this.videoWidth=this.apiStreams.videowidth),this.apiStreams.videoheight&&(this.videoHeight=this.apiStreams.videoheight),this.videoWidth*this.videoHeight>0&&(this.videoAspectRatio=this.videoWidth/this.videoHeight),this.initVideoPlayer(i)),this.metricManager=newClientMetricManager(this.rpc,this.videoPlayer)}return e.prototype.initVideoPlayer=function(e){var t=this.privateOnVideoPlayerReady.bind(this);switch(this.apiStreams.service||"twitch"){case"fake":this.videoPlayer=newFakePlayer(this.videoDivId,this.apiStreams.channel,t,e);break;case"twitch":e.twitchExt?this.videoPlayer=newTwitchExtPlayer(this.videoDivId,this.apiStreams.channel,t,e,this.apiStreams.ntpuri||""):this.videoPlayer=newTwitchPlayer(this.videoDivId,this.apiStreams.channel,t,e,this.apiStreams.ntpuri||"");break;case"youtube":this.videoPlayer=newYouTubePlayer(this.videoDivId,this.apiStreams.channel,t,e);break;case"facebook":e.facebookIG?this.videoPlayer=newIGFacebookPlayer(this.videoDivId,this.apiStreams.channel,t,e):this.videoPlayer=newFacebookPlayer(this.videoDivId,this.apiStreams.channel,t,e);break;case"standalone":this.videoPlayer=newStandalonePlayer(this.videoDivId,this.apiStreams.channel,t,e);break;default:return error("Unsupported streaming service: '"+this.apiStreams.service+"'.")}this.videoPlayer.getCurrentTime()},e.prototype.privateOnVideoPlayerReady=function(e){this.playerReady=!0,this.videoElem=e,this.onVideoPlayerReadyCallback&&this.onVideoPlayerReadyCallback(e)},e.prototype.onDisconnect=function(e){this.onDisconnectCallback=e},e.prototype.onVideoPlayerReady=function(e){this.onVideoPlayerReadyCallback=e,this.playerReady&&e(this.videoElem)},e.prototype.onDraw=function(e){this.onDrawCallback=e},e.prototype.onStreamsReceived=function(e){this.onStreamsReceivedCallback=e},e.prototype.onNotificationsReceived=function(e){this.onNotificationsReceivedCallback=e},e.prototype.startFrameCapture=function(e,t){this.activateCapture?warn("Capture in progress, please wait !"):(this.targetCaptureCount=t,log("Capture started: "+this.targetCaptureCount+" frames to be captured at "+1e3/this.syncInterval+" fps"),log("Note that this feature is for internal use only, this API is subject to change."),this.onCaptureData=e||this.onCaptureData,this.activateCapture=!0)},e.prototype.convertToDataStreams=function(e){var t=this;return this.hasNewSessionId?{streams:(e.streams||[]).map(function(e){return{id:t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].streamName||"",sessionid:t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].sessionName||"",fps:t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].fps||30,frames:(e.frames||[]).map(function(r){return new DataStreamFrame(t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].sessionName||"",t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].streamName||"",r)})}}),annotations:(e.annotations||[]).map(function(e){return{id:t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0]?t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].streamName:"",sessionid:t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0]?t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].sessionName:"",frames:(e.frames||[]).map(function(r){return new DataStreamFrame(t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0]?t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].sessionName:"",t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0]?t.streamsFormat[e.v2SessionId||-1][e.v2SourceId||0][e.v2StreamId||0].streamName:"",r)})}})}:{annotations:[],streams:[]}},e.prototype.insertFrame=function(e,t){var r=0;for(r=t.length;r>0&&!(t[r-1].timeCode<e.timeCode);--r);return t.splice(r,0,e),t},e.prototype.orderFrameInStream=function(e,t){for(var r=0;r<t.length;r++)if(t[r].sessionid==e.sessionid&&t[r].id==e.streamId)return void this.insertFrame(e,t[r].frames)},e.prototype.receivedFrames=function(e){var t,r,n,i,o,s,a,c,u,l,d,p,h,m,f,g,y,v,w,b,T,S=this.convertToDataStreams(e);this.metricManager.UpdateMetricsOnStreamReception(S);var I=new Set;try{for(var O=__values(S.streams),P=O.next();!P.done;P=O.next()){switch((z=P.value).sessionid){case kSystemSessionID:switch(z.id){case"sync":I.add(z.id);var A=new Date;try{for(var E=(n=void 0,__values(z.frames)),L=E.next();!L.done;L=E.next()){var M=L.value,C=new Uint8Array(M.rawdata),$=syncFrameToSyncData(x=genvidproto.genvid.proto.SyncFrame.decode(C));this.videoPlayer&&(x.syncTime=this.videoPlayer.getSyncTime($)),this.syncDataCache.isSyncValid(x.syncTime,$.startIngestTime)||(this.syncDataCache.clear(),this.clearFramesFromNestedMaps(this.streams),this.clearFramesFromNestedMaps(this.annotations)),this.syncDataCache.add({syncTime:x.syncTime,data:x},$.startIngestTime),this.syncDataCache.clearUntil(this.getRemovableTime()),this.lastComposeTimeMS=x.syncTime,this.syncTimeSmoother.set(x.syncTime,A)}}catch(e){n={error:e}}finally{try{L&&!L.done&&(i=E.return)&&i.call(E)}finally{if(n)throw n.error}}break;case"composition":I.add(z.id);try{for(var N=(o=void 0,__values(z.frames)),k=N.next();!k.done;k=N.next()){M=k.value,C=new Uint8Array(M.rawdata);var D=genvidproto.genvid.proto.CompositionFrame.decode(C);if(D.composition&&this.videoPlayer){var x=syncFrameToSyncData(D),R=this.videoPlayer.getSyncTime(x),B=protoToCompositiondata(D.composition);this.compositionCache.autoAdd({syncTime:R,data:B},x.startIngestTime),this.compositionCache.clearUntil(this.getRemovableTime())}}}catch(e){o={error:e}}finally{try{k&&!k.done&&(s=N.return)&&s.call(N)}finally{if(o)throw o.error}}break;case"stream_info":I.add(z.id);try{for(var j=(a=void 0,__values(z.frames)),_=j.next();!_.done;_=j.next()){M=_.value;var F=JSON.parse(M.data);if(this.videoPlayer){x=syncFrameToSyncData(F),R=this.videoPlayer.getSyncTime(x);this.streamInfoCache.autoAdd({syncTime:R,data:F.streamInfo},x.startIngestTime),this.streamInfoCache.clearUntil(this.getRemovableTime())}}}catch(e){a={error:e}}finally{try{_&&!_.done&&(c=j.return)&&c.call(j)}finally{if(a)throw a.error}}if(!0===this.isFirstStreamInfo)this.isFirstStreamInfo=!1;else if(this.videoPlayer&&this.videoPlayer.reloadVideoPlayer){var U=JSON.parse(z.frames[z.frames.length-1].data).streamInfo.channel;""!=U&&this.videoPlayer.reloadVideoPlayer(U,1e3*this.gameDataMaxAge)}else warn("reloadVideoPlayer is not available on your streaming service.")}}}}catch(e){t={error:e}}finally{try{P&&!P.done&&(r=O.return)&&r.call(O)}finally{if(t)throw t.error}}if(S.streams=S.streams.filter(function(e){return!I.has(e.id)}),this.debugInfoDecoded.streamIdStampingEnabled){var V=[];try{for(var W=__values(S.streams),G=W.next();!G.done;G=W.next()){var z=G.value;V.push({stream:z,frames:z.frames}),z.frames=[]}}catch(e){u={error:e}}finally{try{G&&!G.done&&(l=W.return)&&l.call(W)}finally{if(u)throw u.error}}try{for(var J=__values(V),Y=J.next();!Y.done;Y=J.next()){var Z=Y.value,H=(z=Z.stream,Z.frames);try{for(var Q=(h=void 0,__values(H)),q=Q.next();!q.done;q=Q.next()){M=q.value;var X=new DataView(M.rawdata),K=0;for(K=0;K<M.rawdata.byteLength&&0!=X.getInt8(K);++K);var ee=UTF8ToString(M.rawdata.slice(0,K+1)),te=(M.data.slice(K+1),M.rawdata.slice(K+1));z.id==ee&&M.streamId==ee||(this.logStampCounter++,this.logStampCounter>this.logStampCountMax&&(log(this.logStampCountMax+" mismatches. Stamped ID:"+ee+" missmatch stream.id:"+z.id+" or frame.streamId:"+M.streamId),this.logStampCounter=0),M.streamId=ee),M.rawdata=te,this.orderFrameInStream(M,S.streams)}}catch(e){h={error:e}}finally{try{q&&!q.done&&(m=Q.return)&&m.call(Q)}finally{if(h)throw h.error}}}}catch(e){d={error:e}}finally{try{Y&&!Y.done&&(p=J.return)&&p.call(J)}finally{if(d)throw d.error}}}this.onStreamsReceivedCallback&&this.onStreamsReceivedCallback(S);try{for(var re=__values(S.streams),ne=re.next();!ne.done;ne=re.next()){z=ne.value;(ce=this.streams.get(z.sessionid))||(ce=new Map,this.streams.set(z.sessionid,ce)),(ue=ce.get(z.id))||(ue={fps:z.fps,frames:[]},ce.set(z.id,ue));try{for(var ie=(y=void 0,__values(z.frames)),oe=ie.next();!oe.done;oe=ie.next()){M=oe.value;(0===ue.frames.length||ue.frames[ue.frames.length-1].timeCode<M.timeCode)&&ue.frames.push(M)}}catch(e){y={error:e}}finally{try{oe&&!oe.done&&(v=ie.return)&&v.call(ie)}finally{if(y)throw y.error}}}}catch(e){f={error:e}}finally{try{ne&&!ne.done&&(g=re.return)&&g.call(re)}finally{if(f)throw f.error}}this.metricManager.UpdateCacheMetrics(this.streams);try{for(var se=__values(S.annotations),ae=se.next();!ae.done;ae=se.next()){var ce,ue,le=ae.value;(ce=this.annotations.get(le.sessionid))||(ce=new Map,this.annotations.set(le.sessionid,ce)),(ue=ce.get(le.id))||(ue={frames:[]},ce.set(le.id,ue)),(T=ue.frames).push.apply(T,__spread(le.frames))}}catch(e){w={error:e}}finally{try{ae&&!ae.done&&(b=se.return)&&b.call(se)}finally{if(w)throw w.error}}},e.prototype.clearFramesFromNestedMaps=function(e){var t,r,n,i;try{for(var o=__values(this.streams),s=o.next();!s.done;s=o.next()){var a=__read(s.value,2),c=(a[0],a[1]);try{for(var u=(n=void 0,__values(c)),l=u.next();!l.done;l=u.next()){var d=__read(l.value,2);d[0];d[1].frames=[]}}catch(e){n={error:e}}finally{try{l&&!l.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}},e.prototype.receivedNotifications=function(e){var t,r;if(this.onNotificationsReceivedCallback){var n=[];try{for(var i=__values(e.notifications),o=i.next();!o.done;o=i.next()){var s=o.value,a=new ArrayBuffer(0);if(s.data){a=new ArrayBuffer(s.data.byteLength);for(var c=new Uint8Array(a),u=0;u<s.data.byteLength;u++)c[u]=s.data[u]}n.push(new DataNotification(s.sessionid||"",s.id||"",a))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}this.onNotificationsReceivedCallback({notifications:n})}},e.prototype.getRemovableTime=function(){if(this.videoPlayer){var e=this.videoPlayer.getCurrentTime();if(e>=0)return e+this.delayOffset-1e3*this.gameDataMaxAge}return-1},e.prototype.onSyncInterval=function(){var e,t,r=this;if(this.videoPlayer){if(!this.syncDataCache.isEmpty()){var n=this.videoPlayer.getCurrentTime();if(!(n<0)&&this.streamsFormat){var i,o=n+this.delayOffset,s=this.syncDataCache.selectClosest(o,this.syncInterval/2);if(s&&s.syncTime!==SyncCache.invalidElement.syncTime){var a,c=[];if((i=s.data).syncTime){var u;if((s=this.compositionCache.selectClosest(i.syncTime,0))&&s.syncTime!==SyncCache.invalidElement.syncTime)c=s.data;else(u=this.compositionCache.getLastRemoved())&&u.syncTime!==SyncCache.invalidElement.syncTime?c=u.data:warn("Unable to find composition data.");if((s=this.streamInfoCache.selectClosest(i.syncTime,0))&&s.syncTime!==SyncCache.invalidElement.syncTime)a=s.data;else(u=this.streamInfoCache.getLastRemoved())&&u.syncTime!==SyncCache.invalidElement.syncTime?a=u.data:warn("Unable to find stream info.")}if(deepEqual(this.lastStreamInfoSent,a)||(this.lastStreamInfoSent=a),this.syncError=(i.syncTime||0)-o,this.metricManager.UpdateSyncError(this.syncError),this.debugLevel>0){var l=Date.now(),d=(i.syncTime||0)-this.lastSyncTime;if(this.debugLevel>=2&&d<.025||d>.045?error("syncTime:",i.syncTime," deltaSyncTime:",d," now:",l/1e3," dt:",(l-this.lastNow)/1e3," videoTime:",n):this.debugLevel>=2&&log("syncTime:",i.syncTime," deltaSyncTime:",d," now:",l/1e3," dt:",(l-this.lastNow)/1e3," videoTime:",n),-1===this.benchFrameNum)this.startSyncTime=i.syncTime||0,this.startWallTime=l,this.benchFrameNum=0;else if(this.benchFrameNum++,1e3===this.benchFrameNum){this.benchFrameNum=-1;var p=l-this.startWallTime,h=(i.syncTime||0)-this.startSyncTime;log("****** benchmark dura:",p/1e3," video length:",h," error:",(p/1e3-h/1e3)/p*100)}this.lastSyncTime=i.syncTime||0,this.lastNow=l}var m={timeCode:-1,streams:{},annotations:{},sessions:{},compositionData:[]},f=function(e,t){var n,i,o;e=1e3*(e||0);var s=g.syncDataCache.getLastRemoved();if(s&&s.syncTime!==SyncCache.invalidElement.syncTime)try{for(var a=(n=void 0,__values(s.data.sources)),c=a.next();!c.done;c=a.next()){var u=c.value;if(u.sessionId===t){o=u;break}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}var l=""+t;m.sessions[l]=m.sessions[l]||{streams:{},annotations:{}};var d=g.streams.get(l),p=g.annotations.get(l),h=getFrameSnapDistance(e,g.syncInterval/2,function(e){return e.timeCode});d&&d.forEach(function(e,t){if(e){var n=e.frames,i=findMinimum(n,h,!0);if(i>=0&&(m.sessions[l].streams[t]=n[i]),o){for(var s=-1,a=0;a<n.length&&n[a].timeCode<1e3*(o.timestamp||0);a++)s=a;s>=1?n.splice(0,s):0===s&&!0===r.closedStreams[l][t]&&(n=[])}}}),p&&p.forEach(function(e,t){if(e&&e.frames.length){var r=e.frames,n=findMinimum(r,h,!0);m.sessions[l].annotations[t]=n>=0?r.splice(0,n+1):[]}})},g=this;try{for(var y=__values(i.sources||[]),v=y.next();!v.done;v=y.next()){var w=v.value;f(T=w.timestamp,S=w.sessionId)}}catch(t){e={error:t}}finally{try{v&&!v.done&&(t=y.return)&&t.call(y)}finally{if(e)throw e.error}}if(i.sources&&0!==i.sources.length){var b=i.sources[0],T=b.timestamp,S=b.sessionId;(m=__assign(__assign({},m),m.sessions[""+S])).timeCode=1e3*(T||0)}else warn("composition is empty. syncData: "+JSON.stringify(i));var I=new Date;if(this.videoTimeMS=n,this.metricManager.videoTimeMS=this.videoTimeMS,this.composeTimeMS=this.syncTimeSmoother.get(I),this.streamTimeMS=i.syncTime||0,this.streamLatencyMS=this.composeTimeMS-this.streamTimeMS,this.metricManager.UpdateLatency(this.streamLatencyMS),m.compositionData=c,this.activateCapture&&i.syncTime&&i.sources&&i.sources.length&&(this.currentCaptureCount++,this.activateCapture=this.onCaptureData({playerTime:o,computedSyncTime:i.syncTime,compositionTime:i.sources[0].timestamp||0,clockTime:performance.now(),frameData:m}),this.currentCaptureCount>=this.targetCaptureCount&&(this.currentCaptureCount=0,this.activateCapture=!1,this.onCaptureData(void 0),log("Capture complete."))),this.onDrawCallback){var O=Date.now();this.metricManager.UpdatePreDraw(O),this.onDrawCallback(m),this.metricManager.UpdatePostDraw(O)}}else warn("No sync data found. Cache size: "+this.syncDataCache.getLength())}}}else warn("no video player")},e.prototype.buildEvents=function(e,t){t=t||[];var r=[];for(var n in e){t.push(n);var i=e[n],o=typeof i;switch(o){case"string":case"number":case"boolean":var s={key:__spread(t),value:i};r.push(s);break;case"object":var a=this.buildEvents(i,__spread(t));r.push.apply(r,__spread(a));break;default:throw new Error("Does not support type "+o)}t.pop()}return r},e.prototype.wsOnOpen=function(e){info("Connected to leaf:",this.url),this.connectionTimer&&getConfig().window.clearTimeout(this.connectionTimer)},e.prototype.wsOnMessage=function(e){if(!this.isAuthenticated&&(info("Authentication succeeded"),this.isAuthenticated=!0,this.onAuthenticatedCallback))try{this.onAuthenticatedCallback(!0)}catch(e){error(e),this.metricManager.stopMetrics(),this.ws&&this.ws.close()}},e.prototype.wsOnError=function(e){error("Web socket error",e),this.metricManager.stopMetrics()},e.prototype.wsOnClose=function(e){info("Web socket closed ["+e.code+"]: "+e.reason),this.metricManager.stopMetrics(),this.onAuthenticatedCallback&&!1===this.isAuthenticated&&this.onAuthenticatedCallback(!1),this.isAuthenticated=!1,this.onDisconnectCallback&&this.onDisconnectCallback()},e.prototype.onAuthenticated=function(e){this.onAuthenticatedCallback=e},e.prototype.sendEvent=function(e){var t,r,n=[];try{for(var i=__values(e),o=i.next();!o.done;o=i.next()){var s=o.value;n.push({key:s.key,value:JSON.stringify(s.value)})}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}var a=this.Event.encode({keyValue:n}).finish();this.rpc.sendMsg(genvidproto.genvid.proto.LeafMethod.EVENT,a),this.metricManager.eventsSentSinceLastSentMetrics++},e.prototype.sendEventObject=function(e){this.sendEvent(this.buildEvents(e))},e.prototype.start=function(){var e=this;try{var t=getConfig(),r=t.websocketConnectionTimeout,n=t.framePerSeconds,i=(0,t.newWebsocket)(this.url+"?token="+this.token+"&version="+this.version);this.ws=i,i.binaryType="arraybuffer",this.rpc.init(i,function(t){e.wsOnMessage(t)}),i.onopen=function(t){e.wsOnOpen(t)},i.onerror=function(t){e.wsOnError(t)},i.onclose=function(t){e.wsOnClose(t)},n=n||30;var o=1e3*(r=r||60);this.connectionTimer=t.window.setTimeout(function(){e.ws&&e.ws.readyState===e.ws.CONNECTING&&(error("Timeout during web socket connection.  Closing"),e.ws.close())},o),this.syncInterval=1e3/n-2,log("OnDraw interval is set to "+this.syncInterval+" ms"),this.onSyncIntervalHandle=t.window.setInterval(function(){try{e.onSyncInterval()}catch(e){error(e)}},this.syncInterval)}catch(e){error(e)}},e.prototype.reconnect=function(e,t,r){this.close(),info("Reconnecting GenvidClient websocket..."),e&&(this.apiStreams=e,this.videoPlayer&&this.videoPlayer.setStreamInfo&&this.videoPlayer.setStreamInfo(e)),t&&(this.url=t),r&&(this.token=r),this.start()},e.prototype.close=function(){info("Closing GenvidClient"),this.onSyncIntervalHandle&&(clearInterval(this.onSyncIntervalHandle),this.onSyncIntervalHandle=0),this.videoPlayer&&this.videoPlayer.close&&this.videoPlayer.close(),this.ws&&this.ws.close()},e}();function createGenvidClient(e,t,r,n,i){return new GenvidClient(e,t,r,n,i)}var WebGLContext=function(){function e(e){this.div=e,this.clearColor=[0,0,0,0];var t=e.getContext("webgl",{premultipliedAlpha:!0})||e.getContext("experimental-webgl",{premultipliedAlpha:!0});if(!t)throw alert("This browser doesn't support WebGL"),Error("This browser doesn't support WebGL");this.gl=t,this.div.addEventListener("webglcontextlost",this.handleContextLost,!1),this.div.addEventListener("webglcontextrestored",this.handleContextRestored,!1),this.init()}return e.prototype.init=function(){this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LESS),this.resizeToDisplaySize()},e.prototype.clear=function(){var e,t=this.clearColor;t.x?this.gl.clearColor(t.x,t.y,t.z,t.w):(e=this.gl).clearColor.apply(e,__spread(this.clearColor)),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.checkGLError()},e.prototype.checkGLError=function(){var e=this.gl.getError();e!==this.gl.NO_ERROR&&log("GL Error: "+e)},e.prototype.handleContextLost=function(){this.handleContextLost&&this.handleContextLost()},e.prototype.handleContextRestored=function(){this.handleContextRestored&&this.handleContextRestored()},e.prototype.resizeToDisplaySize=function(){var e=this.div;this.setResolution(e.clientWidth,e.clientHeight)},e.prototype.setResolution=function(e,t){var r=this.gl.canvas;r.width===e&&r.height===t||(r.width=e,r.height=t,this.gl.viewport(0,0,r.width,r.height))},e.prototype.setViewport=function(e,t,r,n){this.gl.viewport(e,t,r,n)},e.prototype.loadShader=function(e,t){var r=this.gl.createShader(e);if(!r)throw Error("Failed to create shader "+e);if(this.gl.shaderSource(r,t),this.gl.compileShader(r),!this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)&&!this.gl.isContextLost()){var n=this.gl.getShaderInfoLog(r);throw this.gl.deleteShader(r),Error("Error compiling shader: "+n)}return r},e.prototype.loadVertexShader=function(e){return this.loadShader(this.gl.VERTEX_SHADER,e)},e.prototype.loadFragmentShader=function(e){return this.loadShader(this.gl.FRAGMENT_SHADER,e)},e.prototype.deleteShader=function(e){this.gl.deleteShader(e)},e.prototype.loadProgram=function(e,t,r){var n=this.gl.createProgram();if(!n)throw Error("GL: Unable to create program");if(this.gl.attachShader(n,e),this.gl.attachShader(n,t),r)for(var i=r.length,o=0;o<i;++o){var s=r[o];s&&this.gl.bindAttribLocation(n,o,s)}if(this.gl.linkProgram(n),!this.gl.getProgramParameter(n,this.gl.LINK_STATUS)&&!this.gl.isContextLost()){var a=this.gl.getProgramInfoLog(n);throw this.gl.deleteProgram(n),Error("Error linking program: "+a)}return n},e.prototype.deleteProgram=function(e){this.gl.deleteProgram(e)},e.prototype.createBuffer=function(e){var t=this.gl.createBuffer();if(!t)throw Error("Failed while trying to create gl buffer");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t);var r=0;return e&&(this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),r=e.length),[t,r]},e.prototype.createIndexBuffer=function(e){var t=this.gl.createBuffer();if(!t)throw Error("GL: Unable to create buffer");this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t);var r=0;return e&&(this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,e,this.gl.STATIC_DRAW),r=e.length),[t,r]},e.prototype.createIndexBufferForQuads=function(e){for(var t=[],r=0;r<e;++r){var n=4*r;t.push(n),t.push(n+1),t.push(n+2),t.push(n),t.push(n+2),t.push(n+3)}return this.createIndexBuffer(new Uint16Array(t))},e.prototype.deleteBuffer=function(e){this.gl.deleteBuffer(e)},e}();function createWebGLContext(e){return new WebGLContext(e)}export{decode,UTF8ToString,UTF16ToString,createGenvidClient,createWebGLContext,PlayerEvents,log,warn,error,info,trace,assert,clear,count,time,timeEnd,setConfig,getConfig};
